{"version":3,"sources":["actions/menuActions.ts","type/menu.ts","reportWebVitals.ts","lib/handy.ts","lib/storage.ts","lib/http.ts","store/webServiceApi/menu.ts","store/webServiceApi/branch.ts","reducer/menuReducer.ts","store/menuStore.tsx","store/webServiceApi/market.ts","store/marketStore.tsx","screens/home/index.tsx","screens/redirector/index.tsx","store/webServiceApi/user.ts","store/userStore.tsx","components/passwordField/index.tsx","screens/login/index.tsx","components/menu/selectOption/index.tsx","components/menu/modalMenuItem.tsx","images/menu/check-icon.png","images/menu/uncheck-icon.png","components/menu/readOnlyModalMenuItem.tsx","components/menu/menu.tsx","images/uparrow.png","components/basket/index.tsx","images/edit.png","screens/menu/index.tsx","components/menu/readOnlyMenu.tsx","screens/eatIn/index.tsx","components/menu/menuWithOutCategory.tsx","screens/singleMenu/index.tsx","store/webServiceApi/booking.ts","screens/postCodeCheck/index.tsx","screens/booking/index.tsx","screens/signup/index.tsx","screens/forgetPass/index.tsx","screens/startCheckout/index.tsx","screens/enterCode/index.tsx","components/currentOrder/index.tsx","type/branch.ts","screens/resetPass/index.tsx","screens/payment/index.tsx","screens/history/index.tsx","navigation/index.tsx","translation.ts","index.js"],"names":["ActionTypes","MenuFilter","MenuContentType","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","cleanObj","obj","removeEmptyString","Object","keys","forEach","key","undefined","length","firstLetterUpperCase","value","toUpperCase","slice","formatPostCode","substr","addressToString","address","line1","line2","town","postal_code","REQUEST_BRANCH","branch_id","window","process","chunkArray","inputArray","chunkSize","index","arrayLength","tempArray","myChunk","push","getNumFrom","text","themnums","match","parseFloat","getPrice","item","filter","selectedSizeId","selectedItems","sizes","e","id","Delivery","delivery_price","price","Booking","table_price","TakeOut","collect_price","delivery_min_price","take_out_min_price","eat_in_min_price","getErrorMessage","message","hasOwnProperty","errors","removeWhiteSpace","input","replace","localStorage","saveInStorage","a","setItem","getFromStorage","Promise","resolve","reject","retrieved","getItem","removeFromStorage","removeItem","reqInterceptor","resMiddleWare","tokenStorageKey","reqTimeouts","parseData","responseBodyAsText","JSON","parse","http","init","abortCtrl","AbortController","setTimeout","abort","timeout","token","catch","headers","signal","addEventListener","fetch","response","json","status","res","r","error","Error","checkStatus","wholeRootResponse","data","parentCategory","abortSignal","has_items","category","cachedContent","menuStoreInitializeContent","rootCategories","fetchedCategoryContents","menuStoreReducer","state","action","type","updateSubCategoryOfCategory","catId","subCats","Category","updateItemsOfCategory","Item","items","MenuContextContainer","React","createContext","updateCategoryContent","useMenuContext","useContext","MenuProvider","children","useReducer","menuContextStore","dispatch","contextStoreRef","useRef","useEffect","current","cat","currentMenuStore","getMenuItem","getMenuCategories","Provider","getResturantBranchInfo","dont_cache","postCode","inputs","method","body","stringify","order_type","source","order_id","pay_method_id","MarketContextContainer","basketItems","history","searchForPostCode","selectPostCode","isRestaurantActiveNow","addToBasket","removeFromBasket","setActiveMenuFilter","updateBasketItem","clearBasket","clearOrderHistory","saveOrderInHistory","submitOrder","assignPaymentMethod","getStripeSecretKey","useMarketContext","MarketProvider","t","useTranslation","BRANCH_ID","basketStorageKey","historyStorageKey","activeFilterStorageKey","selectedPostCodeWithAddressKey","useState","storeInfo","setStoreInfo","setBasketItems","setHistory","activeMenuFilter","deliveryTime","setDeliveryTime","deliveryCost","setDeliveryCost","availableDeliverTime","setAvailableDeliverTime","activePostCode","setActivePostCode","submittedOrder","setSubmittedOrder","isInitialized","storeInfoRef","activeMenuFilterRef","submittedOrderRef","now","intervals","startDelay","result","minute","Math","floor","minutes","add","end","moment","hour","second","weekday","Array","isAfter","some","time","week_day","day","start_","format","start_time","end_","finish_time","isBefore","getAvailableDeliverTimes","delivery_times","takeout_times","min_expected_delivery_time","min_expected_takeout_time","restoreLocalContents","resp","toast","setInterval","basket","lastUpdate","prevFilter","basketContent","content","subtract","parsedContent","expire_date","o","created_at","finally","rest","upperCasedPostCode","supportedPostCodes","post_codes","includes","post_code","delivery_charge","order","payment","preferred_pay_method","delivery_date","rows","description","total","payable_amount","customer_info","submitOrderApi","p","sizeOptionId","map","quantity","prevSameItems","findIndex","i","splice","searchForPostCodeApi","title","subitPaymentMethodApi","getStripeSecretKeyApi","client_secret","Home","location","useLocation","Container","Row","Col","className","full_name","is_take_out_active","to","is_delivery_active","pathname","background","Redirector","useHistory","go","request_id","verify_code","mobile","password","UserContextContainer","addAddress","getUserAddress","resendSms","verifyPhone","register","login","logout","forgetPass","resetPassword","useUser","UserProvider","userStorageKey","user","setUser","temporaryPhone","setTemproryPhone","temporaryPhoneRef","registerRequestId","userAddresses","retrievedUser","x","toLocaleString","getAddressesApi","loginApi","registerApi","resendSmsApi","forgetPassApi","addAddressesApi","verifyPhoneApi","newPass","verifyCode","resetPasswordApi","styles","cursorPointer","cursor","PasswordField","props","inputType","setInputType","InputGroup","Form","Control","Append","Text","style","onClick","Login","Reflect","construct","isFormSubmitting","setIsFormSubmitting","TokenStorageKey","goBack","enteredPhone","enteredPass","md","span","offset","Group","Card","Body","onSubmit","event","preventDefault","stopPropagation","refer","href","controlId","Label","country","onlyCountries","onChange","inputClass","countryCodeEditable","inputProps","name","required","autoFocus","target","placeholder","sm","Button","disabled","variant","SelectOption","MenuItemModalDataType","options","disable","onSelect","preSelectIndeX","currentSelectedOptionIndex","setCurrentSelectedOptionIndex","currentOptions","onSelectTheOption","label","metaData","toFixed","src","ModalMenuItem","filterType","dismiss","sizeOptions","setSizeOptions","selectedQuantity","setSelectedQuantity","selectedSizeIndex","setSelectedSizeIndex","quantityRef","Normal","dataSource","currentMenufilterPrice","is_active","Basket","theItem","Modal","scrollable","animation","show","onHide","Header","closeButton","Title","img_full_url","max","Footer","item_index","float","RestaurantMenu","onAddBasket","isLoadingMenuItems","setIsLoadingMenuItems","visibleMenuItems","setVisibleMenuItems","isLoadingSubcat","setIsLoadingSubcat","visibleSubCats","setVisibleSubCats","activeMenuCategoryId","setActiveMenuCategoryId","presentingMenuItem","setPresentingMenuItem","isComponentActive","currentFilter","menuIsReady","getInitialContent","getInside","selectTheFirstCategoryWithItem","filterCategories","cats","hasCategoryItems","setMenuItems","filterMenuItems","toggleVisibilityForSubCat","isRootCat","is_table","is_delivery","is_collect","renderSubCategoryContent","level","color","height","width","filteredContent","subCat","visibleRootCategories","rootCat","itemsRow","j","isBasketExpanded","setIsBasketExpanded","editingBasketItem","setEditingBasketItem","morePriceNeedToStartCheckout","setMorePriceNeedToStartCheckout","itemIndex","setItemIndex","basketTotal","setBasketTotal","size_id","size","find","s","basketItemIsAvailable","totalPrice","reduce","ac","delivery_min_order_amount","sizeLabel","basketItem","selectedSizes","UpArrow","Fragment","MenuScreen","useParams","presentOutOfOrder","setPresentOutOfOrder","continueOutOfOrder","setContinueOutOfOrder","latestActiveFilter","is_delivery_closed_now","is_takeout_closed_now","lg","duration","diff","humanize","ReadOnlyMenu","EatInScreen","activeMenuCategoryIdx","setActiveMenuCategoryIdx","setVisibleRootCategories","selectCategoryWithItem","idx","selectSubCategoryWithItem","itr","itr2","date","FormFields","numberOfGuests","isLoading","setIsLoading","activeBooking","setActiveBooking","targetTime","setTargetTime","timeIntervals","setTimeIntervals","selectedCapacity","setSelectedCapacity","toDate","selectedDate","setSelectedDate","isPresentDatePicker","setIsPresentDatePicker","isSelectedCapacityInvalid","setIsSelectedCapacityInvalid","isSubmitting","setIsSubmitting","hasSelect","setHasSelect","isCancelConfirmModalPresented","setIsCancelConfirmModalPresented","targetTimeRef","selectedCapacityRef","getActiveBookingApi","is_booking_active","limit","maximum_acceptance_capacity","getAvailableTimes","getAvailableBookingTimeApi","uniqueHours","Map","out","drawHour","h","is_available","toString","indexOf","has","set","isSelected","toggleSelectedIndex","cancelActiveBooking","promise","cancelActiveBookingApi","loading","success","selectedInterval","branchId","submitBookingApi","customer_id","start","number_of_guests","Date","username","validated","defaultValue","as","newValue","numberValue","parseInt","NaN","guestQuantityChanged","option","Feedback","Spinner","role","capacity","readOnly","minDate","SignUp","isFormValidated","setIsFormValidated","enteredFullName","enteredEmail","noValidate","email","nextPathname","ForgetPass","setisSubmitting","Fields","PostCodeCheckModal","formErrors","setFormErrors","isFormValid","setIsFormValid","presentingAddresses","setPresentingAddresses","deliveryCosts","setDeliveryCosts","isLoadingAddresses","setIsLoadingAddresses","presentingUserAddress","setPresentingUserAddress","enteredPostCode","selectedAddress","needsToSelectAddress","activePostalCodes","isSupportedWithResturant","lat","long","PostCode","Address","Breadcrumb","Check","whiteSpace","selectFromAddress","isInvalid","availablePostCodes","money","postFieldValueChanged","full_addresses","display","EnterCodeScreen","enteredCode","CurrentOrder","submitted","PaymentMethodType","StartCheckout","enteredAddressLine1","enteredAddressLine2","enteredTown","enteredDeliverTime","enteredMoreDescription","isActive","orderRows","count","order_rows","ResetPassScreen","enteredVerificationCode","enteredNewPassword","StripeCardField","shouldPay","successfull","gotError","stripe","useStripe","elements","useElements","payWithStripe","secretKey","cardElement","getElement","CardElement","confirmCardPayment","payment_method","card","PaymentScreen","shouldPayWithStripe","setShouldPayWithStripe","isStripeElementPresented","setIsStripeElementPresented","selectedMethod","stripePromise","loadStripe","stripe_publishable_key","stripeAccount","stripe_account_id","menuFilterPayments","CardOnDelivery","CashOnDelivery","Online","Offline","pay_methods","HistoryScreen","marginTop","ScrollToTop","scrollTo","RouteSwitcher","path","AppNavBar","AppNavigation","basename","i18n","use","initReactI18next","resources","en","translation","lng","keySeparator","interpolation","escapeValue","appSelector","rpReactPlugin","appAnchorElement","document","querySelector","ReactDOM","render","StrictMode","position"],"mappings":"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","file":"static/js/main.3dac901e.chunk.js","sourcesContent":["import { Id, MenuCategoryItem, MenuItem } from \"../type/menu\";\r\n\r\nexport enum ActionTypes {\r\n    updateSubCategoryOfCategory = 'updateSubCategoryOfCategory',\r\n    updateItemsOfCategory = 'updateItemsOfCategory'\r\n}\r\n\r\nexport type CategorySubCatUpdateAction = {\r\n    type: ActionTypes.updateSubCategoryOfCategory\r\n    subCats: MenuCategoryItem[]\r\n    catId?: Id\r\n}\r\n\r\nexport type CategoryItemsUpdateAction = {\r\n    type: ActionTypes.updateItemsOfCategory\r\n    items: MenuItem[]\r\n    catId: Id\r\n}\r\n\r\nexport type Action = CategorySubCatUpdateAction | CategoryItemsUpdateAction","/**\r\n * There are some definitions here which it seems it would be necessary to have a descriptoin\r\n *\r\n * @param {boolean} is_table it means this category || item can be delivered inside of resturant (Eat In)\r\n * @param {boolean} is_collect it means this category || item can be delivered inside of resturant - but! for outside (Take out)\r\n * @param {boolean} is_delivery it means this category || item can be delivered by delivery server (Delivery)\r\n */\r\n\r\nexport type Id = string\r\nexport type Name = string | null\r\nexport type ServiceConst = string | null //it can be null if the service is not available!\r\n\r\nexport type MenuCategoryItem = {\r\n    id: Id\r\n    order: number // the order of sorting - it would be useless (it seems)\r\n    name: Name\r\n    img_full_url: string\r\n    is_table: boolean\r\n    is_collect: boolean\r\n    is_delivery: boolean //mean has! delivery\r\n    has_items: boolean // if it's false then this is a cateogory of other categories, but if it's true then it's a catory of items\r\n    is_active: boolean\r\n    parent_id: string | null // if the category is a root one, then there would be no parent category id\r\n    partner_id: string | null\r\n    has_ingredients: boolean\r\n    size_names: string[]\r\n}\r\n\r\nexport type MenuItemSize = {\r\n    id: Id\r\n    name: Name\r\n    is_active: boolean\r\n    description: string\r\n    table_price: ServiceConst\r\n    collect_price: ServiceConst\r\n    delivery_price: ServiceConst\r\n}\r\n\r\nexport type MenuItem = {\r\n    id: Id\r\n    order: number\r\n    name: Name\r\n    description: string\r\n    category_id: string\r\n    partner_id: string\r\n    is_active: boolean\r\n    is_table: boolean\r\n    is_collect: boolean\r\n    is_delivery: boolean\r\n    img_full_url: string\r\n    eat_in_min_price: number\r\n    take_out_min_price: number\r\n    delivery_min_price: number\r\n    sizes: MenuItemSize[],\r\n    default_ingredients: Id[]\r\n    updated_at: Date\r\n    created_at: Date\r\n}\r\n\r\nexport enum MenuFilter { //it would be better to be renamed to OrderType\r\n    Delivery = 'delivery',\r\n    TakeOut = 'takeout',\r\n    Booking = 'booking'\r\n}\r\n\r\n// Store\r\n\r\nexport enum MenuContentType {\r\n    Category, Item\r\n}\r\n\r\nexport type MenuContent = {\r\n    type: MenuContentType.Category\r\n    value: MenuCategoryItem[]\r\n} | {\r\n    type: MenuContentType.Item\r\n    value: MenuItem[]\r\n}\r\n\r\nexport type MenuStore = {\r\n    rootCategories: MenuCategoryItem[]\r\n    fetchedCategoryContents: { [x in Id]: MenuContent }\r\n}\r\n\r\nexport type MenuContext = MenuStore & {\r\n    //if you pass no cat it would update the root categories\r\n    updateCategoryContent: (_e:{ cat?: MenuCategoryItem, catId?: Id, signal?: AbortSignal }) => Promise<MenuContent>\r\n}\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","//It's mutating function whic clear empty values of object\r\n\r\nimport { TimeInterval } from \"type/branch\";\r\nimport { Id, MenuFilter, MenuItem } from \"type/menu\";\r\nimport moment, { Moment } from 'moment'\r\nimport {UserAddress} from \"../type/user\";\r\n\r\n/**\r\n *\r\n * @param {Object {[x in string]: any}}  obj - the object you wanna clean\r\n * @param {boolean=} removeEmptyString - if you wanna also to clear the empty strings such as ''\r\n * @returns {Object} {[x: string]: any;}\r\n */\r\nexport function cleanObj(obj: {[x in string]: any}, removeEmptyString:boolean = false) {\r\n    Object.keys(obj).forEach((key) => (obj[key] === null || obj[key] === undefined || (removeEmptyString && typeof obj[key] == 'string' && obj[key].length === 0)) && delete obj[key])\r\n    return obj\r\n}\r\n\r\n//Printing look like 3,000,000 with comma and space\r\n/**\r\n * @param {string=} digits - string of digit you want to print look like 3,000,000\r\n * @returns {string}\r\n */\r\nexport const digitSpace = (digits: string): string =>\r\n    digits.replace(/(\\d)(?=(\\d\\d\\d)+(?!\\d))/g, `$1${','}`);\r\n\r\nexport const firstLetterUpperCase = (value: string): string =>\r\n    value && value[0].toUpperCase() + value.slice(1)\r\n\r\nexport const formatPostCode = (value: string): string =>\r\n    value.substr(0, value.length - 3) + \" \" + value.substr(-3)\r\n\r\nconst isDevelopment: boolean = !process.env.NODE_ENV || process.env.NODE_ENV === 'development';\r\n//Printing look like 3,000,000 with comma and space\r\n/**\r\n * @returns {boolean} is it's development evnrioment it would return true\r\n */\r\nexport const isDev = (): boolean => isDevelopment\r\n\r\nexport const addressToString = (address: UserAddress): string => {\r\n    return address.line1 + (address.line2 ? ', ' + address.line2 : '' ) + (address.town ? ', ' + address.town : '') +  ', ' + formatPostCode(address.postal_code);\r\n}\r\n\r\n/**\r\n * @type {string=}\r\n */\r\nexport const REQUEST_BRANCH: () => string | undefined = () => {\r\n    const branch_id = (window as any).branch_id;\r\n    return branch_id ? branch_id : (process.env ? process.env.REACT_APP_BRANCH : undefined);\r\n}\r\nexport const BASE_API_URI: () => string | undefined = () => process.env ? process.env.REACT_APP_BASE_URI : undefined\r\n\r\n/**\r\n * split the array into chunked with specified size\r\n * @param {T} inputArray input array\r\n * @param chunkSize chunk size\r\n * @returns\r\n */\r\nexport function chunkArray<T>(inputArray: T[], chunkSize: number): T[][] {\r\n    var index = 0;\r\n    var arrayLength = inputArray.length;\r\n    var tempArray: T[][] = [];\r\n\r\n    for (index = 0; index < arrayLength; index += chunkSize) {\r\n        let myChunk = inputArray.slice(index, index+chunkSize);\r\n        tempArray.push(myChunk);\r\n    }\r\n    return tempArray;\r\n}\r\n\r\nexport function getNumFrom(text: string): number | undefined {\r\n    let themnums = text.match(/\\d+[.]\\d+/)\r\n    if (themnums && themnums.length > 0) {\r\n        return parseFloat(themnums[0])\r\n    }\r\n    return undefined\r\n}\r\n\r\nexport function getPrice({item, filter, selectedSizeId}: {item: MenuItem, filter: MenuFilter, selectedSizeId?: Id }): number {\r\n    if (selectedSizeId) {\r\n        let selectedItems = item.sizes.filter(e => e.id == selectedSizeId)\r\n        if (selectedItems.length > 0) {\r\n            if (filter == MenuFilter.Delivery && selectedItems[0].delivery_price != null) {\r\n                let price = getNumFrom(selectedItems[0].delivery_price)\r\n                if (price) return price\r\n            }\r\n            else if (filter == MenuFilter.Booking && selectedItems[0].table_price != null) {\r\n                let price = getNumFrom(selectedItems[0].table_price)\r\n                if (price) return price\r\n            }\r\n            else if (filter == MenuFilter.TakeOut && selectedItems[0].collect_price != null) {\r\n                let price = getNumFrom(selectedItems[0].collect_price)\r\n                if (price) return price\r\n            }\r\n        }\r\n    }\r\n    if ( filter == MenuFilter.Delivery && !!item.delivery_min_price) return item.delivery_min_price\r\n    else if( filter == MenuFilter.TakeOut && !!item.take_out_min_price) return item.take_out_min_price\r\n    else if( filter == MenuFilter.Booking && !!item.eat_in_min_price) return item.eat_in_min_price\r\n\r\n    return 0\r\n}\r\n/**\r\n * fix the number of decimals of digits (remove them)\r\n * @param digit\r\n * @param decimal\r\n * @returns\r\n */\r\nexport function toFixed(digit: number, decimal: number): number {\r\n    if (decimal <= 1) return Math.floor(digit)\r\n    return Math.floor(digit * Math.pow(10, decimal)) / Math.pow(10, decimal);\r\n}\r\n\r\nconst emailRegx = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\nexport function validateEmail(email: string): boolean {\r\n    return emailRegx.test(String(email).toLowerCase());\r\n}\r\n\r\nexport function validatePostcode(postcode: string) {\r\n    postcode = postcode.replace(/\\s/g, \"\");\r\n    const regex = /^[A-Z]{1,2}[0-9]{1,2}[A-Z]{0,1} ?[0-9][A-Z]{2}$/i;\r\n    return regex.test(postcode);\r\n}\r\n\r\nexport const getErrorMessage = (e: any) => {\r\n    let message = 'There is problem in server connection';\r\n    if(e && typeof e.message == 'string'){\r\n        message = e.message;\r\n        if(e.hasOwnProperty('errors') && typeof e.errors == 'object'){\r\n            message = e.errors[Object.keys(e.errors)[0]];\r\n        }\r\n    }\r\n    return message;\r\n}\r\n\r\n/**\r\n *\r\n * @param { moment.Moment} now  assumptioning now time (it can be not real now!)\r\n * @param { TimeInterval } interval the time intervals for searching available times from\r\n * @returns { moment.Moment[] } it would return the array of moments to select with user\r\n */\r\nexport const getAvailableDeliverTimes = ({ now, intervals, startDelay }: { now: moment.Moment, intervals: TimeInterval[], startDelay: number }): moment.Moment[] => {\r\n    let result: moment.Moment[] = [];\r\n    now.minute((Math.floor(now.minutes()/15.3) + 1) * 15); // start now with rounded minutes 12:00, 12:15, 12:45, ...\r\n    now.add(startDelay, 'm');\r\n    let end = moment().add(1, 'day').hour(12).minute(0).second(0);\r\n\r\n    let weekday = new Array(7);\r\n    weekday[\"Monday\"] = 1;\r\n    weekday[\"Tuesday\"]= 2;\r\n    weekday[\"Wednesday\"] = 3;\r\n    weekday[\"Thursday\"] = 4;\r\n    weekday[\"Friday\"] = 5;\r\n    weekday[\"Saturday\"] = 6;\r\n    weekday[\"Sunday\"] = 7;\r\n\r\n    while(end.isAfter(now)){\r\n\r\n        if(intervals.some(time => {\r\n\r\n            if(weekday[time.week_day] < now.day() ||\r\n                weekday[time.week_day] > now.day() + 1)\r\n                return false;\r\n\r\n            // if(time.week_day != now.format('dddd')) return false;\r\n            let start_ = moment(now.format('YYYY-MM-DD')+' ' + time.start_time);\r\n            let end_ = moment(now.format('YYYY-MM-DD')+' ' + time.finish_time);\r\n\r\n            if(now.format('dddd') != time.week_day)\r\n                return false;\r\n\r\n            if(now.isAfter(start_) && now.isBefore(end_)) return true;\r\n            return false;\r\n        })) result.push(now);\r\n        now = moment(now).add(15, 'm');\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n *\r\n * @param { string } input the string that you want to remove the white spaces from\r\n * @returns { string }\r\n */\r\nexport const removeWhiteSpace = (input: string): string => input.replace(/ /g,'')\r\n","let localStorage = window.localStorage;\r\n\r\nexport async function saveInStorage(key: string, value: string) {\r\n    if (value) {\r\n        localStorage.setItem(key, value);\r\n    }\r\n}\r\nexport function getFromStorage(key: string): Promise<string> {\r\n    return new Promise<string>((resolve, reject) => {\r\n        let retrieved = localStorage.getItem(key)\r\n        retrieved ? resolve(retrieved): reject()\r\n\r\n    }) \r\n}\r\n\r\nexport function removeFromStorage(key: string) {\r\n    localStorage.removeItem(key)\r\n}","import { cleanObj, isDev } from './handy'\r\nimport { getFromStorage } from './storage'\r\n\r\n/**\r\n * it's a wrapper around fetch function for more control\r\n * you can use it to set request timeouts\r\n * better error handling\r\n * middle ware and intercepting requests\r\n * parsing after each request\r\n */\r\n\r\nexport type ReqInterCeptor = (req: RequestInit) => RequestInit\r\nexport type ResponseMiddleWare = (input: BodyWidthStatus<any>) => void\r\nexport const tokenStorageKey = 'TokenStorageKey'\r\n\r\nvar reqInterceptor: ReqInterCeptor | undefined\r\nvar resMiddleWare: ResponseMiddleWare | undefined\r\nvar reqTimeouts = 10000 //in milli-seconds\r\n\r\ntype BodyWidthStatus<T> = { json: T, status: number }\r\n\r\nfunction checkStatus<T>({ json, status }: BodyWidthStatus<T>): T {\r\n    if (status >= 200 && status < 300) {\r\n        return json;\r\n    } else {\r\n        isDev() && console.info(\"server error!\", `status code is ${status}`)\r\n        let error = Error()\r\n        throw { ...error, ...json, status }\r\n    }\r\n}\r\n\r\n//This function is a little tricky beacuse the most of the apis \r\n// return the T type in the data proporty but not all of them (.e.g. those with pagination)\r\n\r\nfunction getData<T>(json: { data: T }): T {\r\n    return json.data\r\n}\r\n\r\nfunction parseData<T>(responseBodyAsText: string):T | {} {\r\n    try {\r\n        return JSON.parse(responseBodyAsText);\r\n    } catch (e) {\r\n        isDev() && console.info(\"parse Error!\", responseBodyAsText)\r\n        return {}\r\n    }\r\n}\r\n\r\nexport function setInterceptor(int: ReqInterCeptor) {\r\n    reqInterceptor = int\r\n}\r\n\r\nexport function setGlobalHttpTimeout(timeout: number) {\r\n    reqTimeouts = timeout\r\n}\r\n\r\nexport function setResponseMiddleWare (responseMiddleWare: ResponseMiddleWare) {\r\n    resMiddleWare = responseMiddleWare\r\n}\r\n\r\n/**\r\n * simple http request wrapper for more functionalities\r\n * @param { Object RequestInfo } input \r\n * @param { Object RequestInit & { wholeRootResponse?: boolean }} init - if you use wholeRootResponse it would return the whole content (not ignoring the data)\r\n * @returns { Promise<T> } return Promise parsed Data (ready to use)\r\n */\r\nexport function http<T>(\r\n    input: RequestInfo,\r\n    init?: RequestInit & { wholeRootResponse?: boolean, \r\n    timeout?: number } | typeof undefined\r\n): Promise<T> {\r\n    let abortCtrl = new AbortController()\r\n    setTimeout(() => {\r\n        abortCtrl.abort()\r\n    }, init?.timeout || reqTimeouts);\r\n\r\n    return getFromStorage(tokenStorageKey)\r\n            .then((token) => { \r\n                return token\r\n            }).catch(() => {\r\n                return null\r\n            }).then((token) => {\r\n                return {\r\n                    ...init,\r\n                    headers: cleanObj({\r\n                        'Content-Type' : 'application/json',\r\n\t\t\t\"App-Name\": \"WebSite\",\r\n                        ...(!!init ? init.headers : {}),\r\n                        'Authorization': token ? `Bearer ${token}` : undefined\r\n                    })\r\n                }\r\n            })\r\n            .then((init) => {\r\n                if (reqInterceptor !== null && reqInterceptor !== undefined) { return reqInterceptor({...init}) }\r\n                init.signal?.addEventListener('abort', () => abortCtrl.abort())\r\n                return init\r\n            })\r\n            .then(init =>  { \r\n                return fetch(input, { ...init, signal: abortCtrl.signal })\r\n            })\r\n            .then((response) => {\r\n                return response.text()\r\n                    .then(parseData)\r\n                    .then((json: any): BodyWidthStatus<T> => { \r\n                        return  { json: json, status: response.status } \r\n                    })\r\n            }\r\n            )\r\n            .then((res) => {\r\n                if (resMiddleWare !== null && resMiddleWare !== undefined) { resMiddleWare(res) }\r\n                return res\r\n            })\r\n            .then( r => checkStatus(r))\r\n            .then((r: any) => { \r\n                if (init?.wholeRootResponse) return r\r\n                return getData<T>(r)\r\n            })\r\n}\r\n","import { http } from \"lib/http\";\r\nimport { MenuCategoryItem, MenuItem } from \"type/menu\";\r\nimport { REQUEST_BRANCH, BASE_API_URI } from \"lib/handy\";\r\n\r\nexport async function getMenuCategories({ parentCategory, abortSignal }: {parentCategory?: MenuCategoryItem, abortSignal?: AbortSignal}): Promise<MenuCategoryItem[]> {\r\n    if (!!parentCategory && (parentCategory.has_items == true )) return Promise.reject(Error('WrongRequest'))\r\n    return http<MenuCategoryItem[]>(\r\n        `${BASE_API_URI()}/api/v2/cm/branches/${REQUEST_BRANCH()}/categories${ parentCategory ? '?parent_id=' + parentCategory.id : '' }`,\r\n        { signal: abortSignal }\r\n    )\r\n}\r\n\r\nexport async function getMenuItem({ category, abortSignal }: {category: MenuCategoryItem, abortSignal?: AbortSignal}): Promise<MenuItem[]> {\r\n    if (category.has_items == false) return Promise.reject(Error('WrongRequest'))\r\n    return http<MenuItem[]>(`${BASE_API_URI()}/api/v2/cm/branches/${REQUEST_BRANCH()}/items?category_id=${ category.id }`, {\r\n        signal: abortSignal\r\n    })\r\n}","import { REQUEST_BRANCH, BASE_API_URI } from \"lib/handy\";\r\nimport { http } from \"lib/http\";\r\nimport { ResturantBranchInfo, PostCodeAddress } from \"type/branch\";\r\n\r\nvar cachedContent: ResturantBranchInfo | undefined\r\n\r\nexport async function getResturantBranchInfo(dont_cache:boolean = false): Promise<ResturantBranchInfo> {\r\n    if (cachedContent != undefined && !dont_cache) return Promise.resolve(cachedContent)\r\n    return http<ResturantBranchInfo>(`${BASE_API_URI()}/api/v2/cm/branches/${REQUEST_BRANCH()}`)\r\n            .then(res => {\r\n                cachedContent = res\r\n                return res\r\n            })\r\n}\r\n\r\nexport async function searchForPostCodeApi({ postCode, signal }: { postCode: string, signal?: AbortSignal }): Promise<PostCodeAddress[]> {\r\n    return http<PostCodeAddress[]>(`${BASE_API_URI()}/api/v2/postcode/find?postal_code=${ postCode }`, { signal })\r\n}\r\n","import { Action, ActionTypes } from \"actions/menuActions\";\r\nimport { MenuContentType, MenuStore } from \"type/menu\";\r\n\r\nexport const menuStoreInitializeContent: MenuStore = {\r\n    rootCategories: [],\r\n    fetchedCategoryContents: {}\r\n}\r\n\r\nexport const menuStoreReducer = (state: MenuStore = menuStoreInitializeContent, action: Action): MenuStore => {\r\n    switch (action.type) {\r\n        case ActionTypes.updateSubCategoryOfCategory: \r\n            if (action.catId === undefined) {\r\n                return {\r\n                    ...state,\r\n                    rootCategories: action.subCats\r\n                }\r\n            } else {\r\n                return {\r\n                    ...state,\r\n                    fetchedCategoryContents: {\r\n                        ...state.fetchedCategoryContents,\r\n                        [action.catId]: {\r\n                            type: MenuContentType.Category,\r\n                            value: action.subCats\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        case ActionTypes.updateItemsOfCategory:\r\n            return {\r\n                ...state,\r\n                fetchedCategoryContents: {\r\n                    ...state.fetchedCategoryContents,\r\n                    [action.catId]: {\r\n                        type: MenuContentType.Item,\r\n                        value: action.items\r\n                    }\r\n                }\r\n            }\r\n    }\r\n    return state\r\n}","import React from 'react'\r\nimport { ActionTypes } from '../actions/menuActions'\r\nimport { MenuCategoryItem, MenuContext, MenuContent, MenuContentType, MenuStore } from 'type/menu'\r\nimport { getMenuCategories, getMenuItem } from './webServiceApi/menu'\r\nimport { menuStoreReducer, menuStoreInitializeContent } from 'reducer/menuReducer'\r\n\r\nconst MenuContextContainer = React.createContext<MenuContext>({\r\n    rootCategories: [],\r\n    fetchedCategoryContents: {},\r\n    updateCategoryContent: () => { throw Error('You are using the context out of provider') }\r\n})\r\n\r\nconst MenuProvider = ({ children }: { children: React.ReactNode }) => {\r\n\r\n    const [menuContextStore, dispatch] = React.useReducer(menuStoreReducer, menuStoreInitializeContent)\r\n    const contextStoreRef = React.useRef<MenuStore>(menuContextStore)\r\n\r\n    React.useEffect(() => {\r\n        contextStoreRef.current = menuContextStore\r\n    }, [menuContextStore])\r\n\r\n    const updateCategoryContent = ({ cat, signal }: { cat?: MenuCategoryItem, signal?: AbortSignal }): Promise<MenuContent> => {\r\n        let currentMenuStore = contextStoreRef.current\r\n        if (cat !== undefined && currentMenuStore.fetchedCategoryContents[cat.id] !== undefined)\r\n            return Promise.resolve(currentMenuStore.fetchedCategoryContents[cat.id])\r\n        if (!!cat && cat.has_items == true) {\r\n            return getMenuItem({ category: cat, abortSignal: signal})\r\n                .then((res) => {\r\n                    if (typeof res === 'object' && res.length > 0) {\r\n                        dispatch({\r\n                            type: ActionTypes.updateItemsOfCategory,\r\n                            items: res,\r\n                            catId: cat.id\r\n                        })\r\n\r\n                        return {\r\n                            type: MenuContentType.Item,\r\n                            value: res\r\n                        }\r\n                    }\r\n                    throw Error('NotProperResponse')\r\n                })\r\n        }\r\n        \r\n        if (cat === undefined && currentMenuStore.rootCategories.length > 0) \r\n            return Promise.resolve({\r\n                type: MenuContentType.Category,\r\n                value: currentMenuStore.rootCategories\r\n            })\r\n        return getMenuCategories({ parentCategory: cat, abortSignal: signal })\r\n            .then((res) => {  \r\n                //update the store\r\n                if (typeof res === 'object' && res.length > 0) {\r\n                    dispatch({\r\n                        type: ActionTypes.updateSubCategoryOfCategory,\r\n                        subCats: res,\r\n                        catId: cat !== undefined ? cat.id : undefined\r\n                    })\r\n                    \r\n                    return {\r\n                        type: MenuContentType.Category,\r\n                        value: res\r\n                    }\r\n                }\r\n                throw Error('NotProperResponse')\r\n            })\r\n\r\n    }\r\n\r\n    const value: MenuContext = { \r\n        ...menuContextStore,\r\n        updateCategoryContent\r\n    }\r\n    return <MenuContextContainer.Provider value = { value } >{children}</MenuContextContainer.Provider>\r\n}\r\n\r\nexport const useMenuContext = () => React.useContext(MenuContextContainer)\r\n\r\nexport default MenuProvider","import { BASE_API_URI, cleanObj, REQUEST_BRANCH } from \"lib/handy\";\r\nimport { http } from \"lib/http\";\r\nimport { Order, SubmitingOrder } from \"type/market\";\r\nimport { MenuFilter } from \"type/menu\";\r\n\r\n\r\n\r\nexport async function submitOrderApi( inputs: SubmitingOrder ): Promise<Order> {\r\n    return http<Order>(`${BASE_API_URI()}/api/v2/cm/orders`,\r\n        { \r\n            method: 'POST',\r\n            body: JSON.stringify(cleanObj({\r\n                ...inputs,\r\n                branch_id: REQUEST_BRANCH(),\r\n                order_type: inputs.order_type == MenuFilter.Delivery ? 2 : 1,\r\n                source: 'web'\r\n            }))\r\n        }\r\n    )\r\n}\r\n\r\nexport async function subitPaymentMethodApi({ order_id, pay_method_id }: {order_id: string, pay_method_id: string}): Promise<void> {\r\n    return http(`${BASE_API_URI()}/api/v2/cm/payment/order-pay-method`, {\r\n        method: 'POST',\r\n        body: JSON.stringify({ order_id, pay_method_id })\r\n    })\r\n}\r\n\r\nexport async function getStripeSecretKeyApi({ order_id }: { order_id: string }): Promise<{ amount: number, client_secret: string }> {\r\n    return http(`${BASE_API_URI()}/api/v2/cm/payment/intent`, {\r\n        method: 'POST',\r\n        body: JSON.stringify({ order_id })\r\n    })\r\n}","import React from 'react'\r\nimport toast from 'react-hot-toast'\r\nimport { useTranslation } from 'react-i18next'\r\nimport { PostCodeAddress, ResturantBranchInfo, ResturantPaymentMethod } from 'type/branch'\r\nimport {MarketContext, BasketItem, SavingPostalCode, SubmitingOrder, Order, OrderHistory} from \"type/market\"\r\nimport { MenuFilter } from 'type/menu'\r\nimport { getResturantBranchInfo, searchForPostCodeApi } from './webServiceApi/branch'\r\nimport { getFromStorage, removeFromStorage, saveInStorage } from 'lib/storage'\r\nimport {\r\n    addressToString,\r\n    getAvailableDeliverTimes,\r\n    getErrorMessage,\r\n    getNumFrom,\r\n    isDev,\r\n    removeWhiteSpace,\r\n    REQUEST_BRANCH\r\n} from 'lib/handy'\r\nimport moment from 'moment'\r\nimport { getStripeSecretKeyApi, subitPaymentMethodApi, submitOrderApi } from './webServiceApi/market'\r\nimport {UserAddress} from \"../type/user\";\r\n\r\nconst MarketContextContainer = React.createContext<MarketContext>({\r\n    basketItems: [],\r\n    history: [],\r\n    searchForPostCode: async () => { throw Error('not Implemented') },\r\n    selectPostCode: () => false,\r\n    isRestaurantActiveNow: () => false,\r\n    addToBasket: () => {},\r\n    removeFromBasket: () => {},\r\n    setActiveMenuFilter: () => {},\r\n    updateBasketItem: () => {},\r\n    clearBasket: () => {},\r\n    clearOrderHistory: () => {},\r\n    saveOrderInHistory: () => {},\r\n    submitOrder: async () => {},\r\n    assignPaymentMethod: async () => {},\r\n    getStripeSecretKey: async () => { throw Error('not Implemented') },\r\n})\r\n\r\nconst MarketProvider = ({ children }: { children: React.ReactNode }) => {\r\n\r\n    //hooks\r\n    const { t } = useTranslation()\r\n\r\n    const BRANCH_ID = REQUEST_BRANCH()\r\n\r\n    //consts\r\n    const basketStorageKey = 'BasketStoreKey-' + BRANCH_ID;\r\n    const historyStorageKey = 'historyStoreKey-' + BRANCH_ID;\r\n    const activeFilterStorageKey = 'activeFilter-' + BRANCH_ID;\r\n    const selectedPostCodeWithAddressKey = 'selectedPostCode-' + BRANCH_ID;\r\n\r\n    //states\r\n    const [storeInfo, setStoreInfo] = React.useState<ResturantBranchInfo>()\r\n    const [basketItems, setBasketItems] = React.useState<BasketItem[]>([])\r\n    const [history, setHistory] = React.useState<OrderHistory[]>([])\r\n    const [activeMenuFilter, setActiveMenuFilter] = React.useState<MenuFilter>()\r\n    const [deliveryTime, setDeliveryTime] = React.useState<number>()\r\n    const [deliveryCost, setDeliveryCost] = React.useState<number>()\r\n    const [availableDeliverTime, setAvailableDeliverTime] = React.useState<moment.Moment[]>()\r\n    const [activePostCode, setActivePostCode] = React.useState<SavingPostalCode>()\r\n    const [submittedOrder, setSubmittedOrder] = React.useState<Order>()\r\n\r\n    //references\r\n    const isInitialized = React.useRef<boolean>(false)\r\n    const storeInfoRef = React.useRef<ResturantBranchInfo | undefined>(storeInfo)\r\n    const activeMenuFilterRef = React.useRef<MenuFilter>()\r\n    const abortCtrl = React.useRef<AbortController>()\r\n    const submittedOrderRef = React.useRef<Order | undefined>(submittedOrder)\r\n\r\n    //in order to prevnet stale refenrece effect\r\n    React.useEffect(() => {\r\n        storeInfoRef.current = storeInfo\r\n    }, [storeInfo])\r\n\r\n    React.useEffect(() => {\r\n        submittedOrderRef.current = submittedOrder\r\n    }, [submittedOrder])\r\n\r\n    React.useEffect(() => {\r\n        activeMenuFilterRef.current = activeMenuFilter\r\n        if (activeMenuFilter != MenuFilter.Delivery) {\r\n            setDeliveryTime(undefined)\r\n            setDeliveryCost(undefined)\r\n        }\r\n    }, [activeMenuFilter])\r\n\r\n    React.useEffect(() => {\r\n        if (storeInfo != undefined && activeMenuFilter != undefined) {\r\n            setAvailableDeliverTime(getAvailableDeliverTimes({\r\n                intervals: activeMenuFilter == MenuFilter.Delivery ? storeInfo.delivery_times : storeInfo.takeout_times,\r\n                startDelay: activeMenuFilter == MenuFilter.Delivery ? storeInfo.min_expected_delivery_time : storeInfo.min_expected_takeout_time,\r\n                now: moment()\r\n            }))\r\n        }\r\n    }, [activeMenuFilter, storeInfo])\r\n\r\n    React.useEffect(() => {\r\n        restoreLocalContents()\r\n        getResturantBranchInfo()\r\n        .then((resp) => {\r\n            setStoreInfo(resp)\r\n            restoreLocalContents()\r\n            }).catch((e) => {\r\n                toast.error(getErrorMessage(e))\r\n            })\r\n        setInterval(() => {\r\n            getResturantBranchInfo(true)\r\n                .then((resp) => {\r\n                    setStoreInfo(resp)\r\n                    restoreLocalContents()\r\n                }).catch((e) => {\r\n                toast.error(getErrorMessage(e))\r\n            })\r\n        }, 60000)\r\n    }, [])\r\n\r\n    React.useEffect(() => {\r\n        if (isInitialized.current) {\r\n            activeMenuFilter && saveInStorage(activeFilterStorageKey, activeMenuFilter)\r\n        }\r\n    }, [activeMenuFilter])\r\n\r\n    React.useEffect(() => {\r\n        isInitialized.current &&\r\n        saveInStorage(basketStorageKey, JSON.stringify({basket: basketItems, lastUpdate: moment().format('YYYY-MM-DD HH:mm:ss')}))\r\n    }, [basketItems])\r\n\r\n    React.useEffect(() => {\r\n        isInitialized.current &&\r\n        saveInStorage(historyStorageKey, JSON.stringify(history))\r\n    }, [history])\r\n\r\n    const restoreLocalContents = () => {\r\n        //retrive the previous actions\r\n        getFromStorage(activeFilterStorageKey)\r\n            .then((resp) => {\r\n                let prevFilter = resp as MenuFilter\r\n                if (prevFilter != null) setActiveMenuFilter(prevFilter)\r\n                return getFromStorage(basketStorageKey)\r\n                    .then((basketContent) => {\r\n                        if (basketContent != undefined && basketContent != null) {\r\n                            try {\r\n                                let content = JSON.parse(basketContent)\r\n                                let basket: BasketItem[] = content.basket;\r\n                                let lastUpdate = moment(content.lastUpdate);\r\n                                if(lastUpdate.isBefore(moment().subtract(5, 'hours'))){\r\n                                    basket = [];\r\n                                }\r\n                                setBasketItems(basket);\r\n                            } catch (e) {\r\n                                isDev() && console.warn(e)\r\n                                removeFromStorage(basketStorageKey)\r\n                            }\r\n                        }\r\n                    }).then(() => {\r\n                        if (prevFilter == MenuFilter.Delivery) {\r\n                            return getFromStorage(selectedPostCodeWithAddressKey)\r\n                                .then((res) => {\r\n                                    let parsedContent: SavingPostalCode = JSON.parse(res)\r\n                                    selectPostCode({ ... parsedContent })\r\n                                }).catch()\r\n                        }\r\n                        return\r\n                    }).then(() => {\r\n                        return getFromStorage(historyStorageKey)\r\n                            .then((res) => {\r\n                                let parsedContent: OrderHistory[] = JSON.parse(res)\r\n                                // remove orders older than 1 days\r\n                                const expire_date = moment().subtract('24', 'hours');\r\n                                parsedContent = parsedContent.filter(o => moment(o.created_at, 'DD/MM/YYYY HH:mm:ss').isAfter(expire_date));\r\n                                setHistory(parsedContent)\r\n                            }).catch()\r\n                    })\r\n            })\r\n            .catch() //\r\n            .finally(() => {\r\n                isInitialized.current = true\r\n            })\r\n    }\r\n\r\n    const addToBasket = (item: BasketItem) => {\r\n        if (storeInfoRef.current == undefined) {\r\n            let message = t('NotProperResponse')\r\n            toast.error(message)\r\n            return\r\n        }\r\n\r\n        setBasketItems(p => {\r\n            let prevSameItems = p.filter(e => e.item.id == item.item.id && e.sizeOptionId == item.sizeOptionId )\r\n            return prevSameItems.length > 0 ?\r\n                        p.map(e => e.item.id == item.item.id && e.sizeOptionId == item.sizeOptionId ? { ...e, quantity:  e.quantity + item.quantity } : e) :\r\n                        [ ...p, item ]\r\n        })\r\n    }\r\n\r\n    const saveOrderInHistory = () => {\r\n        const order:OrderHistory = {\r\n            id: submittedOrder?.id,\r\n            payment: submittedOrder?.preferred_pay_method,\r\n            created_at: moment().format('DD/MM/yy HH:mm:ss'),\r\n            delivery_charge: deliveryCost,\r\n            delivery_date: submittedOrder?.delivery_date,\r\n            order_type: activeMenuFilter,\r\n            rows: basketItems,\r\n            description: submittedOrder?.description,\r\n            total: submittedOrder?.payable_amount,\r\n            address: submittedOrder?.customer_info.address ? addressToString(submittedOrder?.customer_info.address as UserAddress) : '',\r\n        };\r\n        setHistory([order, ...history])\r\n    }\r\n\r\n    const removeFromBasket = (item: BasketItem) => {\r\n        setBasketItems(p => p.filter(e => e.item.id != item.item.id || item.sizeOptionId != e.sizeOptionId ))\r\n    }\r\n\r\n    const updateBasketItem = (index: number, item: BasketItem) => {\r\n        let prevSameItems = basketItems.findIndex((e, i) => e.item.id == item.item.id && e.sizeOptionId == item.sizeOptionId && i != index );\r\n        if(prevSameItems >= 0) {\r\n            setBasketItems(p => {\r\n                const items = p.map((e, i) => {\r\n                    if(i == prevSameItems){\r\n                        e.quantity += item.quantity;\r\n                    }\r\n                    return e;\r\n                });\r\n                items.splice(index, 1);\r\n                return items;\r\n            });\r\n            return;\r\n        }\r\n        setBasketItems(p => p.map((e, i) => {\r\n            return i == index ? item : e;\r\n        }))\r\n    }\r\n\r\n    const clearBasket = () => {\r\n        setBasketItems([])\r\n    }\r\n\r\n    const clearOrderHistory = () => {\r\n        setHistory([]);\r\n        removeFromStorage(historyStorageKey);\r\n    }\r\n\r\n    const searchForPostCode = (postCode: string): Promise<PostCodeAddress[]> => {\r\n        abortCtrl.current && abortCtrl.current.abort()\r\n        abortCtrl.current = new AbortController()\r\n        return searchForPostCodeApi({postCode, signal: abortCtrl.current?.signal })\r\n            .then((r) => {\r\n                abortCtrl.current = undefined\r\n                return r\r\n            })\r\n    }\r\n\r\n    const selectPostCode = ({ postCode, ...rest }: SavingPostalCode): boolean => {\r\n        let upperCasedPostCode = removeWhiteSpace(postCode.toUpperCase())\r\n        let supportedPostCodes = storeInfoRef.current?.post_codes.filter((e) => upperCasedPostCode.includes(e.post_code) )\r\n        if (supportedPostCodes && supportedPostCodes?.length > 0) {\r\n            saveInStorage(selectedPostCodeWithAddressKey, JSON.stringify({ postCode, ...rest }))\r\n            setActivePostCode({ postCode, ...rest })\r\n            setDeliveryCost(getNumFrom(supportedPostCodes[0].delivery_charge))\r\n            if (storeInfoRef.current?.min_expected_delivery_time) {\r\n                setDeliveryTime(storeInfoRef.current?.min_expected_delivery_time)\r\n            }\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n\r\n    const submitOrder = (input: SubmitingOrder): Promise<void> => {\r\n        return submitOrderApi(input).then(setSubmittedOrder)\r\n    }\r\n\r\n    const assignPaymentMethod = (method: ResturantPaymentMethod): Promise<void> => {\r\n        if (submittedOrderRef.current == undefined) return Promise.reject('There is no order!!')\r\n        if(submittedOrder) submittedOrder.preferred_pay_method = method.title;\r\n        return subitPaymentMethodApi({\r\n            order_id: submittedOrderRef.current.id,\r\n            pay_method_id: method.id\r\n        }).then(() => {\r\n            setSubmittedOrder(undefined)\r\n        })\r\n    }\r\n\r\n    const getStripeSecretKey = (): Promise<string> => {\r\n        if (submittedOrderRef.current == undefined) return Promise.reject('There is no order!!')\r\n        return getStripeSecretKeyApi({ order_id: submittedOrderRef.current.id })\r\n            .then((res) => res.client_secret)\r\n    }\r\n\r\n    const isRestaurantActiveNow = () => {\r\n        if (storeInfo == undefined) { return false }\r\n        if (activeMenuFilterRef.current == MenuFilter.Delivery) {\r\n            // storeInfo.is_delivery_active && storeInfo.delivery_times\r\n            return true\r\n        } else {\r\n            return true\r\n        }\r\n    }\r\n\r\n\r\n    const value: MarketContext = {\r\n        storeInfo,\r\n        basketItems,\r\n        history,\r\n        deliveryTime,\r\n        deliveryCost,\r\n        activePostCode,\r\n        activeMenuFilter,\r\n        availableDeliverTime,\r\n        submittedOrder: submittedOrder,\r\n        clearBasket,\r\n        saveOrderInHistory,\r\n        clearOrderHistory,\r\n        submitOrder,\r\n        addToBasket,\r\n        selectPostCode,\r\n        removeFromBasket,\r\n        updateBasketItem,\r\n        searchForPostCode,\r\n        assignPaymentMethod: assignPaymentMethod,\r\n        getStripeSecretKey: getStripeSecretKey,\r\n        setActiveMenuFilter,\r\n        isRestaurantActiveNow: isRestaurantActiveNow,\r\n    }\r\n    return <MarketContextContainer.Provider value = { value } >{children}</MarketContextContainer.Provider>\r\n}\r\n\r\nexport const useMarketContext = () => React.useContext(MarketContextContainer)\r\n\r\nexport default MarketProvider\r\n","import React from 'react'\r\nimport { Col, Container, Row } from 'react-bootstrap'\r\nimport './style.scss'\r\nimport { useTranslation } from 'react-i18next'\r\nimport { Link, useLocation } from 'react-router-dom'\r\nimport { useMarketContext } from 'store/marketStore'\r\n\r\nconst Home = () => {\r\n\r\n    //hooks\r\n    let location = useLocation();\r\n    const { t } = useTranslation()\r\n    const { storeInfo } = useMarketContext()\r\n\r\n    return <Container>\r\n        <Row>\r\n            <Col>\r\n                <div className=\"background\">\r\n                    <div className='overlayContentWrapper'>\r\n                        <p className='bg-title'>{ storeInfo?.full_name }</p>\r\n                    </div>\r\n                </div>\r\n                <div className='actionButtons'>\r\n                    { storeInfo?.is_take_out_active == true && <Link to = '/order/takeout' className='orderButton'>Order Takeout Now</Link> }\r\n                    { storeInfo?.is_delivery_active == true &&\r\n                        <Link to = {{\r\n                            pathname: '/postcode-check',\r\n                            state: { background: location\r\n                        }}} className='orderButton'>Order Delivery Now</Link>\r\n                    }\r\n                </div>\r\n                {/*<div className='actionButtons'>*/}\r\n                    {/*{ storeInfo?.is_booking_active == true && <Link to = '/booking' className='bookingButton'>Book Now</Link> }*/}\r\n                {/*</div>*/}\r\n            </Col>\r\n        </Row>\r\n    </Container>\r\n}\r\n\r\nexport default Home\r\n","import React from 'react'\r\nimport {useHistory} from \"react-router-dom\";\r\n\r\nconst Redirector = () => {\r\n\r\n    const history = useHistory();\r\n    history.go(-2);\r\n\r\n    return <div />\r\n};\r\n\r\nexport default Redirector","import { http } from \"lib/http\"\r\nimport { BASE_API_URI } from \"lib/handy\"\r\nimport { RegisterInputs, UserAddress } from \"type/user\"\r\nimport { UserInfo } from \"type/user\"\r\n\r\nexport async function register( inputs: RegisterInputs ): Promise<{ request_id: string }> {\r\n    return http<{ request_id: string }>(`${BASE_API_URI()}/api/v2/cm/users/register`,\r\n        { \r\n            method: 'POST',\r\n            body: JSON.stringify(inputs)\r\n        }\r\n    )\r\n}\r\n\r\nexport async function resendSms(request_id: string): Promise<void> {\r\n    return http(`${BASE_API_URI()}/api/v2/cm/users/resend-verify-code`, \r\n    {\r\n        method: 'POST',\r\n        body: JSON.stringify({ request_id })\r\n    })\r\n}\r\n\r\nexport async function verifyPhone({ request_id, verify_code }: { request_id: string, verify_code: string }): Promise<{ user: UserInfo, token: string }> {\r\n    return http<{ user: UserInfo, token: string }>(`${BASE_API_URI()}/api/v2/cm/users/verify`, \r\n    {\r\n        method: 'POST',\r\n        body: JSON.stringify({ request_id, verify_code })\r\n    })\r\n}\r\n\r\nexport async function login({ mobile, password }: { mobile: string, password: string }): Promise<{ user: UserInfo, token: string}> {\r\n    return http<{ user: UserInfo, token: string }>(`${BASE_API_URI()}/api/v2/cm/users/login`, {\r\n        method: 'POST',\r\n        body: JSON.stringify({ mobile, password })\r\n    })\r\n}\r\n\r\nexport async function getAddressesApi(): Promise<UserAddress[]> {\r\n    return http<UserAddress[]>(`${BASE_API_URI()}/api/v2/cm/addresses`)\r\n}\r\n\r\nexport async function addAddressesApi(address: UserAddress): Promise<void> {\r\n    return http(`${BASE_API_URI()}/api/v2/cm/addresses`, {\r\n        method: 'POST',\r\n        body: JSON.stringify(address)\r\n    })\r\n}\r\n\r\nexport async function forgetPassApi(mobile: string): Promise<{ request_id: string }> {\r\n    return http<{ request_id: string }>(`${BASE_API_URI()}/api/v2/cm/users/forget-pass`, {\r\n        method: 'POST',\r\n        body: JSON.stringify({ mobile })\r\n    })\r\n}\r\n\r\nexport async function resetPasswordApi({ request_id, verify_code, password }: { request_id: string, verify_code: string, password: string }): Promise<void> {\r\n    return http(`${BASE_API_URI()}/api/v2/cm/users/change-pass`, {\r\n        method: 'POST',\r\n        body: JSON.stringify({ request_id, verify_code, password })\r\n    })\r\n}","import { tokenStorageKey } from 'lib/http'\r\nimport { getFromStorage, removeFromStorage, saveInStorage } from 'lib/storage'\r\nimport React from 'react'\r\nimport { RegisterInputs, UserAddress, UserContext, UserInfo } from 'type/user'\r\nimport {\r\n    login as loginApi,\r\n    register as registerApi,\r\n    verifyPhone as verifyPhoneApi,\r\n    resendSms as resendSmsApi,\r\n    getAddressesApi,\r\n    addAddressesApi,\r\n    forgetPassApi,\r\n    resetPasswordApi\r\n} from './webServiceApi/user'\r\nimport {useMarketContext} from \"./marketStore\";\r\n\r\n\r\nconst UserContextContainer = React.createContext<UserContext>({\r\n    addAddress: async () => {},\r\n    getUserAddress: async () => { return [] },\r\n    resendSms: async () => {},\r\n    verifyPhone: async () => {},\r\n    register: async () => {},\r\n    login: async () => {},\r\n    logout: () => {},\r\n    forgetPass: async () => {},\r\n    resetPassword: async () => {}\r\n})\r\n\r\nconst UserProvider = ({ children }: { children: React.ReactNode }) => {\r\n\r\n    //consts\r\n    const userStorageKey = 'UserStorageKey'\r\n\r\n    const {clearOrderHistory} = useMarketContext();\r\n\r\n    //states\r\n    const [user, setUser] = React.useState<UserInfo>()\r\n    const [temporaryPhone, setTemproryPhone] = React.useState<string>()\r\n\r\n    //references\r\n    const temporaryPhoneRef = React.useRef<string>()\r\n    const registerRequestId = React.useRef<string>()\r\n    const userAddresses = React.useRef<UserAddress[]>([])\r\n\r\n    React.useEffect(() => {\r\n        getFromStorage(userStorageKey)\r\n            .then((retrievedUser) => {\r\n                try {\r\n                    let user = JSON.parse(retrievedUser);\r\n                    setUser(user);\r\n                    if (!!user) {\r\n                        //retrieve all user's addresses\r\n                        getUserAddress().catch((x) => {\r\n\r\n                            if(x.toLocaleString() == \"Error: token mismatch\") {\r\n                                removeFromStorage(userStorageKey);\r\n                                removeFromStorage(tokenStorageKey);\r\n                                logout();\r\n                            }\r\n                        });\r\n                    }\r\n                } catch {\r\n                    removeFromStorage(userStorageKey);\r\n                    removeFromStorage(tokenStorageKey);\r\n                }\r\n            }).catch(() => {\r\n                //no need to do anything\r\n            })\r\n    }, []);\r\n\r\n    const getUserAddress = (): Promise<UserAddress[]> => {\r\n        if (userAddresses.current.length > 0)\r\n            return Promise.resolve(userAddresses.current);\r\n        return getAddressesApi()\r\n            .then((r) => userAddresses.current = r)\r\n            .catch(function (x) {\r\n                if(x[\"status_code\"] == 401)\r\n                    throw new Error('token mismatch');\r\n\r\n                throw new Error('other reason');\r\n            })\r\n    };\r\n\r\n    const addAddress = (address: UserAddress): Promise<void> => {\r\n        return addAddressesApi(address)\r\n            .then(() => {\r\n                userAddresses.current = [...userAddresses.current, address]\r\n                return\r\n            })\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        temporaryPhoneRef.current = temporaryPhone\r\n    }, [temporaryPhone])\r\n\r\n    React.useEffect(() => {\r\n        user != undefined &&\r\n            saveInStorage(userStorageKey, JSON.stringify(user))\r\n    }, [user])\r\n\r\n    const resendSms = (): Promise<void>  =>  {\r\n        if (registerRequestId.current == undefined || temporaryPhoneRef.current == undefined) return Promise.reject(Error('PleaseEnterPhone'))\r\n        return resendSmsApi(registerRequestId.current)\r\n    }\r\n\r\n    const verifyPhone = (verify_code: string ): Promise<void>  =>  {\r\n        if (temporaryPhoneRef.current == undefined || registerRequestId.current == undefined) return Promise.reject()\r\n        return verifyPhoneApi({ request_id: registerRequestId.current, verify_code })\r\n            .then((result) => {\r\n                if (result && result.user && result.token) {\r\n                    setUser(result.user)\r\n                    saveInStorage(tokenStorageKey, result.token)\r\n                } else {\r\n                    throw Error('NotProperResponse')\r\n                }\r\n            })\r\n    }\r\n\r\n    const register = ( inputs: RegisterInputs ): Promise<void>  =>  {\r\n        return registerApi(inputs)\r\n            .then((response) => {\r\n                registerRequestId.current = response.request_id\r\n                setTemproryPhone(inputs.mobile)\r\n                return\r\n            })\r\n    }\r\n\r\n    const login = (input: { mobile: string, password: string }): Promise<void> => {\r\n        return loginApi(input)\r\n            .then((result) => {\r\n                if (result && result.user && result.token) {\r\n                    setUser(result.user)\r\n                    saveInStorage(tokenStorageKey, result.token)\r\n                } else {\r\n                    throw Error(JSON.stringify(result))\r\n                }\r\n            })\r\n    }\r\n\r\n    const forgetPass = ({ mobile }: { mobile: string }): Promise<void> => {\r\n        return forgetPassApi(mobile)\r\n            .then(({ request_id }) => { registerRequestId.current = request_id })\r\n    }\r\n\r\n    const resetPassword = ({ newPass, verifyCode }: { newPass: string, verifyCode: string }): Promise<void> => {\r\n        if (registerRequestId.current == undefined) return Promise.reject(Error('PleaseEnterPhone'))\r\n\r\n        return resetPasswordApi({\r\n            request_id: registerRequestId.current,\r\n            password: newPass,\r\n            verify_code: verifyCode\r\n        })\r\n    }\r\n\r\n    const logout = () => {\r\n        setUser(undefined)\r\n        clearOrderHistory()\r\n        removeFromStorage(userStorageKey)\r\n        removeFromStorage(tokenStorageKey)\r\n    }\r\n\r\n    let value: UserContext = {\r\n        user,\r\n        temporaryPhone,\r\n        login,\r\n        logout,\r\n        register,\r\n        resendSms,\r\n        forgetPass,\r\n        addAddress,\r\n        verifyPhone,\r\n        resetPassword,\r\n        getUserAddress\r\n    };\r\n\r\n    return <UserContextContainer.Provider value = { value } >{children}</UserContextContainer.Provider>\r\n}\r\n\r\nexport const useUser = () => React.useContext(UserContextContainer)\r\n\r\nexport default UserProvider\r\n","import React, { CSSProperties } from \"react\";\r\nimport { Form, FormControlProps, InputGroup } from 'react-bootstrap'\r\n\r\n\r\n\r\nconst PasswordField = (props: FormControlProps & { required: boolean, name: string, placeholder: string }) => {\r\n\r\n    const [inputType, setInputType] = React.useState<'password' | 'text'>('password')\r\n    const handleClick = () => setInputType((type) => (type === 'text' ? 'password' : 'text'))\r\n\r\n    return <InputGroup>\r\n        <Form.Control { ...props } type = { inputType }/>\r\n        <InputGroup.Append>\r\n            <InputGroup.Text style = { styles.cursorPointer } onClick = { handleClick }>{ inputType == 'password' ?  'Show Password': 'Hide password' }</InputGroup.Text>\r\n        </InputGroup.Append>\r\n    </InputGroup>\r\n}\r\n\r\nconst styles: { [x in string]: CSSProperties } = {\r\n    cursorPointer: {\r\n        cursor: 'pointer'\r\n    }\r\n}\r\n\r\nexport default PasswordField","import React from 'react'\r\nimport { Container, Row, Col, Form, Button, Card } from 'react-bootstrap'\r\nimport toast from 'react-hot-toast'\r\nimport { useTranslation } from 'react-i18next'\r\nimport PhoneInput from 'react-phone-input-2'\r\nimport { Link, useHistory, useLocation } from 'react-router-dom'\r\nimport { useUser } from 'store/userStore'\r\nimport PasswordField from 'components/passwordField'\r\nimport {getErrorMessage} from \"../../lib/handy\";\r\nimport construct = Reflect.construct;\r\nimport {getActiveBookingApi} from \"../../store/webServiceApi/booking\";\r\n\r\nconst Login = () => {\r\n\r\n    //hooks\r\n    const { login } = useUser();\r\n    const { state } = useLocation<{nextPathname: string}>();\r\n    const history = useHistory();\r\n    const { t } = useTranslation();\r\n\r\n    //state\r\n    const [isFormSubmitting, setIsFormSubmitting] = React.useState<boolean>(false)\r\n\r\n    React.useEffect(() => {\r\n\r\n        if(window.localStorage.TokenStorageKey !== undefined &&\r\n            window.localStorage.TokenStorageKey != null &&\r\n            window.localStorage.TokenStorageKey != \"null\" &&\r\n            window.localStorage.TokenStorageKey.length > 0\r\n        ) {\r\n            history.goBack();\r\n        }\r\n\r\n    }, []);\r\n\r\n    //reference\r\n    const enteredPhone = React.useRef<string>();\r\n    const enteredPass = React.useRef<string>();\r\n\r\n    const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n\r\n        if (enteredPhone.current != undefined &&\r\n            enteredPass.current != undefined) {\r\n            setIsFormSubmitting(true);\r\n            login({\r\n                mobile: enteredPhone.current,\r\n                password: enteredPass.current\r\n            })\r\n                .then(() => {\r\n                    // window.location.href = window.location.href.substr(0, window.location.href.indexOf(\"/menu/login\")) + \"/menu\";\r\n                    // history.replace({ pathname: state?.nextPathname || \"/\" })\r\n                    if(window.localStorage.refer !== undefined &&\r\n                        !window.localStorage.refer.includes(\"forgetpass\")\r\n                    ) {\r\n                        var refer = window.localStorage.refer;\r\n                        window.localStorage.removeItem(\"refer\");\r\n                        window.location.href = refer;\r\n                    }\r\n                    else\r\n                        window.location.href = \"/\";\r\n                })\r\n                .catch((e) => {\r\n                    toast.error(getErrorMessage(e))\r\n                }).finally(() => {\r\n                    setIsFormSubmitting(false)\r\n                })\r\n        }\r\n    };\r\n\r\n    return <Container>\r\n        <Row>\r\n            <Col md = {{ span: 6, offset: 3 }}>\r\n                <Form.Group />\r\n                <Card>\r\n                    <Card.Body>\r\n                        <Form.Group >\r\n                            <h1 className='centered'>\r\n                                Welcome Back..\r\n                            </h1>\r\n                        </Form.Group>\r\n                        <Form onSubmit = { handleSubmit }>\r\n                            <Form.Group controlId=\"formUserEmail\">\r\n                                <Form.Label>Mobile Number <span className=\"required\">*</span></Form.Label>\r\n                                <PhoneInput\r\n                                    country = { 'gb' }\r\n                                    onlyCountries = {[ 'ie', 'ch', 'no', 'gb' ]}\r\n                                    onChange = { value => enteredPhone.current = value }\r\n                                    inputClass = 'phone-input-form-control'\r\n                                    countryCodeEditable={false}\r\n                                    inputProps={{\r\n                                        name: 'phone',\r\n                                        required: true,\r\n                                        autoFocus: true\r\n                                    }}\r\n                                />\r\n                            </Form.Group>\r\n\r\n                            <Form.Group controlId=\"formUserPassword\">\r\n                                <Form.Label>Password <span className=\"required\">*</span></Form.Label>\r\n                                <PasswordField\r\n                                    required =  { true }\r\n                                    onChange = { e => enteredPass.current = e.target.value }\r\n                                    name='password'\r\n                                    placeholder=\"Password\"\r\n                                    />\r\n                            </Form.Group>\r\n                            <Form.Group controlId=\"formBasicCheckbox\">\r\n                                <Row>\r\n                                    <Col sm = {{ span: 6, offset: 6 }} className='textAlignRight'>\r\n                                        <Link to='/forgetpass'>Forget Password?</Link>\r\n                                    </Col>\r\n                                </Row>\r\n                            </Form.Group>\r\n                            <div className=\"centered form-group\">\r\n                                <Button disabled = { isFormSubmitting } variant=\"primary\" type=\"submit\">\r\n                                    sign in\r\n                                </Button>\r\n                            </div>\r\n                            <div className='centered'>\r\n                                <p>Don't have an account? <Link to='/signup'>Sign Up</Link></p>\r\n                            </div>\r\n                        </Form>\r\n                    </Card.Body>\r\n                </Card>\r\n            </Col>\r\n        </Row>\r\n    </Container>\r\n};\r\n\r\nexport default Login\r\n","import React from 'react'\r\nimport { Col, Container, Row } from 'react-bootstrap'\r\n\r\n//styles\r\nimport './styles.scss'\r\n\r\n//assets\r\nimport checkIcon from 'images/menu/check-icon.png'\r\nimport uncheckIcon from 'images/menu/uncheck-icon.png'\r\nimport {Id} from \"../../../type/menu\";\r\n\r\ninterface MetaData {\r\n    price: number;\r\n    id: Id;\r\n}\r\n\r\nexport type Option<T extends MetaData> = { index: number, label: string, metaData: T }\r\n\r\ntype Props<T extends MetaData> = {\r\n    title?: string\r\n    options: Option<T>[]\r\n    disable: boolean\r\n    preSelectIndeX?: number\r\n    onSelect?: (input: {index: number, metaData: T}) => void\r\n}\r\n\r\nfunction SelectOption<T extends MetaData>({ title, options, disable, onSelect, preSelectIndeX }: Props<T>) {\r\n\r\n    const [currentSelectedOptionIndex, setCurrentSelectedOptionIndex] = React.useState<number | undefined>(preSelectIndeX)\r\n    const currentOptions = React.useRef<Option<T>[]>(options)\r\n\r\n    React.useEffect(() => {\r\n        currentOptions.current = options\r\n    }, [options])\r\n\r\n    const onSelectTheOption = ({ index }:{ index: number }) => {\r\n        setCurrentSelectedOptionIndex(index)\r\n        index < currentOptions.current.length && onSelect && onSelect({\r\n            ...currentOptions.current[index]\r\n        })\r\n    }\r\n\r\n    return <div className=\"select-options\">\r\n                    { title && <label className='select-option-title textFont1'>{ title }</label>}\r\n                    {\r\n                        !disable && options.map((e, index) => {\r\n                            return <div key = { index } className='select-option-row select-option-row-selectable' onClick = { () => onSelectTheOption({ index }) }>\r\n                                <label className='select-option-label notBold'>{ e.label } </label> <span>{'£' + e.metaData.price.toFixed(2)}</span>\r\n                                <img className='select-option-check-icon' src = { index == currentSelectedOptionIndex ? checkIcon : uncheckIcon }/>\r\n                            </div>\r\n                        })\r\n                    }\r\n                    {\r\n                        disable && options.map((e, index) => {\r\n                            return <div key = { index } className='select-option-row textFont1' onClick = { () => onSelectTheOption({ index }) }>\r\n                                <label className='select-option-label notBold'>{ e.label } </label> <span>{'£' + e.metaData.price.toFixed(2)}</span>\r\n                            </div>\r\n                        })\r\n                    }\r\n    </div>\r\n}\r\n\r\nexport default SelectOption\r\n","import React from 'react'\r\nimport { Button, Modal, Row, Col } from 'react-bootstrap'\r\nimport { Id, MenuFilter, MenuItem } from 'type/menu'\r\nimport { useTranslation } from 'react-i18next'\r\nimport SelectOption, { Option } from './selectOption'\r\nimport { getPrice } from 'lib/handy'\r\nimport { BasketItem } from 'type/market'\r\nimport { useMarketContext } from 'store/marketStore'\r\n\r\nexport enum MenuItemModalDataType {\r\n    Basket, Normal\r\n}\r\n\r\nexport type ModalMenuItemDataSource = {\r\n    type: MenuItemModalDataType.Normal,\r\n    dataSource: MenuItem\r\n} | {\r\n    type: MenuItemModalDataType.Basket,\r\n    item_index: number,\r\n    dataSource: BasketItem\r\n}\r\n\r\ntype Props = {\r\n    input?: ModalMenuItemDataSource\r\n    filterType: MenuFilter\r\n    dismiss: () => void\r\n}\r\n\r\nconst ModalMenuItem = ({ input, filterType, dismiss }: Props) => {\r\n    //hooks\r\n    const { t } = useTranslation()\r\n    const { addToBasket, removeFromBasket, updateBasketItem, activeMenuFilter } = useMarketContext()\r\n\r\n    //states\r\n    const [sizeOptions, setSizeOptions] = React.useState<Option<{ price: number, id: Id }>[]>([])\r\n    const [selectedQuantity, setSelectedQuantity] = React.useState<number>(1)\r\n    const [selectedSizeIndex, setSelectedSizeIndex] = React.useState<number>()\r\n\r\n    //refrences\r\n    const quantityRef = React.useRef<number>(selectedQuantity)\r\n\r\n    React.useEffect(() => {\r\n        quantityRef.current = selectedQuantity\r\n    }, [selectedQuantity])\r\n\r\n    React.useEffect(() => {\r\n        if (input == undefined) return\r\n        let item = input.type == MenuItemModalDataType.Normal ? input.dataSource : input.dataSource.item\r\n        let options: Option<{ price: number, id: Id }>[] = item.sizes.map((e) => {\r\n                let currentMenufilterPrice = MenuFilter.Delivery == activeMenuFilter ?\r\n                        parseFloat(e.delivery_price || \"0\") :\r\n                        parseFloat(e.collect_price || \"0\")\r\n                return (e.is_active == true && currentMenufilterPrice !== 0) ? {\r\n                    label: e.name || '',\r\n                    metaData: { price: currentMenufilterPrice, id: e.id }\r\n                } : undefined\r\n            }).filter(e => e != undefined)\r\n            .map(e => e!) //just for force cast in type script\r\n            .map((e, i) => {\r\n                if ( input.type == MenuItemModalDataType.Basket &&\r\n                    input.dataSource.sizeOptionId &&\r\n                    input.dataSource.sizeOptionId == e.metaData.id ) {\r\n                        setSelectedSizeIndex(i)\r\n                }\r\n                return { ...e, index: i }\r\n            })\r\n\r\n        if (options.length == 1) { setSelectedSizeIndex(0) }\r\n\r\n        setSizeOptions(options)\r\n        if (input.type == MenuItemModalDataType.Basket) {\r\n            setSelectedQuantity(input.dataSource.quantity)\r\n        }\r\n\r\n        return () => {\r\n            setSizeOptions([])\r\n            setSelectedQuantity(1)\r\n            setSelectedSizeIndex(undefined)\r\n        }\r\n    }, [input, filterType])\r\n\r\n    let theItem = input?.type == MenuItemModalDataType.Normal ? input.dataSource : input?.dataSource.item\r\n\r\n    return <Modal scrollable animation={false} show = { input !== undefined } onHide={() => dismiss()}>\r\n        <Modal.Header closeButton>\r\n        <Modal.Title>{ theItem?.name }</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n            <div className=\"item-moda-inner-container\">\r\n                { theItem && <img className = 'item-modal-img' src = { theItem.img_full_url }/>}\r\n                <div className='item-modal-detail'>\r\n                    <Row>\r\n                        <Col>\r\n                            { theItem && <div className=\"price centered textFont1\">{ theItem?.sizes.length > 1 ? 'from ' : ''}{ `£${ getPrice({ item: theItem!, filter: filterType }) }` }</div>}\r\n                            <div className=\"description textFont1\">\r\n                                <div>\r\n                                    { theItem?.description || 'There is no description available for this product' }\r\n                                </div>\r\n                            </div>\r\n                        </Col>\r\n                    </Row>\r\n                    { sizeOptions.length > 1 &&\r\n                    <SelectOption<{ price: number, id: Id }>\r\n                        title = { t('SelectSize') }\r\n                        options = { sizeOptions }\r\n                        disable = {false}\r\n                        preSelectIndeX = { selectedSizeIndex }\r\n                        onSelect = { ({ metaData, index }) => { setSelectedSizeIndex(index) } } />\r\n                    }\r\n                    <Row>\r\n                        <Col>\r\n                            <div className=\"quantity\">\r\n                                <div onClick = { () => setSelectedQuantity(p => Math.max(p - 1, 1)) } className='quantity-editor'>-</div>\r\n                                <p>{selectedQuantity}</p>\r\n                                <div onClick = { () => setSelectedQuantity(p => p + 1) } className='quantity-editor'>+</div>\r\n                            </div>\r\n                        </Col>\r\n                    </Row>\r\n                </div>\r\n                {\r\n                    input?.type == MenuItemModalDataType.Basket && <a className=\"red\" onClick = { () => { removeFromBasket(input.dataSource); dismiss() }}>Remove from basket</a>\r\n                }\r\n            </div>\r\n        </Modal.Body>\r\n        <Modal.Footer className=\"flex-column\">\r\n        <Button\r\n            disabled = { sizeOptions.length > 1 && selectedSizeIndex == undefined }\r\n            variant=\"primary\"\r\n            className=\"item-modal-btn\"\r\n            onClick={() => {\r\n                if (input?.type == MenuItemModalDataType.Normal) {\r\n                    addToBasket({\r\n                        item: input.dataSource,\r\n                        quantity: selectedQuantity,\r\n                        sizeOptionId: selectedSizeIndex != undefined ? sizeOptions[selectedSizeIndex].metaData.id : undefined\r\n                    })\r\n                    dismiss()\r\n                } else if (input?.type == MenuItemModalDataType.Basket) {\r\n                    updateBasketItem(input.item_index, {\r\n                        item: input.dataSource.item,\r\n                        quantity: selectedQuantity,\r\n                        sizeOptionId: selectedSizeIndex != undefined ? sizeOptions[selectedSizeIndex].metaData.id : undefined\r\n                    })\r\n                    dismiss()\r\n                }\r\n            }}>\r\n            <span style={{float: 'left'}}>{ input != undefined && input.type == MenuItemModalDataType.Normal ? t('AddToBasket') : t('EditBasketItem') }</span>\r\n            <span style={{float: 'right'}}>{ `${\r\n                selectedSizeIndex != undefined && input != undefined ? \r\n                `£${ (getPrice({ \r\n                    item: input.type == MenuItemModalDataType.Normal ? input.dataSource : input.dataSource.item, \r\n                    filter: filterType, \r\n                    selectedSizeId: sizeOptions[selectedSizeIndex].metaData.id\r\n                }) * selectedQuantity).toFixed(2) }` :\r\n                ''\r\n        }`}</span>\r\n        </Button>\r\n        </Modal.Footer>\r\n    </Modal>\r\n}\r\n\r\nexport default ModalMenuItem\r\n","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAKxAAACsQBZm2C1AAAAi5QTFRFAAAAvLy8////np6e8vLymJiYqampqKioqampqKioqampqampqampr6+vpqamp6enqampqamptLS0ubm5tra2s7OzpqampaWlqampqampqqqqqampqampqampq6urqampq6urqKioqampqampqamprKysqampo6Ojqampurq6qampqamptbW1qKior6+vqampqKioqKionZ2dp6enpqamv7+/oKCg3t7e7u7uzc3NoaGhsLCwn5+f8/Pz8fHx7e3tzs7O7Ozs8PDwoqKi7+/v0tLS8vLy19fXnp6eqampxMTEm5ubrq6upaWlnJycwsLCiYmJqKior6+vvLy85+fn0NDQsbGxwcHBioqKqKio6enp9vb2y8vLqKiopqamqKiopKSk6urqzMzMwMDApKSk39/f+fn5ycnJ3Nzc9PT0oKCg2tra9fX1i4uL4ODgnJycqqqqhYWF2dnZlpaWqqqqiYmJn5+fhoaGREREmJiYqqqqkJCQmpqag4ODiIiIl5eX6+vrk5OTqqqq9/f3vb29hYWFnJyck5OTqqqqjIyMlJSUpqamhISEAAAAlJSUp6eno6Ojubm5oKCglJSUpaWlnJyclJSUoqKimJiYmpqalZWVnp6ep6ennp6elZWVmJiYoaGhqKiolZWVlZWVpaWllpaWmJiYlJSUnJycoKCgo6OjpKSkpaWlm5ublZWVlZWVlpaWmZmZlJSUlpaWlZWVlZWVlZWVlZWVlZWVpqam4wI0vwAAALp0Uk5TAAIDBAEGBiRXhqrAygUXccT4/////wMRi+//+/n6Xez//P7/pP/9Es7//Nr/9xKl/+z//////////////////////////////4b/////////y//////////K////ycv6/////8H//////6z///8Divj//1v7KPv/Asr5eP8FHvT/lfr//wMY9P3/a/j/AbP2/wQM3Pge6fgeH975+w65//f9c/b9IJz9/Pv7+/sjhdj//zVvnr7S2gcHMF4CdQAABBxJREFUeJzFlvtj01QUx0+adE+6LWm6R5qOtKFlHUMuhW1x64OWgpXaAlNxII8p+MIHCIMNmCCogCCggCAMKO/3+81/503ubdp06eQ3zw9Jk5zP/Z7vOXkU4H8KxsGyDAfAMSzrYN4CYJ3WYyf7Xwo1eFNbV9/QOGNGY0N9XS0+rJlWyQXQ1NzCC25R8HgE0S3wLc1Nxukq0cpAW3uH4JG8PC/7fDLPeyWP0NHeBkxrVYnOmaLilf0BlUbAL3sVcWZnFSEXOGaJQTlk5lMqJAfFWQ47xgWzu8K+btUmun3hrtlTGUzM6ZlrB+gxt2fOO5VMKzi6qhM60+UAaw8YmBeehsBMeB5Y5uOCTtFXJRmRnU/sLC8Nz2O+4q8CBAnTrcxvK9OpgXZRriYRUQgji+1QUyRYaOpQQvbEgoW9EcX4HVI6mqB4jzqhWfAGbAmlr197d2BQ1wl4hWZwFp1Ai2Bbl6RE+2PxxKKowchCC1A3DqjlJRvzSMIaMS2Z0hYtDuJjv8TX4mRipc6uLlzVQH8soWmJtLZE94Mrq6NmWKh386UOlTQIoSW0pe9ldBne/T5FGGgQ+WKexTkh0vFl2Q/0tXixgXrhoJG6R0ouv1iiGlFKpOLLV+RU4r8RJ5NY6THuFjSU+fCjjwdWoZIPXeOT4ZxkFOzzrDSnv9pA0GDGvebTxNq+wTKNdEonFqgEWW0i6wSMoGA0vCaWjCfXRldJRR+plKmBEWGdiawXNuC5jSz7LJbUEvHE5wMZk9g4nDPbuEFYTwEONmH7SIl+8WUS5yXjia++/oZWtXF4oWQ2XhY2UfsMbCZNzn/7HVkbD49qfF9G4CZvpk3+Abb0bNW9RH7cZjCaPaFu7dmCk8n0twdHA/pUskXGpip8w4wGt9Ppt8KOncYziYL5sSKDNXqthOpXdu6gr4xxgF1Du3UEBYs6BpGzEOruoV1GMnlZ7EF6ZTozYTCEUC1EYBTtMV8YP8HefWoIUR1c28/pdO8Ka1UqCqn79uJUk9mfO0AuGMwv2q8VPnAcyO0vEfAbHDw0chhRZmJs2/LfK6pS0eGRQwdxIpRkjkSPSpRRsn+MTSGko9EjZSIAxzg43neiyEiRP6VK4kTfceCOlSHwF5w8lTktIdIDyaqBT5zOnDqJkyzhgr/P5M9W5FJClc7mz/xj94E5dz4/eQFDCJULYODCZP78ObvPmBMuXooULl+RjEQa+DG6crkQuXQRnFMJvW1w9VqmMHkdLyxhUN+g65OFzLWrYGlWWeCu37h5K18o3L5z9979+/fu3rldKORv3bwB5QOxxjiu98HDR4+z2ezEkycTePf40cMH2Od4NUIXwstxT589f/Hy1auXL54/e8qRc9MGQ3xyr1+Tx9z5Nv+VONcb+uVh37i4qdf/BQacSzZiPY9tAAAAAElFTkSuQmCC\"","import React from 'react'\r\nimport { Button, Modal, Row, Col } from 'react-bootstrap'\r\nimport { Id, MenuFilter, MenuItem } from 'type/menu'\r\nimport Select from 'react-select'\r\nimport { useTranslation } from 'react-i18next'\r\nimport SelectOption, { Option } from './selectOption'\r\nimport { getPrice, toFixed } from 'lib/handy'\r\nimport { BasketItem } from 'type/market'\r\nimport { useMarketContext } from 'store/marketStore'\r\n\r\nexport enum MenuItemModalDataType {\r\n    Basket, Normal\r\n}\r\n\r\nexport type ModalMenuItemDataSource = {\r\n    type: MenuItemModalDataType.Normal,\r\n    dataSource: MenuItem\r\n} | {\r\n    type: MenuItemModalDataType.Basket,\r\n    item_index: number,\r\n    dataSource: BasketItem\r\n}\r\n\r\ntype Props = {\r\n    input?: ModalMenuItemDataSource\r\n    filterType: MenuFilter\r\n    dismiss: () => void\r\n}\r\n\r\nconst ModalMenuItem = ({ input, filterType, dismiss }: Props) => {\r\n    //hooks\r\n    const { t } = useTranslation()\r\n    const {activeMenuFilter } = useMarketContext()\r\n\r\n    //states\r\n    const [sizeOptions, setSizeOptions] = React.useState<Option<{ price: number, id: Id }>[]>([])\r\n    const [selectedQuantity, setSelectedQuantity] = React.useState<number>(1)\r\n    const [selectedSizeIndex, setSelectedSizeIndex] = React.useState<number>()\r\n\r\n    //refrences\r\n    const quantityRef = React.useRef<number>(selectedQuantity)\r\n\r\n    React.useEffect(() => {\r\n        quantityRef.current = selectedQuantity\r\n    }, [selectedQuantity])\r\n\r\n    React.useEffect(() => {\r\n        if (input == undefined) return\r\n        let item = input.type == MenuItemModalDataType.Normal ? input.dataSource : input.dataSource.item\r\n        let options: Option<{ price: number, id: Id }>[] = item.sizes.map((e) => {\r\n            let currentMenufilterPrice = MenuFilter.Delivery == activeMenuFilter ?\r\n                parseFloat(e.delivery_price || \"0\") :\r\n                parseFloat(e.collect_price || \"0\")\r\n            return (e.is_active == true && currentMenufilterPrice !== 0) ? {\r\n                label: e.name || '',\r\n                metaData: { price: currentMenufilterPrice, id: e.id }\r\n            } : undefined\r\n        }).filter(e => e != undefined)\r\n            .map(e => e!) //just for force cast in type script\r\n            .map((e, i) => {\r\n                if ( input.type == MenuItemModalDataType.Basket &&\r\n                    input.dataSource.sizeOptionId &&\r\n                    input.dataSource.sizeOptionId == e.metaData.id ) {\r\n                    setSelectedSizeIndex(i)\r\n                }\r\n                return { ...e, index: i }\r\n            })\r\n\r\n        if (options.length == 1) { setSelectedSizeIndex(0) }\r\n\r\n        setSizeOptions(options)\r\n        if (input.type == MenuItemModalDataType.Basket) {\r\n            setSelectedQuantity(input.dataSource.quantity)\r\n        }\r\n\r\n        return () => {\r\n            setSizeOptions([])\r\n            setSelectedQuantity(1)\r\n            setSelectedSizeIndex(undefined)\r\n        }\r\n    }, [input, filterType])\r\n\r\n    let theItem = input?.type == MenuItemModalDataType.Normal ? input.dataSource : input?.dataSource.item\r\n\r\n    return <Modal scrollable animation={false} show = { input !== undefined } onHide={() => dismiss()}>\r\n        <Modal.Header closeButton>\r\n            <Modal.Title className=\"textFont2\">{ theItem?.name }</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n            <div className=\"item-moda-inner-container\">\r\n                { theItem && <img className = 'item-modal-img' src = { theItem.img_full_url }/>}\r\n                <div className='item-modal-detail'>\r\n                    <Row>\r\n                        <Col>\r\n                            { theItem && <div className=\"price centered textFont1\">{ theItem?.sizes.length > 1 ? 'from ' : ''}{ `£${ getPrice({ item: theItem!, filter: filterType }) }` }</div>}\r\n                            <div className=\"description textFont1\">\r\n                                <div>\r\n                                    { theItem?.description || 'There is no description available for this product' }\r\n                                </div>\r\n                            </div>\r\n                        </Col>\r\n                    </Row>\r\n                    { sizeOptions.length > 1 &&\r\n                    <SelectOption<{ price: number, id: Id }>\r\n                        title = { t('SelectSize') }\r\n                        options = { sizeOptions }\r\n                        disable = {true}\r\n                        preSelectIndeX = { selectedSizeIndex } />\r\n                    }\r\n                </div>\r\n            </div>\r\n        </Modal.Body>\r\n        <Modal.Footer className=\"flex-column\">\r\n\r\n        </Modal.Footer>\r\n    </Modal>\r\n}\r\n\r\nexport default ModalMenuItem\r\n","import React from 'react'\r\nimport {chunkArray, getErrorMessage, getPrice} from 'lib/handy'\r\nimport { Row, Col } from 'react-bootstrap'\r\nimport { useTranslation } from 'react-i18next'\r\nimport { useMenuContext } from 'store/menuStore'\r\nimport {\r\n    MenuCategoryItem,\r\n    MenuFilter,\r\n    MenuItem,\r\n    MenuContent,\r\n    MenuContentType\r\n} from 'type/menu'\r\nimport toast from 'react-hot-toast'\r\nimport Loader from \"react-loader-spinner\";\r\n\r\n//styles\r\nimport ModalMenuItem, { MenuItemModalDataType } from './modalMenuItem'\r\n\r\ntype SubCatId = string\r\n\r\ntype Props = {\r\n    filter: MenuFilter\r\n    onAddBasket?: ({}: {sizeIndex: number, quantity: number, item: MenuItem}) => void\r\n}\r\n\r\nconst RestaurantMenu = ({ filter, onAddBasket }: Props) => {\r\n\r\n    //hooks\r\n    const { t } = useTranslation()\r\n    const { updateCategoryContent, fetchedCategoryContents, rootCategories } = useMenuContext()\r\n\r\n    //state\r\n    const [isLoadingMenuItems, setIsLoadingMenuItems] = React.useState<boolean>(false)\r\n    const [visibleMenuItems, setVisibleMenuItems] = React.useState<MenuItem[][]>([])\r\n    const [isLoadingSubcat, setIsLoadingSubcat] = React.useState<{ [x in SubCatId]: boolean }>({})\r\n    const [visibleSubCats, setVisibleSubCats] = React.useState<{ [x in SubCatId]: boolean }>({})\r\n    const [activeMenuCategoryId, setActiveMenuCategoryId] = React.useState<SubCatId>()\r\n    const [presentingMenuItem, setPresentingMenuItem] = React.useState<MenuItem>()\r\n\r\n    //reference\r\n    const isComponentActive = React.useRef<boolean>(true)\r\n    const currentFilter = React.useRef<MenuFilter>(filter)\r\n    const menuIsReady = React.useRef<boolean>(false)\r\n\r\n    //consts\r\n    const menuItemsInRow = 3\r\n\r\n    React.useEffect(() => {\r\n        return () => { isComponentActive.current = false }\r\n    }, [])\r\n\r\n    React.useEffect(() => {\r\n        currentFilter.current = filter\r\n        setVisibleSubCats({})\r\n        getInitialContent()\r\n    }, [filter])\r\n\r\n    const getInitialContent = () => {\r\n        getInside()\r\n            .then((res) => {\r\n                if (res.type == MenuContentType.Category) {\r\n                    selectTheFirstCategoryWithItem(filterCategories({ cats: res.value, filter: currentFilter.current }))\r\n                }\r\n            }).catch() //no need to do anything\r\n    }\r\n\r\n    const selectTheFirstCategoryWithItem = (cats: MenuCategoryItem[]) => {\r\n        if (cats.length == 0) return\r\n        if (hasCategoryItems(cats[0])) {\r\n            getInside(cats[0])\r\n                .then((e) => {\r\n                    if (e.type == MenuContentType.Item) setMenuItems(e.value)\r\n                    menuIsReady.current = true\r\n                    setActiveMenuCategoryId(cats[0].id)\r\n                }).catch()\r\n        } else {\r\n            getInside(cats[0])\r\n                .then((e) => {\r\n                    setVisibleSubCats(p => ({\r\n                        ...p,\r\n                        [cats[0].id]: p[cats[0].id] ? ![cats[0].id] : true\r\n                    }))\r\n                    e.type == MenuContentType.Category && selectTheFirstCategoryWithItem(e.value)\r\n                }).catch()\r\n        }\r\n    }\r\n\r\n    const hasCategoryItems = (cat?: MenuCategoryItem) => cat ? cat.has_items : false\r\n\r\n    const setMenuItems = (items: MenuItem[]) => {\r\n        setVisibleMenuItems(chunkArray(filterMenuItems({ filter: currentFilter.current, items }) ,menuItemsInRow))\r\n    }\r\n    /**\r\n     * get inside of a category, if you pass nothing, it would return the root\r\n     * @param {MenuCategoryItem=} cat\r\n     */\r\n     const getInside = (cat?: MenuCategoryItem): Promise<MenuContent> => {\r\n        if (hasCategoryItems(cat)) {\r\n            setIsLoadingMenuItems(true)\r\n        } else {\r\n            setIsLoadingSubcat(p => ({ ...p, [cat?.id || 'root']: true}))\r\n        }\r\n        return updateCategoryContent({ cat })\r\n            .then((e) => {\r\n                if (isComponentActive.current == false) return e\r\n                if (e.type == MenuContentType.Category) {\r\n                   //no need to do any thing\r\n                } else {\r\n                    setMenuItems(e.value)\r\n                    cat?.id && setActiveMenuCategoryId(cat.id)\r\n                }\r\n                return e\r\n            }).catch((e) => {\r\n                toast.error(getErrorMessage(e))\r\n                throw e\r\n            }).finally(() => {\r\n                if (isComponentActive.current == false) return\r\n                if (hasCategoryItems(cat)) {\r\n                    setIsLoadingMenuItems(false)\r\n                } else {\r\n                    setIsLoadingSubcat(p => ({\r\n                        ...p,\r\n                        [cat?.id || 'root']: false\r\n                    }))\r\n                }\r\n            })\r\n    }\r\n\r\n    const toggleVisibilityForSubCat = (cat: MenuCategoryItem, isRootCat: boolean) => {\r\n        if (menuIsReady.current == false) return;\r\n        if (activeMenuCategoryId && cat && activeMenuCategoryId == cat.id) return;\r\n        //has not been fetched before\r\n\r\n        setActiveMenuCategoryId(cat.id);\r\n\r\n        if(isRootCat)\r\n            setVisibleSubCats({});\r\n\r\n        if (visibleSubCats[cat.id] == undefined) { getInside(cat).catch() }\r\n\r\n        hasCategoryItems(cat) == false && setVisibleSubCats(p => ({\r\n            ...p,\r\n            [cat.id]: p[cat.id] ? !p[cat.id] : true\r\n        }))\r\n    }\r\n\r\n    const filterCategories = ({ filter, cats }: { filter: MenuFilter, cats: MenuCategoryItem[] }): MenuCategoryItem[] => {\r\n        let filteredContent: MenuCategoryItem[] = filter == MenuFilter.Booking ? cats.filter((e) => e.is_table == true) :\r\n        filter == MenuFilter.Delivery ? cats.filter((e) => e.is_delivery == true) :\r\n        filter == MenuFilter.TakeOut ? cats.filter((e) => e.is_collect == true) : cats\r\n        return filteredContent\r\n    }\r\n\r\n    const filterMenuItems = ({ filter, items }: { filter: MenuFilter, items: MenuItem[] }): MenuItem[] => {\r\n        let filteredContent = items.filter((e) => {\r\n            if (e.is_active == false) return false\r\n            if (filter == MenuFilter.Delivery) return e.is_delivery && e.delivery_min_price > 0\r\n            if (filter == MenuFilter.TakeOut) return e.is_collect && e.take_out_min_price > 0\r\n            if (filter == MenuFilter.Booking) return e.is_table && e.eat_in_min_price > 0\r\n            return true\r\n        })\r\n        return filteredContent\r\n    }\r\n\r\n    const renderSubCategoryContent = ({ cat, level }: {cat: MenuCategoryItem, level: number}) => {\r\n        return <div>\r\n            {\r\n                isLoadingSubcat[cat.id] == true &&\r\n                fetchedCategoryContents[cat.id] == undefined &&\r\n                <div className='loading-subcategories'>\r\n                    <Loader\r\n                        type=\"BallTriangle\"\r\n                        color=\"#00BFFF\"\r\n                        height={50}\r\n                        width={50}\r\n                    />\r\n                </div>\r\n            }\r\n            {(() => {\r\n                let content = fetchedCategoryContents[cat.id]\r\n                if (content != undefined && content.type === MenuContentType.Category) {\r\n                    let filteredContent = filterCategories({ filter, cats: content.value })\r\n                    return <div>\r\n                        <div className = { `sub-category-content ${ visibleSubCats[cat.id] ? '': 'hidden' } level-${level}` } >\r\n                        {\r\n                            filteredContent\r\n                                .map((subCat, i) => <div key = { i }>\r\n                                    <div key = { i } cat-id = { `${subCat.id}` } className={ `menu-subcategory-item ${activeMenuCategoryId == subCat.id ? 'active-menu-category' : ''}` }\r\n                                        onClick = { () => toggleVisibilityForSubCat(subCat, false) } >\r\n                                        <p>{ subCat.name }</p>\r\n                                    </div>\r\n                                    { hasCategoryItems(subCat) == false && i != filteredContent.length - 1 && renderSubCategoryContent({ cat: subCat, level: level + 1}) }\r\n                                </div>)\r\n                        }\r\n                        </div>\r\n                        {\r\n                            visibleSubCats[cat.id] == true &&\r\n                            filteredContent.length > 0 &&\r\n                            hasCategoryItems(filteredContent[filteredContent.length - 1]) == false &&\r\n                            renderSubCategoryContent({ cat: filteredContent[filteredContent.length - 1], level: level + 1})\r\n                        }\r\n                    </div>\r\n                }\r\n            })()}\r\n        </div>\r\n    }\r\n\r\n    let visibleRootCategories = filterCategories({ filter, cats: rootCategories })\r\n    return <div className='menu-container'>\r\n        <Row>\r\n            <Col md='4'>\r\n                {/*<h1 className='menu-title'>{ t('MenuTitle') }</h1>*/}\r\n                <h1 className='menu-title'>{ t('TakeOutTitle') }</h1>\r\n                {\r\n                    visibleRootCategories.length == 0 &&\r\n                    isLoadingSubcat['root'] == true &&\r\n                    <div className='loading-item-wrapper'>\r\n                        <Loader\r\n                            type=\"Oval\"\r\n                            color=\"#00BFFF\"\r\n                            height={50}\r\n                            width={50}\r\n                        />\r\n                    </div>\r\n                }\r\n                {\r\n                    visibleRootCategories.length == 0 &&\r\n                    isLoadingSubcat['root'] == false &&\r\n                    <div className='loading-item-wrapper'>\r\n                        <p>Please refresh the screen!</p>\r\n                    </div>\r\n                }\r\n                {\r\n                    visibleRootCategories\r\n                        .map((rootCat, index) => <div key = { index }>\r\n                            <div key = { index } className = { `${ activeMenuCategoryId == rootCat.id ? 'active-menu-category' : ''} menu-root-cat-item` }\r\n                                onClick = { () => toggleVisibilityForSubCat(rootCat, true) }>\r\n                                <b>{ rootCat.name }</b>\r\n                            </div>\r\n                            { renderSubCategoryContent({ cat: rootCat, level: 0 }) }\r\n                        </div>\r\n                    )\r\n                }\r\n            </Col>\r\n            <Col md='8'>\r\n                {\r\n                    visibleMenuItems.length == 0 &&\r\n                    isLoadingMenuItems == false  &&\r\n                    <div className='empty-items-list'>\r\n                        <p>Please choose the categories you want</p>\r\n                    </div>\r\n                }\r\n                { isLoadingMenuItems == true && <div className='empty-items-list'>\r\n                    <Loader\r\n                        type=\"Grid\"\r\n                        color=\"#00BFFF\"\r\n                        height={50}\r\n                        width={50}\r\n                    />\r\n                    </div>\r\n                }\r\n                {\r\n                    isLoadingMenuItems == false && visibleMenuItems\r\n                        .map((itemsRow, i) =>\r\n                            <div key = { i }>\r\n                                <Row className=\"align-in-menu\">\r\n                                {\r\n                                    itemsRow.map((e, j) => <Col key = { j } md = { 12 / menuItemsInRow }>\r\n                                        <div className='menu-item' onClick = { () => { setPresentingMenuItem(e) } }>\r\n                                            <img className='menu-item-image' src= { e.img_full_url } />\r\n                                            <div className='menu-item-info'>\r\n                                                <p className='textFont1'>{ e.name }</p>\r\n                                                <p className='textFont1 price'>{ `£${ getPrice({ item: e, filter }) }` }</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    </Col>)\r\n                                }\r\n                                </Row>\r\n                            </div>\r\n                        )\r\n                }\r\n            </Col>\r\n        </Row>\r\n        <ModalMenuItem\r\n            filterType = { filter }\r\n            input = { presentingMenuItem ? { type: MenuItemModalDataType.Normal, dataSource: presentingMenuItem }: undefined }\r\n            dismiss = { () => setPresentingMenuItem(undefined) }/>\r\n    </div>\r\n}\r\n\r\nexport default RestaurantMenu\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAACXBIWXMAAAsSAAALEgHS3X78AAAER0lEQVR42u3c2U4UWxiG4ZY2DtEDjQMiIngbDicavWDjBTgc6KFBQGbUeAUaNQIOq0N1rFSKiG2N/M+TrGDYybY3td5PYug9GAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPTaVHSCY4SG/Bo65k9nH++k8KHwOCBD/7XS+p7Obzh0jAHHiHwX/NZ1f2Rn9+p4RgBjxf8nC38+OEYBg8e/lvgPYMwIQL/6f2TECEDR+IwCB/+T3nQAEjt8IQPD4jQAEj98IQPD4jQAEj98IQPD4jQAEj98IQPD4jQAEj98IQPD4jQAEj98IQPD4jQAEj98IQPD4jQAEj98IQPD4jQAEj98IQPD4jQAEj98IQPD4jQB0PP78v+9HdryBCILFv5/7/L4RgDjxj3+PzXQ2Bu28lfiuEUD8zce/m338mM7NdObS+VD4Z74TgGMc//t0buVez0I674wAxIp/9FqGRgBixl98XUYAgsVvBCB4/GUjsGMEoP/xvzti/MXXO28EoP/xL0wQkxGAnse/M2H8xdc/+lmBbSMA/Yp/voJ4jAAEjb9sBLaMAHQ3/u2K4y/+d80ZAehu/DdrjMQIQND4jQAEj98IQMfi32o4/rIR2DQCiL/5+Efh3WgxgvHvOTv48z8VMQKIP0D8RgDxB4/fCCD+4PGXjcC6EUD81ce/0dH4jQDiDx5/8et03Qgg/urin+3RpTYCiL+i+Nd7Fn/ZCKwZAcQ/WfzXe3yJx695Jp1VI4D4jx7/Ws/jL34drxkBxH/0+GeO0aUdGgHEHzN+I4D4g8dfNgJvjQDijxO/EUD8h8S/mot/GODrbQTojKmW43+bhRAl/uIITKez0vIITMkgphPZx4fpfGop/umA8RdH4GpLI/A5nUeFu0DAAXicXYhvDca/Ejz+shFYbnAExs/6iQEwAOfSeVrT5RN/N0ag7Dk8S+e8AfB3ACNnsgtR5eUTfzdGoOw5vEjnrL8DIH/5qhwB8XdjBP4Wv+dA5SMg/mpGYKmG5yB+ah2Bsku3nF1ol+7fnsOV/xgB8dP4CJRduqXsIrt0kz2Hy+m8qeA5iJ9aR0D83RgB8dP4CIi/mRFYnOA5iJ9aR0D83RgB8dPqdwLjz70Rf63P4dJfvhMQP42OQDH+yy5dKyMgfloZAfF3YwTET6Mj8Dz3J8+i+Fsbgde55yB+Grt8p9J5OTh4S+9Fl66153BhcPBTlq/SOe050ITxm0dG4fvx3vZHYDo3wt7YQ6Mj4NJ5DgR1YuB95J4DAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANThN63VPfQJaGBwAAAAAElFTkSuQmCC\"","import React from 'react'\r\nimport { BasketItem } from 'type/market'\r\nimport { useMarketContext } from 'store/marketStore'\r\nimport {MenuFilter, MenuItem} from 'type/menu'\r\nimport { getPrice, toFixed } from 'lib/handy'\r\n\r\n//styles\r\nimport './style.scss'\r\nimport { Button, Container } from 'react-bootstrap'\r\nimport ModalMenuItem, { MenuItemModalDataType } from 'components/menu/modalMenuItem'\r\n\r\nimport editIcon from 'images/edit.png'\r\nimport { useHistory } from 'react-router'\r\n\r\n//assets\r\nimport UpArrow from 'images/uparrow.png'\r\nimport Menu from \"react-select/src/components/Menu\";\r\n\r\ntype Props = {\r\n    filter: MenuFilter\r\n}\r\n\r\nconst Basket = ({ filter }: Props) => {\r\n\r\n    //hook\r\n    const {\r\n        basketItems,\r\n        deliveryTime,\r\n        deliveryCost,\r\n        storeInfo,\r\n        removeFromBasket\r\n    } = useMarketContext()\r\n    const history = useHistory()\r\n\r\n    //state\r\n    const [isBasketExpanded, setIsBasketExpanded] = React.useState<boolean>(false)\r\n    const [editingBasketItem, setEditingBasketItem] = React.useState<BasketItem>()\r\n    const [morePriceNeedToStartCheckout, setMorePriceNeedToStartCheckout] = React.useState<number>(0)\r\n    const [itemIndex, setItemIndex] = React.useState(0);\r\n\r\n    //refrences\r\n    const [basketTotal, setBasketTotal] = React.useState<number>(0)\r\n\r\n    const basketItemIsAvailable = (item: MenuItem, filter: MenuFilter, size_id?: string): boolean =>\r\n    {\r\n        let size = item.sizes.find(s => s.id == size_id);\r\n        if(size && size.collect_price != null && parseFloat(size.collect_price) == 0 && filter == MenuFilter.TakeOut) return false;\r\n        if(size && size.delivery_price != null && parseFloat(size.delivery_price) == 0 && filter == MenuFilter.Delivery) return false;\r\n        if(size && size.table_price != null && parseFloat(size.table_price) == 0 && filter == MenuFilter.Booking) return false;\r\n\r\n        if(item.is_active == false) return  false;\r\n        if(item.is_collect == false && filter == MenuFilter.TakeOut) return  false;\r\n        if(item.is_delivery == false && filter == MenuFilter.Delivery) return false;\r\n        if(item.is_table == false && filter == MenuFilter.Booking) return false;\r\n\r\n        return true;\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        basketItems.filter(e => !basketItemIsAvailable(e.item, filter, e.sizeOptionId))\r\n            .map((e) => removeFromBasket(e))\r\n    }, [filter, basketItems])\r\n\r\n    React.useEffect(() => {\r\n        let totalPrice = basketItems\r\n            .reduce((ac, e) =>\r\n                ac + getPrice({ item: e.item, filter ,selectedSizeId: e.sizeOptionId}) * e.quantity\r\n            , 0) + (deliveryCost || 0)\r\n\r\n            //check for minimum price\r\n        if (filter == MenuFilter.Delivery && storeInfo?.delivery_min_order_amount != undefined) {\r\n            setMorePriceNeedToStartCheckout(Math.max(storeInfo.delivery_min_order_amount - totalPrice, 0))\r\n        } else {\r\n            setMorePriceNeedToStartCheckout(0)\r\n        }\r\n\r\n        setBasketTotal(totalPrice)\r\n    }, [basketItems, filter, deliveryCost])\r\n\r\n    const sizeLabel = (basketItem: BasketItem): string => {\r\n        if (basketItem.sizeOptionId == undefined) return \"\"\r\n        let selectedSizes = basketItem.item.sizes.filter((e) => e.id == basketItem.sizeOptionId)\r\n        if (selectedSizes.length > 0 && selectedSizes[0].name != null)\r\n            return ` - size: ${ selectedSizes[0].name }`\r\n        return ''\r\n    }\r\n\r\n    return <div className= { `basketContainer ${ isBasketExpanded ? 'expanded' : '' }`}>\r\n        <div>\r\n            <Container>\r\n                <div className=\"form-group\"/>\r\n                <div className=\"form-group basket-top-header\" onClick = { () => setIsBasketExpanded( p => !p ) }>\r\n                    <h5 className=\"basket-title\">Basket {basketItems.length ? <span className=\"basket-count\">{basketItems.length}</span> : ''} <span className=\"total-title\">£{ basketTotal.toFixed(2) }</span></h5>\r\n                    <div className='basket-arrow-container'>\r\n                        <img src = { UpArrow }/>\r\n                    </div>\r\n                </div>\r\n                { filter == MenuFilter.Delivery && deliveryTime && <p className='min-delivery-time'>Minimum delivery time: { `${deliveryTime} minutes` }</p>}\r\n                { filter == MenuFilter.TakeOut && storeInfo?.min_expected_takeout_time && <p className='min-delivery-time'>Minimum preparation time for takeout order: { `${storeInfo.min_expected_takeout_time} minutes` }</p>}\r\n                <div className=\"basket-items\">\r\n                    { basketItems.length == 0 && <div className='centered'>\r\n                        <p>Your Basket is Empty!</p>\r\n                    </div> }\r\n                    { basketItems.map((item, index) =>\r\n                        <div key = { index } className='basket-item-wrapper'>\r\n                            <label className='basket-item-name'>{ item.item.name }</label>\r\n                            <label className='price-label'>£{ `${(item.quantity * getPrice({ item: item.item, filter, selectedSizeId: item.sizeOptionId })).toFixed(2) }` }</label>\r\n                            <label className='basket-item-quantity'>\r\n                                { `Quantity: ${item.quantity} ${sizeLabel(item)}` }\r\n                            </label>\r\n                            <Button variant=\"outline-info\" onClick = { () => {\r\n                                setItemIndex(index);\r\n                                setEditingBasketItem(item);\r\n                            } }><img style = {{ width: '15px', height: '15px' }} src = { editIcon }/></Button>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n                <hr/>\r\n                { basketItems.length > 0 && <div>\r\n                    { deliveryCost && <div className='subtotal'><span>Subtotal:</span><span>£{ (basketTotal - deliveryCost).toFixed(2) }</span></div>}\r\n                    { deliveryCost && <div className='subtotal'><span>Delivery Charge:</span><span>£{ deliveryCost.toFixed(2) }</span></div>}\r\n                    { basketTotal != 0 && <React.Fragment><div className=\"total\"><span>Total:</span><span>£{ basketTotal.toFixed(2) }</span></div><hr/></React.Fragment> }\r\n                    { morePriceNeedToStartCheckout > 0 && <div className='delivery-min-price'>\r\n                        Spend £{ morePriceNeedToStartCheckout.toFixed(2) } more to to start checkout\r\n                </div>}\r\n                </div>}\r\n            </Container>\r\n        </div>\r\n        <ModalMenuItem\r\n            filterType = { filter }\r\n            input = { editingBasketItem ? { type: MenuItemModalDataType.Basket, item_index: itemIndex, dataSource: editingBasketItem }: undefined }\r\n            dismiss = { () => setEditingBasketItem(undefined) }/>\r\n\r\n            <div className=\"tip\">\r\n                * If you have food allergy or intolerance, please contact the restaurant before placing your order.\r\n            </div>\r\n\r\n        { basketItems.length > 0 && morePriceNeedToStartCheckout == 0 && <div className='form-group centered'>\r\n            <Button onClick = { () => history.push({ pathname: '/checkout' }) } variant=\"primary\">Start Checkout</Button>\r\n        </div>}\r\n    </div>\r\n}\r\n\r\nexport default Basket\r\n","export default \"data:image/png;base64,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\"","import React from 'react'\r\nimport { Col, Container, Modal, Button, Row } from 'react-bootstrap'\r\nimport { useHistory, useLocation, useParams } from 'react-router'\r\nimport moment from 'moment'\r\n\r\n//types\r\nimport { MenuFilter } from 'type/menu'\r\n\r\n//components\r\nimport RestaurantMenu from 'components/menu/menu'\r\nimport ToggleMenuFilter from 'components/toggleMenuFilter'\r\nimport Basket from 'components/basket'\r\n\r\n//style\r\nimport './style.scss'\r\nimport { useMarketContext } from 'store/marketStore'\r\n\r\nconst MenuScreen = () => {\r\n    //hooks\r\n    const { filter } = useParams<{filter: MenuFilter}>()\r\n    const history = useHistory()\r\n    const thisLocation = useLocation()\r\n    const { activeMenuFilter, availableDeliverTime, storeInfo, setActiveMenuFilter } = useMarketContext()\r\n\r\n    //states\r\n    const [presentOutOfOrder, setPresentOutOfOrder] = React.useState<boolean>(false)\r\n    const [continueOutOfOrder, setContinueOutOfOrder] = React.useState<boolean>(false)\r\n\r\n    // references\r\n    const latestActiveFilter = React.useRef<MenuFilter | undefined>(activeMenuFilter)\r\n\r\n    const changeFilter = (filter: MenuFilter) => {\r\n        const location = {\r\n            pathname: filter == MenuFilter.Delivery ? `/menu/${latestActiveFilter.current}/postcode-check` : `/menu/${filter}`,\r\n            state: { background: thisLocation }\r\n        }\r\n        history.push(location)\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        latestActiveFilter.current = filter\r\n        setActiveMenuFilter(filter)\r\n    }, [filter])\r\n\r\n    React.useEffect(() => {\r\n        if (storeInfo != undefined &&\r\n            ((activeMenuFilter == MenuFilter.Delivery && storeInfo.is_delivery_closed_now) ||\r\n            (activeMenuFilter == MenuFilter.TakeOut && storeInfo.is_takeout_closed_now))\r\n        ) {\r\n            if(!continueOutOfOrder) setPresentOutOfOrder(true)\r\n        }\r\n    }, [storeInfo])\r\n\r\n    return <Container>\r\n        <Row>\r\n            <Col lg = '9'>\r\n                {/*<ToggleMenuFilter is_delivery_active = { storeInfo?.is_delivery_active } is_take_out_active = { storeInfo?.is_take_out_active } filter = { filter } attemptChangeFilter = { changeFilter }/>*/}\r\n                <RestaurantMenu filter = { filter }/>\r\n            </Col>\r\n            <Col lg = '3'>\r\n                <Basket filter = { filter }/>\r\n            </Col>\r\n        </Row>\r\n\r\n        {/* simple modal presenting the error for availability */}\r\n        <Modal animation={false} show = { presentOutOfOrder } onHide={() => setPresentOutOfOrder(false)}>\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>Not Available</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                Closed now! We’ll open { availableDeliverTime && availableDeliverTime.length > 0 ? moment.duration(availableDeliverTime[0].diff(moment())).humanize() : '' } later. Would you like to order for later?\r\n            </Modal.Body>\r\n            <Modal.Footer>\r\n                <Button variant=\"secondary\" onClick={() => history.push({ pathname: '/' }) }>\r\n                    Cancel\r\n                </Button>\r\n                <Button variant=\"primary\" onClick={() => {\r\n                    setPresentOutOfOrder(false)\r\n                    setContinueOutOfOrder(true)\r\n                }}>\r\n                    Continue\r\n                </Button>\r\n            </Modal.Footer>\r\n        </Modal>\r\n    </Container>\r\n}\r\n\r\nexport default MenuScreen\r\n","import React from 'react'\r\nimport {chunkArray, getErrorMessage, getPrice} from 'lib/handy'\r\nimport { Row, Col } from 'react-bootstrap'\r\nimport { useTranslation } from 'react-i18next'\r\nimport { useMenuContext } from 'store/menuStore'\r\nimport {\r\n    MenuCategoryItem,\r\n    MenuFilter,\r\n    MenuItem,\r\n    MenuContent,\r\n    MenuContentType\r\n} from 'type/menu'\r\nimport toast from 'react-hot-toast'\r\nimport Loader from \"react-loader-spinner\";\r\n\r\n//styles\r\nimport ModalMenuItem, { MenuItemModalDataType } from './readOnlyModalMenuItem'\r\n\r\ntype SubCatId = string\r\n\r\ntype Props = {\r\n    filter: MenuFilter\r\n}\r\n\r\nconst ReadOnlyMenu = ({ filter }: Props) => {\r\n\r\n    //hooks\r\n    const { t } = useTranslation()\r\n    const { updateCategoryContent, fetchedCategoryContents, rootCategories } = useMenuContext()\r\n\r\n    //state\r\n    const [isLoadingMenuItems, setIsLoadingMenuItems] = React.useState<boolean>(false)\r\n    const [visibleMenuItems, setVisibleMenuItems] = React.useState<MenuItem[][]>([])\r\n    const [isLoadingSubcat, setIsLoadingSubcat] = React.useState<{ [x in SubCatId]: boolean }>({})\r\n    const [visibleSubCats, setVisibleSubCats] = React.useState<{ [x in SubCatId]: boolean }>({})\r\n    const [activeMenuCategoryId, setActiveMenuCategoryId] = React.useState<SubCatId>()\r\n    const [presentingMenuItem, setPresentingMenuItem] = React.useState<MenuItem>()\r\n\r\n    //reference\r\n    const isComponentActive = React.useRef<boolean>(true)\r\n    const currentFilter = React.useRef<MenuFilter>(filter)\r\n    const menuIsReady = React.useRef<boolean>(false)\r\n\r\n    //consts\r\n    const menuItemsInRow = 3\r\n\r\n    React.useEffect(() => {\r\n        return () => { isComponentActive.current = false }\r\n    }, [])\r\n\r\n    React.useEffect(() => {\r\n        currentFilter.current = filter\r\n        setVisibleSubCats({})\r\n        getInitialContent()\r\n    }, [filter])\r\n\r\n    const getInitialContent = () => {\r\n        getInside()\r\n            .then((res) => {\r\n                if (res.type == MenuContentType.Category) {\r\n                    selectTheFirstCategoryWithItem(filterCategories({ cats: res.value, filter: currentFilter.current }))\r\n                }\r\n            }).catch() //no need to do anything\r\n    }\r\n\r\n    const selectTheFirstCategoryWithItem = (cats: MenuCategoryItem[]) => {\r\n        if (cats.length == 0) return\r\n        if (hasCategoryItems(cats[0])) {\r\n            getInside(cats[0])\r\n                .then((e) => {\r\n                    if (e.type == MenuContentType.Item) setMenuItems(e.value)\r\n                    menuIsReady.current = true\r\n                    setActiveMenuCategoryId(cats[0].id)\r\n                }).catch()\r\n        } else {\r\n            getInside(cats[0])\r\n                .then((e) => {\r\n                    setVisibleSubCats(p => ({\r\n                        ...p,\r\n                        [cats[0].id]: p[cats[0].id] ? ![cats[0].id] : true\r\n                    }))\r\n                    e.type == MenuContentType.Category && selectTheFirstCategoryWithItem(e.value)\r\n                }).catch()\r\n        }\r\n    }\r\n\r\n    const hasCategoryItems = (cat?: MenuCategoryItem) => cat ? cat.has_items : false\r\n\r\n    const setMenuItems = (items: MenuItem[]) => {\r\n        setVisibleMenuItems(chunkArray(filterMenuItems({ filter: currentFilter.current, items }) ,menuItemsInRow))\r\n    }\r\n    /**\r\n     * get inside of a category, if you pass nothing, it would return the root\r\n     * @param {MenuCategoryItem=} cat\r\n     */\r\n     const getInside = (cat?: MenuCategoryItem): Promise<MenuContent> => {\r\n        if (hasCategoryItems(cat)) {\r\n            setIsLoadingMenuItems(true)\r\n        } else {\r\n            setIsLoadingSubcat(p => ({ ...p, [cat?.id || 'root']: true}))\r\n        }\r\n        return updateCategoryContent({ cat })\r\n            .then((e) => {\r\n                if (isComponentActive.current == false) return e\r\n                if (e.type == MenuContentType.Category) {\r\n                   //no need to do any thing\r\n                } else {\r\n                    setMenuItems(e.value)\r\n                    cat?.id && setActiveMenuCategoryId(cat.id)\r\n                }\r\n                return e\r\n            }).catch((e) => {\r\n                toast.error(getErrorMessage(e))\r\n                throw e\r\n            }).finally(() => {\r\n                if (isComponentActive.current == false) return\r\n                if (hasCategoryItems(cat)) {\r\n                    setIsLoadingMenuItems(false)\r\n                } else {\r\n                    setIsLoadingSubcat(p => ({\r\n                        ...p,\r\n                        [cat?.id || 'root']: false\r\n                    }))\r\n                }\r\n            })\r\n    }\r\n\r\n    const toggleVisibilityForSubCat = (cat: MenuCategoryItem, isRootCat: boolean) => {\r\n        if (menuIsReady.current == false) return;\r\n        if (activeMenuCategoryId && cat && activeMenuCategoryId == cat.id) return;\r\n        //has not been fetched before\r\n\r\n        setActiveMenuCategoryId(cat.id);\r\n\r\n        if(isRootCat)\r\n            setVisibleSubCats({});\r\n\r\n        if (visibleSubCats[cat.id] == undefined) { getInside(cat).catch() }\r\n\r\n        hasCategoryItems(cat) == false && setVisibleSubCats(p => ({\r\n            ...p,\r\n            [cat.id]: p[cat.id] ? !p[cat.id] : true\r\n        }))\r\n    }\r\n\r\n    const filterCategories = ({ filter, cats }: { filter: MenuFilter, cats: MenuCategoryItem[] }): MenuCategoryItem[] => {\r\n        let filteredContent: MenuCategoryItem[] = filter == MenuFilter.Booking ? cats.filter((e) => e.is_table == true) :\r\n        filter == MenuFilter.Delivery ? cats.filter((e) => e.is_delivery == true) :\r\n        filter == MenuFilter.TakeOut ? cats.filter((e) => e.is_collect == true) : cats\r\n        return filteredContent\r\n    }\r\n\r\n    const filterMenuItems = ({ filter, items }: { filter: MenuFilter, items: MenuItem[] }): MenuItem[] => {\r\n        let filteredContent = items.filter((e) => {\r\n            if (e.is_active == false) return false\r\n            if (filter == MenuFilter.Delivery) return e.is_delivery && e.delivery_min_price > 0\r\n            if (filter == MenuFilter.TakeOut) return e.is_collect && e.take_out_min_price > 0\r\n            if (filter == MenuFilter.Booking) return e.is_table && e.eat_in_min_price > 0\r\n            return true\r\n        })\r\n        return filteredContent\r\n    }\r\n\r\n    const renderSubCategoryContent = ({ cat, level }: {cat: MenuCategoryItem, level: number}) => {\r\n        return <div>\r\n            {\r\n                isLoadingSubcat[cat.id] == true &&\r\n                fetchedCategoryContents[cat.id] == undefined &&\r\n                <div className='loading-subcategories'>\r\n                    <Loader\r\n                        type=\"BallTriangle\"\r\n                        color=\"#00BFFF\"\r\n                        height={50}\r\n                        width={50}\r\n                    />\r\n                </div>\r\n            }\r\n            {(() => {\r\n                let content = fetchedCategoryContents[cat.id]\r\n                if (content != undefined && content.type === MenuContentType.Category) {\r\n                    let filteredContent = filterCategories({ filter, cats: content.value })\r\n                    return <div>\r\n                        <div className = { `sub-category-content ${ visibleSubCats[cat.id] ? '': 'hidden' } level-${level}` } >\r\n                        {\r\n                            filteredContent\r\n                                .map((subCat, i) => <div key = { i }>\r\n                                    <div key = { i } cat-id = { `${subCat.id}` } className={ `menu-subcategory-item ${activeMenuCategoryId == subCat.id ? 'active-menu-category' : ''}` }\r\n                                        onClick = { () => toggleVisibilityForSubCat(subCat, false) } >\r\n                                        <p>{ subCat.name }</p>\r\n                                    </div>\r\n                                    { hasCategoryItems(subCat) == false && i != filteredContent.length - 1 && renderSubCategoryContent({ cat: subCat, level: level + 1}) }\r\n                                </div>)\r\n                        }\r\n                        </div>\r\n                        {\r\n                            visibleSubCats[cat.id] == true &&\r\n                            filteredContent.length > 0 &&\r\n                            hasCategoryItems(filteredContent[filteredContent.length - 1]) == false &&\r\n                            renderSubCategoryContent({ cat: filteredContent[filteredContent.length - 1], level: level + 1})\r\n                        }\r\n                    </div>\r\n                }\r\n            })()}\r\n        </div>\r\n    }\r\n\r\n    let visibleRootCategories = filterCategories({ filter, cats: rootCategories })\r\n    return <div className='menu-container'>\r\n        <Row>\r\n            <Col md='4'>\r\n                <h1 className='menu-title'>{ t('EatInTitle') }</h1>\r\n                {\r\n                    visibleRootCategories.length == 0 &&\r\n                    isLoadingSubcat['root'] == true &&\r\n                    <div className='loading-item-wrapper'>\r\n                        <Loader\r\n                            type=\"Oval\"\r\n                            color=\"#00BFFF\"\r\n                            height={50}\r\n                            width={50}\r\n                        />\r\n                    </div>\r\n                }\r\n                {\r\n                    visibleRootCategories.length == 0 &&\r\n                    isLoadingSubcat['root'] == false &&\r\n                    <div className='loading-item-wrapper'>\r\n                        <p>Please refresh the screen!</p>\r\n                    </div>\r\n                }\r\n                {\r\n                    visibleRootCategories\r\n                        .map((rootCat, index) => <div key = { index }>\r\n                            <div key = { index } className = { `${ activeMenuCategoryId == rootCat.id ? 'active-menu-category' : ''} menu-root-cat-item` }\r\n                                onClick = { () => toggleVisibilityForSubCat(rootCat, true) }>\r\n                                <b>{ rootCat.name }</b>\r\n                            </div>\r\n                            { renderSubCategoryContent({ cat: rootCat, level: 0 }) }\r\n                        </div>\r\n                    )\r\n                }\r\n            </Col>\r\n            <Col md='8'>\r\n                {\r\n                    visibleMenuItems.length == 0 &&\r\n                    isLoadingMenuItems == false  &&\r\n                    <div className='empty-items-list'>\r\n                        <p>Please choose the categories you want</p>\r\n                    </div>\r\n                }\r\n                { isLoadingMenuItems == true && <div className='empty-items-list'>\r\n                    <Loader\r\n                        type=\"Grid\"\r\n                        color=\"#00BFFF\"\r\n                        height={50}\r\n                        width={50}\r\n                    />\r\n                    </div>\r\n                }\r\n                {\r\n                    isLoadingMenuItems == false && visibleMenuItems\r\n                        .map((itemsRow, i) =>\r\n                            <div key = { i }>\r\n                                <Row className=\"align-in-menu\">\r\n                                {\r\n                                    itemsRow.map((e, j) => <Col key = { j } md = { 12 / menuItemsInRow }>\r\n                                        <div className='menu-item' onClick = { () => { setPresentingMenuItem(e) } }>\r\n                                            <img className='menu-item-image' src= { e.img_full_url } />\r\n                                            <div className='menu-item-info'>\r\n                                                <p className='textFont1'>{ e.name }</p>\r\n                                                <p className='textFont1 price'>{ `£${ getPrice({ item: e, filter }) }` }</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    </Col>)\r\n                                }\r\n                                </Row>\r\n                            </div>\r\n                        )\r\n                }\r\n            </Col>\r\n        </Row>\r\n        <ModalMenuItem\r\n            filterType = { filter }\r\n            input = { presentingMenuItem ? { type: MenuItemModalDataType.Normal, dataSource: presentingMenuItem }: undefined }\r\n            dismiss = { () => setPresentingMenuItem(undefined) }/>\r\n    </div>\r\n};\r\n\r\nexport default ReadOnlyMenu\r\n","import React from 'react'\r\nimport {Col, Container, Row} from 'react-bootstrap'\r\n//types\r\nimport {MenuFilter} from 'type/menu'\r\n//components\r\nimport RestaurantMenu from 'components/menu/readOnlyMenu'\r\n//style\r\nimport './style.scss'\r\n\r\nconst EatInScreen = () => {\r\n\r\n    return <Container>\r\n        <Row>\r\n            <Col lg = '12'>\r\n                <RestaurantMenu filter={MenuFilter.Booking}/>\r\n            </Col>\r\n        </Row>\r\n    </Container>\r\n};\r\n\r\nexport default EatInScreen\r\n","import React from 'react'\r\nimport {getErrorMessage, getPrice} from 'lib/handy'\r\nimport {Col, Row} from 'react-bootstrap'\r\nimport {useMenuContext} from 'store/menuStore'\r\nimport {MenuCategoryItem, MenuContent, MenuContentType, MenuFilter, MenuItem} from 'type/menu'\r\nimport toast from 'react-hot-toast'\r\nimport Loader from \"react-loader-spinner\";\r\nimport ModalMenuItem, {MenuItemModalDataType} from './modalMenuItem'\r\n\r\n\r\ntype CatId = number\r\n\r\ntype Props = {\r\n    filter: MenuFilter\r\n}\r\n\r\nconst RestaurantMenu = ({ filter }: Props) => {\r\n\r\n    const { updateCategoryContent } = useMenuContext();\r\n\r\n    //state\r\n    const [isLoadingMenuItems, setIsLoadingMenuItems] = React.useState<boolean>(false)\r\n    const [visibleMenuItems, setVisibleMenuItems] = React.useState<MenuItem[]>()\r\n    const [activeMenuCategoryIdx, setActiveMenuCategoryIdx] = React.useState<CatId>(-1)\r\n    const [presentingMenuItem, setPresentingMenuItem] = React.useState<MenuItem>()\r\n    const [visibleRootCategories, setVisibleRootCategories] = React.useState<MenuCategoryItem[]>([]);\r\n\r\n\r\n    //reference\r\n    const isComponentActive = React.useRef<boolean>(true);\r\n    const currentFilter = React.useRef<MenuFilter>(filter);\r\n    const menuIsReady = React.useRef<boolean>(false);\r\n\r\n    React.useEffect(() => {\r\n        return () => { isComponentActive.current = false }\r\n    }, []);\r\n\r\n    React.useEffect(() => {\r\n\r\n        if(activeMenuCategoryIdx < 0) {\r\n            setActiveMenuCategoryIdx(0);\r\n            return;\r\n        }\r\n\r\n        setVisibleMenuItems([]);\r\n    }, [activeMenuCategoryIdx, visibleRootCategories]);\r\n\r\n\r\n    React.useEffect(() => {\r\n\r\n        if(activeMenuCategoryIdx < 0)\r\n            return;\r\n\r\n        selectCategoryWithItem(activeMenuCategoryIdx);\r\n    }, [visibleMenuItems]);\r\n\r\n    React.useEffect(() => {\r\n        currentFilter.current = filter;\r\n        getInitialContent();\r\n    }, [filter]);\r\n\r\n    const getInitialContent = () => {\r\n        getInside()\r\n            .then((res) => {\r\n                if (res.type == MenuContentType.Category) {\r\n                    setVisibleRootCategories(filterCategories({ filter: currentFilter.current, cats: res.value }));\r\n                }\r\n            }).catch() //no need to do anything\r\n    };\r\n\r\n    const selectCategoryWithItem = (idx) => {\r\n\r\n        setIsLoadingMenuItems(true);\r\n\r\n        if (visibleRootCategories.length <= idx) return;\r\n\r\n        if (hasCategoryItems(visibleRootCategories[idx])) {\r\n            getInside(visibleRootCategories[idx])\r\n                .then((e) => {\r\n                    if (e.type == MenuContentType.Item) setMenuItems(e.value);\r\n                    menuIsReady.current = true;\r\n                    // setActiveMenuCategoryIdx(idx)\r\n                }).catch().finally(() => {\r\n                    setIsLoadingMenuItems(false)\r\n                })\r\n        } else {\r\n            getInside(visibleRootCategories[idx])\r\n                .then((e) => {\r\n                    e.type == MenuContentType.Category && selectSubCategoryWithItem(e.value)\r\n                }).catch()\r\n        }\r\n    };\r\n\r\n    const selectSubCategoryWithItem = (cats: MenuCategoryItem[]) => {\r\n\r\n        cats.forEach(function (cat) {\r\n\r\n            if (hasCategoryItems(cat)) {\r\n                getInside(cat)\r\n                    .then((e) => {\r\n                        if (e.type == MenuContentType.Item) setMenuItems(e.value);\r\n                        menuIsReady.current = true;\r\n                        // setActiveMenuCategoryId(cat.id)\r\n                    }).catch().finally(() => {\r\n                    setIsLoadingMenuItems(false)\r\n                })\r\n            } else {\r\n                getInside(cat)\r\n                    .then((e) => {\r\n                        e.type == MenuContentType.Category && selectSubCategoryWithItem(e.value)\r\n                    }).catch()\r\n            }\r\n        });\r\n    };\r\n\r\n    const hasCategoryItems = (cat?: MenuCategoryItem) => cat ? cat.has_items : false\r\n\r\n    const setMenuItems = (items: MenuItem[]) => {\r\n\r\n        if(visibleMenuItems === undefined)\r\n            return;\r\n\r\n        let tmp : MenuItem[] = filterMenuItems({ filter: currentFilter.current, items });\r\n\r\n        tmp.forEach(function (itr) {\r\n\r\n            let find : boolean = false;\r\n\r\n            visibleMenuItems?.forEach(function (itr2) {\r\n\r\n                if(find)\r\n                    return;\r\n\r\n                if(itr.id === itr2.id) {\r\n                    find = true;\r\n                    return;\r\n                }\r\n\r\n            });\r\n\r\n            if(!find)\r\n                visibleMenuItems?.push(itr)\r\n\r\n        });\r\n\r\n    }\r\n    /**\r\n     * get inside of a category, if you pass nothing, it would return the root\r\n     * @param {MenuCategoryItem=} cat\r\n     */\r\n    const getInside = (cat?: MenuCategoryItem): Promise<MenuContent> => {\r\n        return updateCategoryContent({ cat })\r\n            .then((e) => {\r\n                if (isComponentActive.current == false) return e\r\n                if (e.type == MenuContentType.Category) {\r\n                    //no need to do any thing\r\n                } else {\r\n                    setMenuItems(e.value)\r\n                }\r\n                return e\r\n            }).catch((e) => {\r\n                toast.error(getErrorMessage(e));\r\n                throw e\r\n            }).finally(() => {\r\n                if (isComponentActive.current == false) return\r\n            })\r\n    };\r\n\r\n    const filterCategories = ({ filter, cats }: { filter: MenuFilter, cats: MenuCategoryItem[] }): MenuCategoryItem[] => {\r\n        return filter == MenuFilter.Booking ? cats.filter((e) => e.is_table == true) :\r\n            filter == MenuFilter.Delivery ? cats.filter((e) => e.is_delivery == true) :\r\n                filter == MenuFilter.TakeOut ? cats.filter((e) => e.is_collect == true) : cats\r\n        // return filter == MenuFilter.Booking ? cats.filter((e) => e.is_table == true) :\r\n        //      cats;\r\n    };\r\n\r\n    const filterMenuItems = ({ filter, items }: { filter: MenuFilter, items: MenuItem[] }): MenuItem[] => {\r\n\r\n        return items.filter((e) => {\r\n            if (e.is_active == false) return false;\r\n            if (filter == MenuFilter.Booking) return e.is_table && e.eat_in_min_price > 0;\r\n            if (filter == MenuFilter.Delivery) return e.is_delivery && e.delivery_min_price > 0;\r\n            if (filter == MenuFilter.TakeOut) return e.is_collect && e.take_out_min_price > 0;\r\n            return true\r\n        })\r\n    };\r\n\r\n    return <div className='menu-container'>\r\n        <Row className='rootCats'>\r\n            <Col md='12'>\r\n                {\r\n                    visibleRootCategories\r\n                        .map((rootCat, index) =>\r\n                                <div key = { index } className = { `${ activeMenuCategoryIdx == index ? 'active-menu-category2' : ''} menu-root-cat-item2` }\r\n                                    onClick= { () => setActiveMenuCategoryIdx(index)}\r\n                                >\r\n                                    <b>{ rootCat.name }</b>\r\n                                </div>\r\n                        )\r\n                }\r\n            </Col>\r\n        </Row>\r\n\r\n        <Row>\r\n\r\n            <Col md='12'>\r\n                {\r\n                    visibleMenuItems?.length == 0 &&\r\n                    isLoadingMenuItems == false  &&\r\n                    <div className='empty-items-list'>\r\n                        <p>Please choose the items you want</p>\r\n                    </div>\r\n                }\r\n                { isLoadingMenuItems == true && <div className='empty-items-list'>\r\n                    <Loader\r\n                        type=\"Grid\"\r\n                        color=\"#00BFFF\"\r\n                        height={50}\r\n                        width={50}\r\n                    />\r\n                </div>\r\n                }\r\n                {\r\n                    isLoadingMenuItems == false && visibleMenuItems?.map((e, i) =>\r\n                            <Col className={\"floatLeft\"} key = { i } md = { 6 }>\r\n                                <div className='my-menu-item menu-item' onClick = { () => { setPresentingMenuItem(e) } }>\r\n                                    <div className='menu-item-info'>\r\n                                        <p>{ e.name }</p>\r\n                                        <p className='price'>{ `£${ getPrice({ item: e, filter }) }` }</p>\r\n                                    </div>\r\n                                    <p className='desc'>{e.description}</p>\r\n                                </div>\r\n                            </Col>\r\n                        )\r\n\r\n                }\r\n            </Col>\r\n        </Row>\r\n        <ModalMenuItem\r\n            filterType = { filter }\r\n            input = { presentingMenuItem ? { type: MenuItemModalDataType.Normal, dataSource: presentingMenuItem }: undefined }\r\n            dismiss = { () => setPresentingMenuItem(undefined) }/>\r\n    </div>\r\n};\r\n\r\nexport default RestaurantMenu\r\n","import React from 'react'\r\nimport {Col, Row} from 'react-bootstrap'\r\nimport {useParams} from 'react-router'\r\n//types\r\nimport {MenuFilter} from 'type/menu'\r\n//components\r\nimport RestaurantMenu from 'components/menu/menuWithOutCategory'\r\n//styles\r\nimport 'components/menu/styleWithOutSubCategory.scss'\r\nimport 'components/menu/style.scss'\r\n\r\nimport {useMarketContext} from 'store/marketStore'\r\n\r\nconst MenuScreen = () => {\r\n    //hooks\r\n    const { filter } = useParams<{filter: MenuFilter}>()\r\n    const { activeMenuFilter, setActiveMenuFilter } = useMarketContext()\r\n\r\n    // references\r\n    const latestActiveFilter = React.useRef<MenuFilter | undefined>(activeMenuFilter)\r\n\r\n\r\n    React.useEffect(() => {\r\n        latestActiveFilter.current = filter\r\n        setActiveMenuFilter(filter)\r\n    }, [filter])\r\n\r\n    return <div className=\"myContainer\">\r\n        <Row>\r\n            <Col lg = '12'>\r\n                <RestaurantMenu filter = { filter }/>\r\n            </Col>\r\n        </Row>\r\n\r\n    </div>\r\n}\r\n\r\nexport default MenuScreen\r\n","import { BASE_API_URI, cleanObj, REQUEST_BRANCH } from \"lib/handy\";\r\nimport { http } from \"lib/http\";\r\nimport moment from \"moment\";\r\nimport { ActiveBooking, BookAvailableTime, SubmitingBooking } from \"type/booking\";\r\n\r\n\r\nexport async function getActiveBookingApi(): Promise<ActiveBooking> {\r\n    return http<ActiveBooking>(`${BASE_API_URI()}/api/v2/cm/reservations/active`)\r\n}\r\n\r\nexport async function cancelActiveBookingApi(id: string): Promise<void> {\r\n    return http<void>(`${BASE_API_URI()}/api/v2/cm/reservations/${id}/cancel`, {\r\n        method: 'POST'\r\n    })\r\n}\r\n\r\nexport async function getAvailableBookingTimeApi({date, signal}: { date: moment.Moment, signal?: AbortSignal }): Promise<BookAvailableTime[]> {\r\n    return http<BookAvailableTime[]>(`${BASE_API_URI()}/api/v2/cm/reservations/available-times?branch_id=${REQUEST_BRANCH()}&date=${date.format('YYYY-MM-DDTHH:mm:ss')}`, { signal })\r\n}\r\n\r\nexport async function submitBookingApi(input: SubmitingBooking): Promise<ActiveBooking> {\r\n    return http<ActiveBooking>(`${BASE_API_URI()}/api/v2/cm/reservations`, {\r\n        method: 'POST',\r\n        body: JSON.stringify(cleanObj(input))\r\n    })\r\n}\r\n","import React from 'react'\r\nimport {isDev, removeWhiteSpace, formatPostCode, addressToString} from 'lib/handy'\r\nimport { Breadcrumb, Button, Form, Modal, Spinner } from 'react-bootstrap'\r\nimport { useHistory } from 'react-router'\r\nimport { useMarketContext } from 'store/marketStore'\r\nimport { useUser } from 'store/userStore'\r\nimport { PostCodeAddress } from 'type/branch'\r\nimport { MenuFilter } from 'type/menu'\r\nimport { UserAddress } from 'type/user'\r\n\r\nimport './styles.scss'\r\n\r\n\r\nenum FormFields {\r\n    PostCode = 'postcode',\r\n    Address = 'address'\r\n}\r\n\r\nconst PostCodeCheckModal = () => {\r\n    //hooks\r\n    const history = useHistory()\r\n    const { selectPostCode, searchForPostCode, storeInfo } = useMarketContext()\r\n    const { getUserAddress, user } = useUser()\r\n\r\n    //states\r\n    const [formErrors, setFormErrors] = React.useState<{[x in FormFields]?: string }>()\r\n    const [isFormValid, setIsFormValid] = React.useState<boolean>()\r\n    const [presentingAddresses, setPresentingAddresses] = React.useState<PostCodeAddress[]>([])\r\n    const [deliveryCosts, setDeliveryCosts] = React.useState<{ money: string, time: number}>()\r\n    const [isLoadingAddresses, setIsLoadingAddresses] = React.useState<boolean>(false)\r\n    const [presentingUserAddress, setPresentingUserAddress] = React.useState<(UserAddress & { isSupportedWithResturant: boolean, deliveryCost: string })[]>([])\r\n\r\n    //references\r\n    const enteredPostCode = React.useRef<string>()\r\n    const selectedAddress = React.useRef<PostCodeAddress>()\r\n    const needsToSelectAddress = React.useRef<boolean>(false)\r\n\r\n    const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\r\n        event.preventDefault()\r\n        event.stopPropagation()\r\n        setFormErrors(undefined)\r\n\r\n        if (enteredPostCode.current && ((needsToSelectAddress.current && selectedAddress.current != undefined) || needsToSelectAddress.current == false)) {\r\n            if (selectPostCode({\r\n                postCode: removeWhiteSpace(enteredPostCode.current.toUpperCase()),\r\n                line1: selectedAddress.current?.line1,\r\n                line2: selectedAddress.current?.line2,\r\n                town: selectedAddress.current?.town,\r\n                lat: selectedAddress.current?.lat,\r\n                long: selectedAddress.current?.long\r\n            })) {\r\n                setIsFormValid(true)\r\n                history.push({\r\n                    pathname: `/menu/${MenuFilter.Delivery}`,\r\n                })\r\n            } else {\r\n                setIsFormValid(false)\r\n                setFormErrors({ [FormFields.PostCode]: 'Unfortunately we don\\'t support this postcode area' })\r\n            }\r\n        } else if (needsToSelectAddress.current) {\r\n            setIsFormValid(true)\r\n            setFormErrors({ [FormFields.Address]: 'Please select one of these addresses' })\r\n        } else {\r\n            setFormErrors({\r\n                [FormFields.PostCode]: enteredPostCode.current?.length == 0 ? 'Please enter a valid post code' : undefined,\r\n                [FormFields.Address]: 'Please select one of these addresses'\r\n            })\r\n            setIsFormValid(false)\r\n        }\r\n    };\r\n\r\n    const selectFromAddress = (address: UserAddress) => {\r\n        if (\r\n            selectPostCode({\r\n                postCode: removeWhiteSpace(address.postal_code.toUpperCase()),\r\n                id: address.id,\r\n                name: address.name,\r\n                line1: address.line1,\r\n                line2: address.line2,\r\n                country: address.country,\r\n                lat: address.lat,\r\n                long: address.long,\r\n                town: address.town\r\n            }) ) {\r\n            setIsFormValid(true)\r\n            history.push({\r\n                pathname: `/menu/${MenuFilter.Delivery}`,\r\n            })\r\n        } else {\r\n            setIsFormValid(false)\r\n            setFormErrors({ [FormFields.PostCode]: 'Unfortunately we don\\'t support this postcode area' })\r\n        }\r\n    }\r\n\r\n    const postFieldValueChanged = (newValue: string) => {\r\n        enteredPostCode.current = newValue\r\n        setPresentingAddresses([])\r\n        setDeliveryCosts(undefined)\r\n        setIsLoadingAddresses(true)\r\n        needsToSelectAddress.current = true\r\n        selectedAddress.current = undefined\r\n\r\n        //check for available post code (supports)\r\n        let availablePostCodes = storeInfo?.post_codes.filter((e) => removeWhiteSpace(newValue.toUpperCase()).includes(e.post_code) )\r\n        if (availablePostCodes && availablePostCodes.length > 0) {\r\n            storeInfo && setDeliveryCosts({\r\n                time: storeInfo.min_expected_delivery_time,\r\n                money: availablePostCodes[0].delivery_charge\r\n            })\r\n        }\r\n\r\n        searchForPostCode(newValue)\r\n            .then((result) => {\r\n                needsToSelectAddress.current = result.length > 0\r\n                setIsLoadingAddresses(false)\r\n                setPresentingAddresses(result)\r\n                setFormErrors(undefined)\r\n            }).catch((e) => {\r\n                isDev() && console.info('error', e)\r\n                //means that we're searching a bad postal code!!!\r\n                if (!e || e.name != 'AbortError') {\r\n                    setIsLoadingAddresses(false)\r\n                }\r\n                if (e && e.status && e.status == 400) {\r\n                    // it seems that we don't have the address for this post code!\r\n                    // setIsFormValid(false)\r\n                    // setFormErrors({ [FormFields.PostCode]: 'Please enter a valid postCode!' })\r\n                    needsToSelectAddress.current = false\r\n                }\r\n                // I believe it's better to do nothnig here\r\n            })\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        storeInfo &&\r\n            user\r\n            &&\r\n        getUserAddress()\r\n            .then((items) => items.map((item) => {\r\n                let activePostalCodes = storeInfo.post_codes.filter((e) =>\r\n                    e.post_code.includes(removeWhiteSpace(item.postal_code.toUpperCase()))\r\n                )\r\n                return {\r\n                    ...item,\r\n                    isSupportedWithResturant: activePostalCodes.length > 0,\r\n                    deliveryCost: activePostalCodes.length > 0 ? activePostalCodes[0].delivery_charge : \"0$\"\r\n                }\r\n            })).then(setPresentingUserAddress)\r\n            .catch((e) => {\r\n                //do nothing!\r\n            })\r\n\r\n    }, [])\r\n\r\n    return <Modal scrollable animation = { false } show = { true } onHide={() => history.goBack() }>\r\n        <Modal.Header closeButton>\r\n            <Modal.Title>Enter You Post Code</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n            <Form className='post-code-check' validated = { isFormValid } onSubmit = { handleSubmit }>\r\n                { presentingUserAddress.length > 0 && <Form.Group>\r\n                    <Form.Label>ِYour previous addresses</Form.Label>\r\n                    <Breadcrumb>\r\n                        {\r\n                            presentingUserAddress.map((address, index) => {\r\n                                return <Form.Check\r\n                                    key = { index }\r\n                                    type = \"radio\"\r\n                                    className = { address.isSupportedWithResturant == false ? 'dimmed' : '' }\r\n                                    style = {{ whiteSpace: \"pre-wrap\" }}\r\n                                    onChange = { () => selectFromAddress(address) }\r\n                                    id = {`${index}`}\r\n                                    label = {`${addressToString(address)} \\n Delivery cost: ${ address.deliveryCost }$ ${address.isSupportedWithResturant == false ? '\\nNot supported' : ''}`}\r\n                                    disabled = { address.isSupportedWithResturant == false }\r\n                                />\r\n                            })\r\n                        }\r\n                    </Breadcrumb>\r\n                </Form.Group>}\r\n                { presentingUserAddress.length > 0 && <p className='centered'>---------- OR -----------</p> }\r\n                <Form.Group controlId=\"formUserEmail\">\r\n                    <Form.Label>Post Code</Form.Label>\r\n                    <Form.Group controlId=\"PostCode\">\r\n                        <Form.Label>Please enter your postcode (for delivery) <span className=\"required\">*</span></Form.Label>\r\n                        <Form.Control\r\n                            className=\"postcode\"\r\n                            isInvalid = { formErrors ? formErrors[FormFields.PostCode] != undefined : false }\r\n                            onChange = { e => postFieldValueChanged(e.target.value) }\r\n                            type=\"text\" placeholder=\"Your Postcode\"/>\r\n                        <Form.Text className=\"text-muted\">\r\n                            We use the postcode to check the delivery support\r\n                        </Form.Text>\r\n                        <Form.Control.Feedback type=\"invalid\">\r\n                            { formErrors != undefined && formErrors[FormFields.PostCode] }\r\n                        </Form.Control.Feedback>\r\n                    </Form.Group>\r\n                    { presentingAddresses.length != 0 && <Form.Group controlId=\"PostCode\">\r\n                        <Form.Label>Please select one of the addresses below</Form.Label>\r\n                        <Form.Control required as=\"select\" defaultValue = '-1' onChange = { e => {\r\n                                if (e.target.value != '-1') {\r\n                                    selectedAddress.current = presentingAddresses[parseInt(e.target.value)]\r\n                                }\r\n                            }}>\r\n                            <option value = '-1'>Choose...</option>\r\n                            { presentingAddresses.map((e, i) => <option key = { i } value = { i }>{ e.full_addresses }</option>) }\r\n                        </Form.Control>\r\n                        { formErrors != undefined && formErrors[FormFields.Address] != undefined && <div style = {{ display: 'block' }} className='invalid-feedback'>\r\n                            { formErrors[FormFields.Address] }\r\n                        </div> }\r\n                    </Form.Group>}\r\n                    { isLoadingAddresses && <Spinner animation=\"border\" role=\"status\">\r\n                        <span className=\"sr-only\">Loading...</span>\r\n                    </Spinner>}\r\n                    {\r\n                        deliveryCosts && <Form.Group className='centered'>\r\n                            <p className='form-check-label danger'>\r\n                                Delivery cost: {deliveryCosts.money}$\r\n                            </p>\r\n                            <p className='form-check-label danger'>\r\n                                Minimum delivery time: { deliveryCosts.time } min\r\n                            </p>\r\n                        </Form.Group>\r\n                    }\r\n                    <div className=\"centered form-group\">\r\n                        <Button variant=\"primary\" type=\"submit\">\r\n                            Continue\r\n                        </Button>\r\n                    </div>\r\n                </Form.Group>\r\n            </Form>\r\n        </Modal.Body>\r\n    </Modal>\r\n}\r\n\r\nexport default PostCodeCheckModal\r\n","import React from 'react'\r\nimport moment from 'moment'\r\nimport { Spinner, Container, Row, Col, Card, Form, Button, Modal } from 'react-bootstrap'\r\nimport toast from 'react-hot-toast'\r\nimport { cancelActiveBookingApi, getActiveBookingApi, getAvailableBookingTimeApi, submitBookingApi } from 'store/webServiceApi/booking'\r\nimport { ActiveBooking, BookAvailableTime } from 'type/booking'\r\nimport Calendar from 'react-calendar';\r\n\r\n//styles\r\nimport './styles.scss'\r\nimport 'react-calendar/dist/Calendar.css';\r\nimport { useUser } from 'store/userStore'\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport {getErrorMessage, REQUEST_BRANCH} from 'lib/handy'\r\nimport { useMarketContext } from 'store/marketStore'\r\n\r\n//assets\r\n\r\ntype TimeInterval = BookAvailableTime & {\r\n    isSelected: boolean,\r\n    drawHour: boolean,\r\n    hour: String | undefined\r\n}\r\n\r\nlet numberOfGuests : string[] = [];\r\n\r\nconst Booking = () => {\r\n\r\n    //hooks\r\n    const { user } = useUser();\r\n    const { storeInfo } = useMarketContext();\r\n    const history = useHistory();\r\n\r\n\r\n    //states\r\n    const [isLoading, setIsLoading] = React.useState<boolean>(false);\r\n    const [activeBooking, setActiveBooking] = React.useState<ActiveBooking | null>();\r\n    const [targetTime, setTargetTime] = React.useState<moment.Moment>(moment().add(1, 'day'))\r\n    const [timeIntervals, setTimeIntervals] = React.useState<TimeInterval[] | null>();\r\n    const [selectedCapacity, setSelectedCapacity] = React.useState<number>(2);\r\n    const [selectedDate, setSelectedDate] = React.useState<Date>(targetTime.toDate());\r\n    const [isPresentDatePicker, setIsPresentDatePicker] = React.useState<boolean>(false);\r\n    const [isSelectedCapacityInvalid, setIsSelectedCapacityInvalid] = React.useState<boolean>(false);\r\n    const [isSubmitting, setIsSubmitting] = React.useState<boolean>(false);\r\n    const [hasSelect, setHasSelect] = React.useState<boolean>(false);\r\n    const [isCancelConfirmModalPresented, setIsCancelConfirmModalPresented] = React.useState<boolean>(false)\r\n\r\n    //references\r\n    const targetTimeRef = React.useRef<moment.Moment>(targetTime);\r\n    const selectedCapacityRef = React.useRef<number>(selectedCapacity);\r\n\r\n    React.useEffect(() => {\r\n        selectedCapacityRef.current = selectedCapacity\r\n    }, [selectedCapacity]);\r\n\r\n    React.useEffect(() => {\r\n        getActiveBookingApi()\r\n            .then((activeBooking) => {\r\n                if(!!activeBooking) { setActiveBooking(activeBooking) }\r\n                else { setActiveBooking(null) }\r\n            })\r\n    }, []);\r\n\r\n    React.useEffect(() => {\r\n        if (storeInfo != undefined && storeInfo.is_booking_active == false) {\r\n            toast.error('Booking service is not active in this restaurant!')\r\n            history.replace('/')\r\n        }\r\n        else {\r\n\r\n            let limit;\r\n            numberOfGuests = [];\r\n\r\n            if(storeInfo != null)\r\n                limit = storeInfo.maximum_acceptance_capacity;\r\n            else\r\n                limit = 15;\r\n\r\n            for(let i = 1; i <= limit; i++)\r\n                numberOfGuests.push(i + \"\");\r\n        }\r\n    }, [storeInfo]);\r\n\r\n    React.useEffect(() => {\r\n        //if user is not authenticated just return\r\n        if (user == undefined) return;\r\n        targetTimeRef.current = targetTime;\r\n        getAvailableTimes()\r\n    }, [targetTime, user]);\r\n\r\n    const getAvailableTimes = (signal?: AbortSignal) => {\r\n        setTimeIntervals(undefined);\r\n        getAvailableBookingTimeApi({ date: targetTimeRef.current, signal })\r\n            .then((e) => {\r\n\r\n                let uniqueHours : Map<String, boolean> = new Map<String, boolean>();\r\n                let out : TimeInterval[] = [];\r\n\r\n                e.map(i => {\r\n\r\n                    let drawHour: boolean = false;\r\n                    let h : String = \"\";\r\n\r\n                    if(i.is_available) {\r\n                        h = i.time.toString().substr(0, i.time.toString().indexOf(\":\"));\r\n                        if (uniqueHours.has(h))\r\n                            drawHour = false;\r\n                        else {\r\n                            drawHour = true;\r\n                            uniqueHours.set(h, true);\r\n                        }\r\n                    }\r\n\r\n                    out.push({...i, isSelected: false, drawHour: drawHour, hour: h + \":00\"})\r\n                });\r\n\r\n                return out;\r\n            })\r\n            .then(setTimeIntervals)\r\n            .catch((e) => {\r\n                toast.error(getErrorMessage(e));\r\n                setTimeIntervals(null)\r\n            })\r\n    };\r\n\r\n    const toggleSelectedIndex = (index: number) => {\r\n        setHasSelect(true);\r\n        setTimeIntervals(p => !!p ? p.map((e, i) => ({ ...e, isSelected: i == index ? true : false  })) : undefined)\r\n    };\r\n\r\n    const openCalendar = () => {\r\n        setIsPresentDatePicker(true)\r\n    };\r\n\r\n    const setReferSession = () => {\r\n        window.localStorage.refer = \"/menu/booking\";\r\n    };\r\n\r\n    const guestQuantityChanged = (newValue: string) => {\r\n        setIsLoading(true);\r\n        let numberValue = parseInt(newValue);\r\n        if (`${numberValue}` != newValue) {  setIsSelectedCapacityInvalid(true); return }\r\n        else { setIsSelectedCapacityInvalid(false) }\r\n        setSelectedCapacity(numberValue != NaN ? numberValue : 1);\r\n        setTimeout(function () {\r\n            setIsLoading(false);\r\n        }, 1500);\r\n    };\r\n\r\n    const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        if (user == undefined) return\r\n\r\n        let selectedInterval = timeIntervals?.filter(e => e.isSelected == true)\r\n        if (selectedInterval == undefined || selectedInterval.length == 0) {\r\n            toast.error('Please select one of the times for booking')\r\n            return\r\n        }\r\n        let branchId = REQUEST_BRANCH()\r\n        if (branchId == undefined) return\r\n\r\n        setIsSubmitting(true)\r\n\r\n        toast.promise(\r\n            submitBookingApi({\r\n                customer_id: user.id,\r\n                start: `${targetTimeRef.current.format('YYYY-MM-DD')}T${selectedInterval[0].time}`,\r\n                branch_id: branchId,\r\n                number_of_guests: selectedCapacityRef.current,\r\n            }).then(setActiveBooking)\r\n            .finally(() => {\r\n                setActiveBooking({\r\n                    \"id\": \"\",\r\n                    \"start\": new Date(),\r\n                    \"end\": new Date(),\r\n                    \"number_of_guests\": selectedCapacityRef.current,\r\n                    \"duration\": 1,\r\n                    \"description\": \"\",\r\n                    \"status\": \"success\",\r\n                    \"customer_id\": user.id,\r\n                    \"customer_name\": user.username,\r\n                    \"branch_id\": \"\",\r\n                    \"branch_name\": \"\",\r\n                    \"invitations\": []\r\n                });\r\n                setIsSubmitting(false);\r\n            }),\r\n            {\r\n              loading: 'Loading',\r\n              success: () => `Successfully booked`,\r\n              error: (e) => getErrorMessage(e),\r\n        })\r\n    }\r\n\r\n    const cancelActiveBooking = (id: string) => {\r\n        setIsSubmitting(true)\r\n\r\n        toast.promise(\r\n            cancelActiveBookingApi(id)\r\n            .then(() => {\r\n                setIsCancelConfirmModalPresented(false);\r\n                setActiveBooking(null)\r\n            })\r\n            .finally(() => setIsSubmitting(false)),\r\n            {\r\n              loading: 'Loading',\r\n              success: () => `Successfully canceled your booking`,\r\n              error: (e) => getErrorMessage(e),\r\n        })\r\n    }\r\n\r\n    return <Container>\r\n        <Row>\r\n            <Col>\r\n                <Form.Group />\r\n                { user && activeBooking == null && <Card>\r\n                    <Card.Title className='centered headerFont'>Booking</Card.Title>\r\n                    <Card body>\r\n                        <Row>\r\n                            <Col md=\"6\">\r\n                                <Form onSubmit = { handleSubmit  } validated = { true }>\r\n                                    <Form.Group >\r\n                                        <h1 className='centered textFont2'>\r\n                                            Book a table\r\n                                        </h1>\r\n                                    </Form.Group>\r\n                                    <Form.Group controlId=\"formBasicEmail\">\r\n                                        <Form.Label>Booking date <span className=\"required\">*</span></Form.Label>\r\n                                        <div className='bookDateBox' onClick = { openCalendar }>\r\n                                            <span>{ targetTime.format('dddd DD-MM-YYYY') }</span>\r\n                                        </div>\r\n                                    </Form.Group>\r\n                                    <Form.Group controlId=\"formBasicEmail\">\r\n                                        <Form.Label>Number of guests <span className=\"required\">*</span></Form.Label>\r\n\r\n                                        <Form.Control\r\n                                            required\r\n                                            defaultValue = { selectedCapacity }\r\n                                            type=\"text\"\r\n                                            as=\"select\"\r\n                                            onChange = { e => guestQuantityChanged(e.target.value) }\r\n                                        >\r\n                                            {\r\n                                                numberOfGuests.map(option => (\r\n                                                <option key={option}> {option}</option>\r\n                                            ))}\r\n                                        </Form.Control>\r\n\r\n                                        <Form.Control.Feedback type='invalid'>\r\n                                            Please enter a valid number\r\n                                        </Form.Control.Feedback>\r\n                                    </Form.Group>\r\n                                    <Form.Group>\r\n                                        <Button disabled = { !hasSelect || isSubmitting || isSelectedCapacityInvalid || user == undefined } variant=\"primary\" type=\"submit\">\r\n                                            Continue\r\n                                        </Button>\r\n                                    </Form.Group>\r\n                                </Form>\r\n                            </Col>\r\n\r\n                            <Col md=\"6\" className='availableTimesWrapperParent'>\r\n                                <div className='availableTimesWrapper'>\r\n                                    { (isLoading || timeIntervals == undefined) && <Spinner animation=\"border\" role=\"status\">\r\n                                        <span className=\"sr-only\">Loading...</span>\r\n                                    </Spinner> }\r\n                                    { !isLoading && timeIntervals?.length == 0 && <p>There is no available times for book in this day!</p> }\r\n                                    {\r\n                                        !isLoading && timeIntervals && timeIntervals\r\n                                            .map((e, i) => {\r\n                                                return !e.is_available ? '' :\r\n                                                    e.drawHour ?\r\n                                                        <div className={\"a\"}>\r\n                                                            <h1 className={\"labelHourInBooking\"}>{e.hour}</h1>\r\n                                                            <div onClick={() => toggleSelectedIndex(i)} key={i} className={`availableTimeItem ${ e.isSelected ? 'selected' : '' }`}>\r\n                                                                <label>{e.time}</label>\r\n                                                                <p className={e.capacity >= selectedCapacity ? 'availableLabel' : 'notAvailableLabel'}>{e.capacity >= selectedCapacity ? 'Available' : 'Not Available'}</p>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    :\r\n                                                    <div onClick={() => toggleSelectedIndex(i)} key={i}\r\n                                                         className={`availableTimeItem ${ e.isSelected ? 'selected' : '' }`}>\r\n                                                        <label>{e.time}</label>\r\n                                                        <p className={e.capacity >= selectedCapacity ? 'availableLabel' : 'notAvailableLabel'}>{e.capacity >= selectedCapacity ? 'Available' : 'Not Available'}</p>\r\n                                                    </div>\r\n                                            })\r\n                                    }\r\n                                </div>\r\n                            </Col>\r\n                        </Row>\r\n                    </Card>\r\n                </Card>\r\n                }\r\n                {\r\n                    user == undefined && <Card>\r\n                        <Card body>\r\n                            <Form.Group className='centered'>\r\n                                <Form.Label>In order to use booking service you need to login</Form.Label>\r\n                            </Form.Group>\r\n                            <Form.Group className='centered'>\r\n                                <Link onClick={setReferSession} to ='/login'>Login</Link>\r\n                            </Form.Group>\r\n                        </Card>\r\n                    </Card>\r\n                }\r\n                {\r\n                    user && !!activeBooking && <Card>\r\n                        <Card body>\r\n                            <Form>\r\n                                <Form.Group>\r\n                                    <Form.Label className='centered'>Your active Booking</Form.Label>\r\n                                </Form.Group>\r\n                                <Form.Group>\r\n                                    <Form.Label>\r\n                                        You have an active booking in this restaurant.\r\n                                        Only one active booking is allowed for each restaurant\r\n                                    </Form.Label>\r\n                                </Form.Group>\r\n                                <Form.Group>\r\n                                    <Form.Label>\r\n                                        booking date\r\n                                    </Form.Label>\r\n                                    <Form.Control\r\n                                        type='text'\r\n                                        value = { moment(activeBooking.start).format('DD/MM/YYYY') }\r\n                                        readOnly\r\n                                        />\r\n                                </Form.Group>\r\n                                <Form.Group>\r\n                                    <Form.Label>\r\n                                        Booking time\r\n                                    </Form.Label>\r\n                                    <Form.Control\r\n                                        type='text'\r\n                                        value = { moment(activeBooking.start).format('HH:mm') }\r\n                                        readOnly\r\n                                        />\r\n                                </Form.Group>\r\n                                <Form.Group>\r\n                                    <Form.Label>\r\n                                        Number of guests\r\n                                    </Form.Label>\r\n                                    <Form.Control\r\n                                        type='text'\r\n                                        value = { activeBooking.number_of_guests }\r\n                                        readOnly\r\n                                        />\r\n                                </Form.Group>\r\n\r\n                                <Form.Group className=\"centered\">\r\n                                    <Button className=\"btn btn-danger\" onClick = { () => setIsCancelConfirmModalPresented(true) }>Cancel this Booking</Button>\r\n                                </Form.Group>\r\n                            </Form>\r\n                        </Card>\r\n                    </Card>\r\n                }\r\n            </Col>\r\n        </Row>\r\n        <Modal scrollable animation={ false } show = { isPresentDatePicker } onHide={() => {\r\n                setSelectedDate(targetTime.toDate())\r\n                setIsPresentDatePicker(false)\r\n            }}>\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>Select a date</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <Form.Group>\r\n                    { isPresentDatePicker && <div className='flexCentered'>\r\n                        <Calendar\r\n                            minDate = { new Date() }\r\n                            onChange = { e => {\r\n                                setSelectedDate(e);\r\n                                setTargetTime(moment(e));\r\n                                setIsPresentDatePicker(false)\r\n                            }}\r\n                            value = { selectedDate }\r\n                        />\r\n                    </div>}\r\n                </Form.Group>\r\n            </Modal.Body>\r\n        </Modal>\r\n        <Modal animation={ false } show = { isCancelConfirmModalPresented } onHide={() => setIsCancelConfirmModalPresented(false)}>\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>Are you sure?</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                Are you sure you want to remove this booking?\r\n            </Modal.Body>\r\n            <Modal.Footer className={\"centeredFlex\"}>\r\n                <Button variant=\"secondary\" onClick={() => setIsCancelConfirmModalPresented(false) }>\r\n                    No\r\n                </Button>\r\n                <Button disabled = { isSubmitting } variant=\"primary\" onClick = { () => activeBooking?.id && cancelActiveBooking(activeBooking.id) }>\r\n                    Yes, I'm sure\r\n                </Button>\r\n            </Modal.Footer>\r\n        </Modal>\r\n    </Container>\r\n}\r\n\r\nexport default Booking;\r\n","import React from 'react'\r\nimport { Container, Row, Col, Form, Button, Card } from 'react-bootstrap'\r\nimport toast from 'react-hot-toast'\r\nimport { useTranslation } from 'react-i18next'\r\nimport PhoneInput from 'react-phone-input-2'\r\nimport { Link, useHistory, useLocation } from 'react-router-dom'\r\nimport { useUser } from 'store/userStore'\r\nimport PasswordField from 'components/passwordField'\r\nimport {getErrorMessage} from \"../../lib/handy\";\r\n\r\nconst SignUp = () => {\r\n\r\n    //hooks\r\n    const { register } = useUser()\r\n    const { state } = useLocation<{nextPathname: string}>()\r\n    const history = useHistory()\r\n\r\n    //states\r\n    const [isFormValidated, setIsFormValidated] = React.useState<boolean>(false)\r\n    const [isFormSubmitting, setIsFormSubmitting] = React.useState<boolean>(false)\r\n\r\n    //references\r\n    const enteredFullName = React.useRef<string>()\r\n    const enteredEmail = React.useRef<string>()\r\n    const enteredPhone = React.useRef<string>()\r\n    const enteredPass = React.useRef<string>()\r\n\r\n    const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        setIsFormValidated(true)\r\n\r\n        if (enteredPhone.current != undefined &&\r\n            enteredPass.current != undefined) {\r\n            setIsFormSubmitting(true)\r\n            register({\r\n                full_name: enteredFullName.current != undefined ? enteredFullName.current : '',\r\n                mobile: enteredPhone.current,\r\n                email: enteredEmail.current,\r\n                password: enteredPass.current\r\n            })\r\n            .then(() => {\r\n                history.push({\r\n                    pathname: '/enter-code',\r\n                    state: state && state.nextPathname ? { nextPathname: state.nextPathname } : undefined\r\n                })\r\n            })\r\n            .catch((e) => {\r\n                toast.error(getErrorMessage(e))\r\n            }).finally(() => {\r\n                setIsFormSubmitting(false)\r\n            })\r\n        }\r\n    }\r\n\r\n    return <Container>\r\n        <Row>\r\n            <Col md = {{ span: 6, offset: 3 }}>\r\n                <Form.Group />\r\n                <Card>\r\n                    <Card.Body>\r\n                        <Form.Group >\r\n                            <h1 className='centered'>\r\n                                Sign Up\r\n                            </h1>\r\n                        </Form.Group>\r\n                        <Form noValidate validated = { isFormValidated } onSubmit = { handleSubmit }>\r\n                            <Form.Group controlId=\"signUpFullName\">\r\n                                <Form.Label>Name</Form.Label>\r\n                                <Form.Control\r\n                                    className=\"capitalize\"\r\n                                    type=\"text\" placeholder=\"Name\"\r\n                                    onChange = { e => enteredFullName.current = e.target.value }/>\r\n                            </Form.Group>\r\n                            <Form.Group controlId=\"signUpEmail\">\r\n                                <Form.Label>Email address</Form.Label>\r\n                                <Form.Control\r\n                                    type=\"email\" placeholder=\"Enter email\"\r\n                                    onChange = { e => enteredEmail.current = e.target.value }/>\r\n                                <Form.Text className=\"text-muted\">\r\n\r\n                                </Form.Text>\r\n                            </Form.Group>\r\n                            <Form.Group controlId=\"signUpEmail\">\r\n                                <Form.Label>Mobile Number <span className=\"required\">*</span></Form.Label>\r\n                                <PhoneInput\r\n                                    country = { 'gb' }\r\n                                    onlyCountries = {[ 'ie', 'ch', 'no', 'gb' ]}\r\n                                    inputClass = 'phone-input-form-control'\r\n                                    countryCodeEditable={false}\r\n                                    onChange = { value => enteredPhone.current = value }\r\n                                    inputProps={{\r\n                                        name: 'phone',\r\n                                        required: true,\r\n                                        autoFocus: false\r\n                                    }}\r\n                                />\r\n                                {  <Form.Control.Feedback type='invalid'>Please enter a valid mobile number</Form.Control.Feedback>}\r\n                                <Form.Text className=\"text-muted\">\r\n\r\n                                </Form.Text>\r\n                            </Form.Group>\r\n                            <Form.Group controlId=\"signUpPassword\">\r\n                                <Form.Label>Password <span className=\"required\">*</span></Form.Label>\r\n                                <PasswordField\r\n                                        name='password'\r\n                                        required = { true }\r\n                                        onChange = { e => enteredPass.current = e.target.value }\r\n                                        placeholder=\"Password\"/>\r\n                                <Form.Control.Feedback type='invalid'>Please enter a valid password</Form.Control.Feedback>\r\n                            </Form.Group>\r\n                            <div className=\"centered form-group\">\r\n                                <Button disabled = { isFormSubmitting } variant=\"primary\" type=\"submit\">\r\n                                    Submit\r\n                                </Button>\r\n                            </div>\r\n                            <div className='centered'>\r\n                                <p>Already have an account? <Link to='/login'>Login</Link></p>\r\n                            </div>\r\n                        </Form>\r\n                    </Card.Body>\r\n                </Card>\r\n            </Col>\r\n        </Row>\r\n    </Container>\r\n}\r\n\r\nexport default SignUp\r\n","import React from 'react'\r\nimport { Container, Row, Col, Form, Button, Card } from 'react-bootstrap'\r\nimport PhoneInput from 'react-phone-input-2'\r\nimport toast from 'react-hot-toast';\r\nimport { useUser } from 'store/userStore';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport {getErrorMessage} from \"../../lib/handy\";\r\n\r\nconst ForgetPass = () => {\r\n\r\n    const history = useHistory()\r\n    const { t } = useTranslation()\r\n    const { forgetPass } = useUser()\r\n\r\n    const [isSubmitting, setisSubmitting] = React.useState<boolean>(false)\r\n    const enteredPhone = React.useRef<string>()\r\n\r\n    React.useEffect(() => {\r\n\r\n        if(window.localStorage.TokenStorageKey !== undefined &&\r\n            window.localStorage.TokenStorageKey != null &&\r\n            window.localStorage.TokenStorageKey != \"null\" &&\r\n            window.localStorage.TokenStorageKey.length > 0\r\n        ) {\r\n            history.goBack();\r\n        }\r\n\r\n    }, []);\r\n\r\n    const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n\r\n        if (enteredPhone.current == undefined || enteredPhone.current.length == 0) {\r\n            toast.error('Please enter your mobile number')\r\n            return\r\n        }\r\n\r\n        setisSubmitting(true)\r\n        toast.promise(\r\n            forgetPass({ mobile: enteredPhone.current })\r\n            .then(() => {\r\n                history.push({\r\n                    pathname: '/reset-pass'\r\n                })\r\n            })\r\n            .finally(() => setisSubmitting(false)),\r\n            {\r\n              loading: 'Loading',\r\n              success: () => `Successfully we've send you a verify code`,\r\n              error: (e) => getErrorMessage(e),\r\n        })\r\n    }\r\n\r\n    return <Container>\r\n        <Row>\r\n            <Col md = {{ span: 6, offset: 3 }}>\r\n                <Form.Group />\r\n                    <Card>\r\n                        <Card.Body>\r\n                            <Form.Group >\r\n                                <h1 className='centered'>\r\n                                    Forget your password?\r\n                                </h1>\r\n                            </Form.Group>\r\n                            <Form.Group >\r\n                                <Form.Text className=\"text-muted\">\r\n                                    Just enter your mobile number and we'll send you a code to reset your password\r\n                                </Form.Text>\r\n                            </Form.Group>\r\n                            <Form onSubmit = { handleSubmit }>\r\n                                <Form.Group controlId=\"formUserEmail\">\r\n                                <Form.Label>Mobile Number <span className=\"required\">*</span></Form.Label>\r\n                                <PhoneInput\r\n                                    onChange = { value => enteredPhone.current = value }\r\n                                    country = { 'gb' }\r\n                                    onlyCountries = {[ 'ie', 'ch', 'no', 'gb' ]}\r\n                                    countryCodeEditable={false}\r\n                                    inputClass = 'phone-input-form-control'\r\n                                    inputProps={{\r\n                                        name: 'phone',\r\n                                        required: true,\r\n                                        autoFocus: true\r\n                                    }}\r\n                                />\r\n                                </Form.Group>\r\n                                <div className=\"centered form-group\">\r\n                                    <Button disabled = { isSubmitting } variant=\"primary\" type=\"submit\">\r\n                                        send code\r\n                                    </Button>\r\n                                </div>\r\n                            </Form>\r\n                        </Card.Body>\r\n                    </Card>\r\n            </Col>\r\n        </Row>\r\n    </Container>\r\n}\r\n\r\nexport default ForgetPass\r\n","import React from 'react'\r\nimport { Container, Row, Col, Form, Button, Card } from 'react-bootstrap'\r\nimport toast from 'react-hot-toast'\r\nimport { useTranslation } from 'react-i18next'\r\nimport PhoneInput from 'react-phone-input-2'\r\nimport {  useHistory, useLocation } from 'react-router-dom'\r\nimport { useMarketContext } from 'store/marketStore'\r\nimport { useUser } from 'store/userStore'\r\nimport moment from 'moment'\r\nimport { MenuFilter } from 'type/menu'\r\nimport {useParams} from \"react-router\";\r\nimport CurrentOrder from 'components/currentOrder';\r\nimport {formatPostCode, getErrorMessage} from 'lib/handy';\r\n\r\nenum Fields {\r\n    FirstName = 'firstname',\r\n    LastName = 'lastname',\r\n    Email = 'email',\r\n    Mobile = 'mobile',\r\n    Pass = 'password',\r\n    RePass = 'repassword'\r\n}\r\n\r\nconst StartCheckout = () => {\r\n\r\n\r\n    //hooks\r\n    const history = useHistory()\r\n    const { t } = useTranslation()\r\n    const { pathname } = useLocation()\r\n    const { user } = useUser()\r\n    const {\r\n        activeMenuFilter,\r\n        availableDeliverTime,\r\n        activePostCode,\r\n        basketItems,\r\n        submitOrder\r\n    } = useMarketContext()\r\n\r\n    //states\r\n    const [isFormValidated, setIsFormValidated] = React.useState<boolean>(false)\r\n    const [isFormSubmitting, setIsFormSubmitting] = React.useState<boolean>(false)\r\n\r\n    //references\r\n    const enteredPhone = React.useRef<string | undefined>(user?.mobile)\r\n    const enteredFullName = React.useRef<string | undefined>(user?.full_name)\r\n    const enteredPostCode = React.useRef<string |  undefined>(activePostCode?.postCode)\r\n    const enteredAddressLine1 = React.useRef<string | undefined>(activePostCode?.line1)\r\n    const enteredAddressLine2 = React.useRef<string | undefined>(activePostCode?.line2)\r\n    const enteredTown = React.useRef<string | undefined>(activePostCode?.town)\r\n    const enteredDeliverTime = React.useRef<moment.Moment>()\r\n    const enteredMoreDescription = React.useRef<string>()\r\n    const activeMenuFilterRef = React.useRef<MenuFilter | undefined>(activeMenuFilter)\r\n    const isActive = React.useRef<boolean>(true)\r\n\r\n    React.useEffect(() => {\r\n        //wait untill everything has been set\r\n        setTimeout(() => {\r\n            if (activeMenuFilterRef.current == undefined && isActive.current == true) {\r\n                history.replace({ pathname: '/' })\r\n            }\r\n        }, 1000);\r\n\r\n        return () => { isActive.current = false }\r\n    }, [])\r\n\r\n    React.useEffect(() => {\r\n        activeMenuFilterRef.current = activeMenuFilter\r\n    }, [activeMenuFilter])\r\n\r\n    React.useEffect(() => {\r\n        if (user) {\r\n            enteredPhone.current = user.mobile\r\n            enteredFullName.current = user.full_name\r\n        }\r\n    }, [user])\r\n\r\n    React.useEffect(() => {\r\n        if( availableDeliverTime && availableDeliverTime.length > 0 ) {\r\n            enteredDeliverTime.current = availableDeliverTime[0]\r\n        }\r\n    }, [availableDeliverTime])\r\n\r\n    React.useEffect(() => {\r\n        if (activePostCode) {\r\n            enteredPostCode.current = activePostCode.postCode\r\n            enteredAddressLine1.current = activePostCode?.line1\r\n            enteredAddressLine2.current = activePostCode.line2\r\n            enteredTown.current = activePostCode.town\r\n        }\r\n    }, [activePostCode])\r\n\r\n    const goForLoginSignUp = () => {\r\n        history.push({\r\n            pathname: '/login',\r\n            state: { nextPathname: pathname }\r\n        })\r\n    }\r\n\r\n    const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        setIsFormValidated(true)\r\n        if (activeMenuFilter == undefined) return\r\n\r\n        if (enteredPhone.current == undefined) {\r\n            toast.error('Please enter your mobile number')\r\n            return\r\n        }\r\n\r\n\r\n        setIsFormSubmitting(true)\r\n        let orderRows = basketItems.map((item) => {\r\n            return {\r\n                size_id: item.sizeOptionId,\r\n                count: item.quantity,\r\n            }\r\n        })\r\n\r\n        toast.promise(\r\n            submitOrder({\r\n                customer_info: {\r\n                    full_name: enteredFullName.current == undefined ? '' : enteredFullName.current,\r\n                    mobile: enteredPhone.current,\r\n                    address: {\r\n                        lat: activePostCode?.lat,\r\n                        long: activePostCode?.long,\r\n                        line1: enteredAddressLine1.current || activePostCode?.line1,\r\n                        line2: enteredAddressLine2.current || activePostCode?.line2,\r\n                        town: enteredTown.current || activePostCode?.town,\r\n                        postal_code: activePostCode?.postCode\r\n                    }\r\n                },\r\n                order_type: activeMenuFilter,\r\n                order_rows: orderRows,\r\n                delivery_date: enteredDeliverTime.current?.format('YYYY-MM-DDTHH:mm:ss'),\r\n                customer_id: user?.id,\r\n                // customer_address_id: activePostCode?.id,\r\n                description: enteredMoreDescription.current\r\n            })\r\n            .then(() => {\r\n                history.replace({ pathname: '/payment' })\r\n            }).finally(() => {\r\n                setIsFormSubmitting(false)\r\n            }),\r\n            {\r\n                loading: 'Submiting',\r\n                success: () => `Your order has been submitted.`,\r\n                error: (e) => getErrorMessage(e),\r\n        })\r\n    }\r\n\r\n    return <Container>\r\n        <Row>\r\n            <Col md = {{ span: 8 }}>\r\n                <Form.Group />\r\n                <Card>\r\n                    <Card.Body>\r\n                        {\r\n                            user == undefined && <>\r\n                                <Form.Group >\r\n                                    <h2 className='centered'>\r\n                                        How do you want to continue?\r\n                                    </h2>\r\n                                </Form.Group>\r\n                                <Form.Group className='centered'>\r\n                                    <Button onClick = { goForLoginSignUp } variant=\"outline-primary\">Login/Signup</Button>\r\n                                </Form.Group>\r\n                                <Form.Group className='centered'>\r\n                                    ---------- OR ----------\r\n                                </Form.Group>\r\n                                <h2 className='centered'>\r\n                                    Continue as a guest\r\n                                </h2>\r\n                            </>\r\n                        }\r\n                        {\r\n                            user != undefined && <>\r\n                                <h2 className='centered'>\r\n                                    {`Hi ${user.full_name}`}\r\n                                </h2>\r\n                            </>\r\n                        }\r\n                        <Form noValidate validated = { isFormValidated } onSubmit = { handleSubmit }>\r\n                            {\r\n                                user == undefined && <Form.Group controlId=\"StartCheckoutFirtName\">\r\n                                    <Form.Label>Name</Form.Label>\r\n                                    <Form.Control\r\n                                        type=\"text\" placeholder=\"Name\"\r\n                                        className=\"capitalize\"\r\n                                        onChange = { e => enteredFullName.current = e.target.value }/>\r\n                                </Form.Group>\r\n                            }\r\n                            <Form.Group controlId=\"StartCheckoutMobile\">\r\n                                <Form.Label>Mobile Number <span className=\"required\">*</span></Form.Label>\r\n                                <PhoneInput\r\n                                    country = { 'gb' }\r\n                                    onlyCountries = {[ 'ie', 'ch', 'no', 'gb' ]}\r\n                                    inputClass = 'phone-input-form-control'\r\n                                    value = { user?.mobile }\r\n                                    countryCodeEditable={false}\r\n                                    onChange = { value => enteredPhone.current = value }\r\n                                    inputProps={{\r\n                                        name: 'mobile number',\r\n                                        required: true,\r\n                                        autoFocus: false\r\n                                    }}\r\n                                />\r\n                                {  <Form.Control.Feedback type='invalid'>Please enter a valid mobile number</Form.Control.Feedback>}\r\n                                <Form.Text className=\"text-muted\">\r\n                                    We use this mobile number for delivery contact.\r\n                                </Form.Text>\r\n                            </Form.Group>\r\n                            {\r\n                                activeMenuFilter == MenuFilter.Delivery && <Form.Group controlId=\"StartCheckoutAddress\">\r\n                                    <Form.Label>Address To Deliver</Form.Label>\r\n                                    <Form.Control\r\n                                        required\r\n                                        type=\"text\" placeholder=\"Postal code\"\r\n                                        className=\"postcode\"\r\n                                        value = { activePostCode?.postCode != undefined ? formatPostCode(activePostCode?.postCode) : '' }\r\n                                        readOnly = { activePostCode != undefined }\r\n                                        onChange = { e => { enteredPostCode.current = e.target.value }}/>\r\n                                    <Form.Control\r\n                                        required\r\n                                        type=\"text\" placeholder=\"Address line 1\"\r\n                                        value = { activePostCode?.line1 }\r\n                                        readOnly = { activePostCode?.line1 != undefined }\r\n                                        onChange = { e => { enteredAddressLine1.current = e.target.value }}/>\r\n                                    {\r\n                                        (activePostCode?.line1 == undefined || (activePostCode?.line2 != undefined && activePostCode.line2.length > 0 )) &&\r\n                                        <Form.Control\r\n                                            type=\"text\" placeholder=\"Address line 2\"\r\n                                            value = { activePostCode?.line2 }\r\n                                            readOnly = { activePostCode?.line2 != undefined }\r\n                                            onChange = { e => { enteredAddressLine2.current = e.target.value }}/>\r\n                                    }\r\n                                    <Form.Control\r\n                                        required\r\n                                        type=\"text\" placeholder=\"Town or city\"\r\n                                        value = { activePostCode?.town }\r\n                                        readOnly = { activePostCode?.town != undefined }\r\n                                        onChange = { e => { enteredTown.current = e.target.value }}/>\r\n\r\n                                </Form.Group>\r\n                            }\r\n                            <Form.Group controlId=\"StartCheckoutDeliveryTime\">\r\n                                <Form.Label>{`When do you want ${activeMenuFilter == MenuFilter.Delivery ? 'your delivery?' : 'to collect?'}`}</Form.Label>\r\n                                { availableDeliverTime && availableDeliverTime.length > 0 &&\r\n                                    <Form.Control required as=\"select\" defaultValue = '0' onChange = { e => {\r\n                                        enteredDeliverTime.current = availableDeliverTime[parseInt(e.target.value)]\r\n                                        }}>\r\n                                        <option value = '0'>{`ASAP (${availableDeliverTime[0].format('dddd HH:mm')}-${moment(availableDeliverTime[0]).add(15,'m').format('HH:mm')})`}</option>\r\n                                        { availableDeliverTime && availableDeliverTime\r\n                                            .slice(1) //to ignore first one\r\n                                            .map((e, i) => <option key = { i } value = { i }>{ e.format('dddd HH:mm') }-{moment(e).add(15,'m').format('HH:mm')}</option>) }\r\n                                    </Form.Control>\r\n                                }\r\n                                { availableDeliverTime && availableDeliverTime.length == 0 && <div style={{color: 'darkred'}}>There is not any valid time for today.</div>}\r\n                            </Form.Group>\r\n                            <Form.Group controlId=\"StartCheckoutFirtLastName\">\r\n                                <Form.Label>{ `Message for ${ activeMenuFilter == MenuFilter.Delivery ? \"delivery\": \"your order\"}`}</Form.Label>\r\n                                <Form.Control\r\n                                    onChange = { e => enteredMoreDescription.current = e.target.value }\r\n                                    as=\"textarea\" rows={3} />\r\n                            </Form.Group>\r\n                            <div className=\"centered form-group\">\r\n                                <Button disabled = { isFormSubmitting || (availableDeliverTime && availableDeliverTime.length == 0) } variant=\"primary\" type=\"submit\">\r\n                                    Submit\r\n                                </Button>\r\n                            </div>\r\n                        </Form>\r\n                    </Card.Body>\r\n                </Card>\r\n            </Col>\r\n            <Col md={{ span: 4 }}>\r\n                <Form.Group />\r\n                <CurrentOrder filter={activeMenuFilter!} submitted={false} />\r\n            </Col>\r\n        </Row>\r\n    </Container>\r\n}\r\n\r\nexport default StartCheckout\r\n","import React from 'react'\r\nimport { Container, Row, Col, Form, Button, Card } from 'react-bootstrap'\r\nimport toast from 'react-hot-toast'\r\nimport { useTranslation } from 'react-i18next'\r\nimport { Link, useHistory, useLocation } from 'react-router-dom'\r\nimport { useUser } from 'store/userStore'\r\nimport {getErrorMessage} from \"../../lib/handy\";\r\n\r\nconst EnterCodeScreen = () => {\r\n\r\n    //states\r\n    const [isFormSubmitting, setIsFormSubmitting] = React.useState<boolean>(false)\r\n    const { verifyPhone, temporaryPhone } = useUser()\r\n    const { state } = useLocation<{nextPathname: string}>()\r\n    const history = useHistory()\r\n    const { t } = useTranslation()\r\n\r\n    //references\r\n    const enteredCode = React.useRef<string>()\r\n\r\n    React.useEffect(() => {\r\n        if (temporaryPhone == undefined) {\r\n            history.replace({ pathname: '/signup' })\r\n        }\r\n    }, [])\r\n\r\n    const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n\r\n        if (enteredCode.current) {\r\n            setIsFormSubmitting(true)\r\n            verifyPhone(enteredCode.current)\r\n                .then(() => {\r\n                    history.replace({ pathname: state?.nextPathname || \"/\" })\r\n                })\r\n                .catch((e) => {\r\n                    toast.error(getErrorMessage(e))\r\n                }).finally(() => {\r\n                    setIsFormSubmitting(false)\r\n                })\r\n        }\r\n\r\n    }\r\n\r\n    return <Container>\r\n        <Row>\r\n            <Col md = {{ span: 6, offset: 3 }}>\r\n                <Form.Group />\r\n                <Card>\r\n                    <Card.Body>\r\n                        <Form.Group >\r\n                            <h1 className='centered'>\r\n                                Enter the code\r\n                            </h1>\r\n                        </Form.Group>\r\n                        <Form.Group >\r\n                            <Form.Text className=\"text-muted\">\r\n                                 We've just sent you the code through your email, Please enter the code here\r\n                            </Form.Text>\r\n                        </Form.Group>\r\n                        <Form onSubmit = { handleSubmit }>\r\n                            <Form.Group controlId=\"formBasicEmail\">\r\n                                <Form.Label>Received code <span className=\"required\">*</span></Form.Label>\r\n                                <Form.Control\r\n                                    required\r\n                                    type=\"text\" placeholder=\"enter your code here\"\r\n                                    onChange = { e => enteredCode.current = e.target.value }/>\r\n                            </Form.Group>\r\n                            <div className=\"centered form-group\">\r\n                                <Button disabled = { isFormSubmitting } variant=\"primary\" type=\"submit\">\r\n                                    Submit\r\n                                </Button>\r\n                            </div>\r\n                            <div className='centered'>\r\n                                <p>Haven't received the code yet? <Link to='/forgetpass'>re-enter mobile number</Link></p>\r\n                            </div>\r\n                        </Form>\r\n                    </Card.Body>\r\n                </Card>\r\n            </Col>\r\n        </Row>\r\n    </Container>\r\n}\r\n\r\nexport default EnterCodeScreen\r\n","import React from 'react'\r\nimport { BasketItem } from 'type/market'\r\nimport { useMarketContext } from 'store/marketStore'\r\nimport { MenuFilter } from 'type/menu'\r\nimport { getPrice, formatPostCode } from 'lib/handy'\r\n\r\n//styles\r\nimport './style.scss'\r\nimport { Button, Container } from 'react-bootstrap'\r\n\r\nimport editIcon from 'images/edit.png'\r\nimport { useHistory } from 'react-router'\r\n\r\n//assets\r\nimport UpArrow from 'images/uparrow.png'\r\nimport moment from \"moment/moment\";\r\n\r\ntype Props = {\r\n    filter: MenuFilter,\r\n    submitted: boolean\r\n}\r\n\r\nconst CurrentOrder = ({ filter, submitted }: Props) => {\r\n\r\n    //hook\r\n    const {\r\n        basketItems,\r\n        deliveryTime,\r\n        deliveryCost,\r\n        activePostCode,\r\n        storeInfo,\r\n        submittedOrder,\r\n        removeFromBasket\r\n    } = useMarketContext()\r\n    const history = useHistory()\r\n\r\n    //state\r\n    const [isBasketExpanded, setIsBasketExpanded] = React.useState<boolean>(false)\r\n    const [editingBasketItem, setEditingBasketItem] = React.useState<BasketItem>()\r\n    const [morePriceNeedToStartCheckout, setMorePriceNeedToStartCheckout] = React.useState<number>(0)\r\n\r\n\r\n\r\n    //refrences\r\n    const [basketTotal, setBasketTotal] = React.useState<number>(0)\r\n\r\n    React.useEffect(() => {\r\n        basketItems.filter(e =>\r\n            e.item.is_active == false ||\r\n            (e.item.is_collect == false && (filter == MenuFilter.TakeOut || filter == MenuFilter.Booking)) ||\r\n            (e.item.is_delivery == false && filter == MenuFilter.Delivery) ||\r\n            (e.item.is_table == false && filter == MenuFilter.Booking)\r\n        ).map((e) => removeFromBasket(e))\r\n    }, [filter, basketItems])\r\n\r\n    React.useEffect(() => {\r\n        let totalPrice = basketItems\r\n            .reduce((ac, e) =>\r\n                ac + getPrice({ item: e.item, filter ,selectedSizeId: e.sizeOptionId}) * e.quantity\r\n            , 0) + (deliveryCost || 0)\r\n\r\n            //check for minimum price\r\n        if (filter == MenuFilter.Delivery && storeInfo?.delivery_min_order_amount != undefined) {\r\n            setMorePriceNeedToStartCheckout(Math.max(storeInfo.delivery_min_order_amount - totalPrice, 0))\r\n        } else {\r\n            setMorePriceNeedToStartCheckout(0)\r\n        }\r\n\r\n        setBasketTotal(totalPrice)\r\n    }, [basketItems, filter, deliveryCost])\r\n\r\n    const sizeLabel = (basketItem: BasketItem): string => {\r\n        if (basketItem.sizeOptionId == undefined) return \"\"\r\n        let selectedSizes = basketItem.item.sizes.filter((e) => e.id == basketItem.sizeOptionId)\r\n        if (selectedSizes.length > 0 && selectedSizes[0].name != null)\r\n            return ` - size: ${ selectedSizes[0].name }`\r\n        return ''\r\n    }\r\n\r\n    return <div className= { `currentOrderContainer ${ isBasketExpanded ? 'expanded' : '' }`}>\r\n        <div>\r\n            <Container>\r\n                <div className=\"form-group\"/>\r\n                <div className=\"form-group basket-top-header\" onClick = { () => setIsBasketExpanded( p => !p ) }>\r\n                    <h5 className='centered'>Your Order</h5>\r\n                    <div className='basket-arrow-container'>\r\n                        <img src = { UpArrow }/>\r\n                    </div>\r\n                </div>\r\n                <div className=\"centered\">\r\n                { filter == MenuFilter.Delivery && deliveryTime && <p className='min-delivery-time'>Minimum delivery time: { `${deliveryTime} minutes` }</p>}\r\n                { filter == MenuFilter.TakeOut && storeInfo?.min_expected_takeout_time && <p className='min-delivery-time'>Minimum preparation time: { `${storeInfo.min_expected_takeout_time} minutes` }</p>}\r\n                </div>\r\n                <div>\r\n                    { basketItems.map((item, index) =>\r\n                        <div key = { index } className='basket-item-wrapper'>\r\n                            <label className='basket-item-quantity'>\r\n                                { `Quantity: ${item.quantity} ${sizeLabel(item)}` }\r\n                            </label>\r\n                            <label className='basket-item-name'>{ item.item.name }</label>\r\n                            <label className='price-label'>{ `£${(item.quantity * getPrice({ item: item.item, filter, selectedSizeId: item.sizeOptionId })).toFixed(2) }` }</label>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n                <hr/>\r\n                { filter == MenuFilter.Delivery && deliveryCost != undefined && <div className='subtotal'><span>Subtotal:</span><span>£{ (basketTotal - deliveryCost).toFixed(2) }</span></div>}\r\n                { filter == MenuFilter.Delivery && deliveryCost != undefined && <div className='subtotal'><span>Delivery Charge:</span><span>£{ deliveryCost.toFixed(2) }</span></div>}\r\n                {basketTotal != 0 && <div className=\"total\"><span>Total:</span><span>£{ basketTotal.toFixed(2) }</span></div> }\r\n                {filter == MenuFilter.Delivery && <div className=\"selected-address\">\r\n                    <hr/>\r\n                    <span className=\"total\">Delivery Address:</span>\r\n                    <p>{ activePostCode !== undefined &&  (activePostCode?.line1 + \" \" + activePostCode?.line2 + \" \" + activePostCode?.town + \" (\" + formatPostCode(activePostCode?.postCode) + \")\")}</p>\r\n                </div>}\r\n                {filter == MenuFilter.Delivery && submittedOrder != undefined && <div className=\"delivery-time\">\r\n                    <hr/>\r\n                    <span className=\"total\">Delivery Time: { moment(submittedOrder.delivery_date).format('ddd DD/MM/yy HH:mm') }</span>\r\n                </div>}\r\n            </Container>\r\n        </div>\r\n        { !submitted && <div className='form-group centered'>\r\n            <Button onClick = { () => history.push({ pathname: '/menu/' + filter }) } variant=\"info\">Edit order</Button>\r\n        </div>}\r\n    </div>\r\n}\r\n\r\nexport default CurrentOrder\r\n","\r\nexport type TimeInterval = {\r\n    week_day: string\r\n    start_time: string\r\n    finish_time: string\r\n    is_active: boolean\r\n}\r\n\r\nexport type PostalCode = {\r\n    id: string\r\n    post_code: string\r\n    delivery_charge: string\r\n}\r\n\r\nexport enum PaymentMethodType {\r\n    Online = 'online',\r\n    Offline = 'offline',\r\n    CashOnDelivery = 'cash_on_delivery',\r\n    CardOnDelivery = 'card_on_delivery'\r\n}\r\n\r\nexport type ResturantPaymentMethod = {\r\n    id: string\r\n    name: PaymentMethodType\r\n    is_active: boolean\r\n    title?: string\r\n}\r\n\r\nexport type ResturantTable = {\r\n    id: string\r\n    table_number: number\r\n    alias: string\r\n    occupied_by?: string\r\n    // status: 0,\r\n}\r\n\r\nexport type ResturantBranchInfo = {\r\n    id: string\r\n    vat: string\r\n    name: string\r\n    tel?: string\r\n    address?: string\r\n    full_name: string\r\n    partner_id: string\r\n    branch_code: number\r\n    description?: string\r\n    tables_count?: number\r\n    partner_name: string\r\n    is_closed_now: boolean\r\n    accessibility_times: TimeInterval[]\r\n    delivery_times: TimeInterval[]\r\n    takeout_times: TimeInterval[]\r\n    post_codes: PostalCode[]\r\n    pay_methods: ResturantPaymentMethod[]\r\n    is_eat_in_active: boolean\r\n    is_take_out_active: boolean\r\n    is_delivery_active: boolean\r\n    is_table_management_active: boolean\r\n    is_booking_active: boolean\r\n    is_pre_order_active: boolean\r\n    is_citymenu_active: boolean\r\n    is_citymenu_checkout_active: boolean\r\n    reservation_default_minutes?: number\r\n    maximum_acceptance_capacity?: number\r\n    min_expected_delivery_time: number\r\n    delivery_min_order_amount: number\r\n    min_expected_takeout_time: number\r\n    is_branch_closed_now: boolean\r\n    is_delivery_closed_now: boolean\r\n    is_takeout_closed_now: boolean\r\n    stripe_publishable_key: string\r\n    stripe_account_id: string\r\n}\r\n\r\nexport type PostCodeAddress = {\r\n    full_addresses: string\r\n    line1: string\r\n    line2?: string\r\n    town: string\r\n    postcode: string\r\n    lat: number\r\n    long: number\r\n}\r\n","import React from 'react'\r\nimport { Container, Row, Col, Form, Button, Card } from 'react-bootstrap'\r\nimport toast from 'react-hot-toast'\r\nimport { useTranslation } from 'react-i18next'\r\nimport { useHistory } from 'react-router-dom'\r\nimport { useUser } from 'store/userStore'\r\nimport PasswordField from 'components/passwordField'\r\nimport {getErrorMessage} from \"../../lib/handy\";\r\n\r\nconst ResetPassScreen = () => {\r\n\r\n    //hooks\r\n    const history = useHistory()\r\n    const { t } = useTranslation()\r\n    const { resetPassword } = useUser()\r\n\r\n    //states\r\n    const [isSubmitting, setisSubmitting] = React.useState<boolean>(false)\r\n    const [isFormValidated, setIsFormValidated] = React.useState<boolean>(false)\r\n\r\n    //references\r\n    const enteredVerificationCode = React.useRef<string>()\r\n    const enteredNewPassword = React.useRef<string>()\r\n\r\n    const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n\r\n        if (enteredVerificationCode.current == undefined ||\r\n            enteredVerificationCode.current.length == 0 ||\r\n            enteredNewPassword.current == undefined ||\r\n            enteredNewPassword.current.length == 0\r\n            ) {\r\n            setIsFormValidated(true)\r\n            return\r\n        }\r\n\r\n        setisSubmitting(true)\r\n        toast.promise(\r\n            resetPassword({ newPass: enteredNewPassword.current, verifyCode: enteredVerificationCode.current })\r\n            .then(() => {\r\n                history.push({\r\n                    pathname: '/login'\r\n                })\r\n            })\r\n            .finally(() => setisSubmitting(false)),\r\n            {\r\n              loading: 'Loading',\r\n              success: () => `Successfully your password has been reset`,\r\n              error: (e) => getErrorMessage(e),\r\n        })\r\n    }\r\n\r\n\r\n    return <Container>\r\n        <Row>\r\n            <Col md = {{ span: 6, offset: 3 }}>\r\n                <Form.Group />\r\n                    <Card>\r\n                        <Card.Body>\r\n                            <Form.Group >\r\n                                <h1 className='centered'>\r\n                                    Reset Password\r\n                                </h1>\r\n                            </Form.Group>\r\n                            <Form.Group >\r\n                                <Form.Text className=\"text-muted\">\r\n                                    Enter the code you've received and enter a new password to reset your previous password\r\n                                </Form.Text>\r\n                            </Form.Group>\r\n                            <Form validated = { isFormValidated } onSubmit = { handleSubmit }>\r\n                                <Form.Group controlId=\"resetPassPassword\">\r\n                                    <Form.Label>Verification Code <span className=\"required\">*</span></Form.Label>\r\n                                    <Form.Control\r\n                                        required\r\n                                        onChange = { e => enteredVerificationCode.current = e.target.value }\r\n                                        type=\"text\" placeholder=\"Verification Code\" />\r\n                                    <Form.Control.Feedback type='invalid'>Please enter the code you've received</Form.Control.Feedback>\r\n                                </Form.Group>\r\n                                <Form.Group controlId=\"resetPassPassword\">\r\n                                    <Form.Label>New Password <span className=\"required\">*</span></Form.Label>\r\n                                    <PasswordField\r\n                                        name='password'\r\n                                        required = { true }\r\n                                        onChange = { e => enteredNewPassword.current = e.target.value }\r\n                                        placeholder=\"Password\"/>\r\n                                    <Form.Control.Feedback type='invalid'>Please enter a valid password</Form.Control.Feedback>\r\n                                </Form.Group>\r\n                                <div className=\"centered form-group\">\r\n                                    <Button disabled = { isSubmitting } variant=\"primary\" type=\"submit\">\r\n                                        Submit\r\n                                    </Button>\r\n                                </div>\r\n                            </Form>\r\n                        </Card.Body>\r\n                    </Card>\r\n            </Col>\r\n        </Row>\r\n    </Container>\r\n}\r\n\r\nexport default ResetPassScreen\r\n","import React from 'react'\r\nimport { Container, Row, Col, Form, Button, Card } from 'react-bootstrap'\r\nimport { useHistory } from 'react-router-dom'\r\nimport { useMarketContext } from 'store/marketStore'\r\nimport { PaymentMethodType, ResturantPaymentMethod } from 'type/branch'\r\nimport {useStripe, useElements, CardElement, Elements } from '@stripe/react-stripe-js';\r\nimport {loadStripe} from '@stripe/stripe-js';\r\nimport toast from 'react-hot-toast'\r\nimport { useTranslation } from 'react-i18next'\r\nimport { MenuFilter } from 'type/menu'\r\nimport CurrentOrder from \"../../components/currentOrder\";\r\nimport {getErrorMessage} from \"../../lib/handy\";\r\n\r\ntype Props ={\r\n    shouldPay: boolean\r\n    gotError: (e: Error) => void\r\n    successfull: () => void\r\n}\r\n\r\nconst StripeCardField = ({ shouldPay, gotError, successfull }: Props) => {\r\n\r\n    //hooks\r\n    const { getStripeSecretKey, clearBasket, saveOrderInHistory } = useMarketContext()\r\n    const stripe = useStripe();\r\n    const history = useHistory()\r\n    const elements = useElements();\r\n    const { t } = useTranslation()\r\n\r\n    React.useEffect(() => {\r\n        if (shouldPay == true)\r\n            payWithStripe()\r\n    }, [shouldPay])\r\n\r\n    const payWithStripe = () => {\r\n        toast.promise(\r\n            getStripeSecretKey()\r\n                .then((secretKey) => {\r\n                    const cardElement = elements?.getElement(CardElement);\r\n                    if (cardElement) {\r\n                        return stripe?.confirmCardPayment(secretKey, {\r\n                            payment_method: {\r\n                                card: cardElement\r\n                            },\r\n                        }).then((e) => {\r\n                            if (e.error) { throw e }\r\n                            else {\r\n                                saveOrderInHistory();\r\n                                clearBasket();\r\n                                history.replace('/');\r\n                                successfull()\r\n                            }\r\n                        })\r\n                    } else {\r\n                        throw Error('Stripe module is not ready')\r\n                    }\r\n            }),\r\n            {\r\n              loading: 'Loading',\r\n              success: () => `Successful payment`,\r\n              error: (e) => {\r\n                  return getErrorMessage(e)\r\n              },\r\n        })\r\n    }\r\n\r\n    return <CardElement />\r\n}\r\n\r\nconst PaymentScreen = () => {\r\n\r\n    //hooks\r\n    const { submittedOrder, storeInfo, assignPaymentMethod, activeMenuFilter, clearBasket, saveOrderInHistory } = useMarketContext()\r\n    const history = useHistory()\r\n    const { t } = useTranslation()\r\n\r\n    //states\r\n    const [shouldPayWithStripe, setShouldPayWithStripe] = React.useState<boolean>(false)\r\n    const [isStripeElementPresented, setIsStripeElementPresented] = React.useState<boolean>(false)\r\n    const [isSubmitting, setisSubmitting] = React.useState<boolean>(false)\r\n\r\n    //consts\r\n    const selectedMethod = React.useRef<ResturantPaymentMethod>()\r\n    const stripePromise = loadStripe(storeInfo?.stripe_publishable_key ?? '', {\r\n        stripeAccount: storeInfo?.stripe_account_id\r\n    })\r\n    const menuFilterPayments: { [x in MenuFilter]: { [x in PaymentMethodType]?: true }} = {\r\n        [MenuFilter.Delivery]: {\r\n            [PaymentMethodType.CardOnDelivery]: true,\r\n            [PaymentMethodType.CashOnDelivery]: true,\r\n            [PaymentMethodType.Online]: true,\r\n        },\r\n        [MenuFilter.TakeOut]: {\r\n            [PaymentMethodType.Offline]: true,\r\n            [PaymentMethodType.Online]: true,\r\n        },\r\n        [MenuFilter.Booking]: {\r\n            [PaymentMethodType.Online]: true,\r\n        },\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        if (storeInfo == undefined || submittedOrder == undefined)\r\n            history.replace('/')\r\n    }, [])\r\n\r\n    const changeMethod = (method: ResturantPaymentMethod) => {\r\n        selectedMethod.current = method\r\n        setIsStripeElementPresented(method.name == 'online')\r\n        if (method.name != 'online') {\r\n            setShouldPayWithStripe(false)\r\n        }\r\n    }\r\n\r\n    const submitToPay = () => {\r\n        if (selectedMethod.current == undefined) {\r\n            toast.error('Please select one of payment methods')\r\n            return\r\n        }\r\n        setisSubmitting(true)\r\n        if (selectedMethod.current.name == 'online') {\r\n            setShouldPayWithStripe(true)\r\n            return\r\n        } else {\r\n            toast.promise(\r\n                assignPaymentMethod(selectedMethod.current)\r\n                    .then(() => {\r\n                        saveOrderInHistory();\r\n                        clearBasket();\r\n                        history.replace('/');\r\n                    })\r\n                    .finally(() => setisSubmitting(false)),\r\n                {\r\n                  loading: 'Loading',\r\n                  success: () => `Successful payment`,\r\n                  error: (e) => getErrorMessage(e),\r\n            })\r\n        }\r\n    }\r\n\r\n    return <Container>\r\n        <Row>\r\n            <Col md = {{ span: 5, offset: 1 }}>\r\n                <Form.Group />\r\n                <Card>\r\n                    <Card.Body>\r\n                        <Form.Group >\r\n                            <h3 className='centered'>\r\n                                Choose Your Payment\r\n                            </h3>\r\n                        </Form.Group>\r\n                        <Form.Group>\r\n                            <Form.Text className=\"text-muted\">\r\n                                Please select one of these payment methods\r\n                            </Form.Text>\r\n                            {\r\n                                activeMenuFilter &&\r\n                                storeInfo?.pay_methods\r\n                                    .filter(e => menuFilterPayments[activeMenuFilter][e.name])\r\n                                    .map((e, index) => {\r\n                                    return <Form.Check\r\n                                        key = { index }\r\n                                        type = \"radio\"\r\n                                        onChange = { () => changeMethod(e) }\r\n                                        id = {`${index}`}\r\n                                        label = {`${ e.title }`}\r\n                                        name = 'payment-method'\r\n                                        disabled = { e.is_active == false }\r\n                                    />\r\n                                })\r\n                            }\r\n                        </Form.Group>\r\n                        { isStripeElementPresented && <Form.Group>\r\n                            <Form.Group>\r\n                                <Form.Text className=\"text-muted\">\r\n                                    Please enter your card number to complete your purchase\r\n                                </Form.Text>\r\n                            </Form.Group>\r\n                            <Elements stripe={stripePromise}>\r\n                                <StripeCardField\r\n                                    shouldPay = { shouldPayWithStripe }\r\n                                    gotError = { () => {\r\n                                        setShouldPayWithStripe(false);\r\n                                        setisSubmitting(false)\r\n                                    }}\r\n                                    successfull = { () => {  }}/>\r\n                            </Elements>\r\n                        </Form.Group>}\r\n                        <Form.Group className='centered'>\r\n                            <Button disabled = { isSubmitting && false } onClick = { submitToPay } variant=\"primary\">\r\n                                Submit\r\n                            </Button>\r\n                        </Form.Group>\r\n                    </Card.Body>\r\n                </Card>\r\n            </Col>\r\n            <Col md={{ span: 4 }}>\r\n                <Form.Group />\r\n                <CurrentOrder filter={activeMenuFilter!} submitted={true} />\r\n            </Col>\r\n        </Row>\r\n    </Container>\r\n}\r\n\r\nexport default PaymentScreen\r\n","import React from 'react'\r\nimport {Card, Col, Container, Row} from 'react-bootstrap'\r\nimport {useMarketContext} from \"../../store/marketStore\";\r\nimport './style.scss'\r\nimport {BasketItem} from \"../../type/market\";\r\nimport {MenuFilter} from \"../../type/menu\";\r\nimport {firstLetterUpperCase, getPrice} from \"../../lib/handy\";\r\nimport moment from \"moment/moment\";\r\n\r\nconst HistoryScreen = () => {\r\n\r\n    //hooks\r\n    const {history} = useMarketContext()\r\n\r\n    const sizeLabel = (basketItem: BasketItem): string => {\r\n        if (basketItem.sizeOptionId == undefined) return \"\"\r\n        let selectedSizes = basketItem.item.sizes.filter((e) => e.id == basketItem.sizeOptionId)\r\n        if (selectedSizes.length > 0 && selectedSizes[0].name != null)\r\n            return `(${ selectedSizes[0].name })`\r\n        return ''\r\n    }\r\n\r\n    const getMenuFilter = (filter?: string): MenuFilter => {\r\n        return filter == MenuFilter.Delivery ? MenuFilter.Delivery : MenuFilter.TakeOut;\r\n    }\r\n\r\n    return <Container>\r\n        <Row style={{marginTop: 10}}>\r\n            <Col md = {{ span: 12 }} style={{\"marginTop\": \"30px\"}}>\r\n                { history.length == 0 && <div className=\"centered\">You haven't placed any orders yet.</div>}\r\n                        {history.map((h, i) =>\r\n                            <Card key={i} className=\"m-2\">\r\n                                <Card.Body>\r\n                                    <div className=\"order-items\">\r\n                                        { h.rows.map((item, index) =>\r\n                                            <div key = { index } className='order-item'>\r\n                                                <span className=\"quantity\">{item.quantity}</span> x <span className=\"item\">{ item.item.name }</span> <span className=\"size\">{ sizeLabel(item) }</span>\r\n                                                <span className=\"row-total\">£{ `${(item.quantity * getPrice({ item: item.item, filter: getMenuFilter(h.order_type), selectedSizeId: item.sizeOptionId })).toFixed(2) }` }</span>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                    <div><label>Date:</label> {h.created_at}</div>\r\n                                    <div><label>Type:</label> {firstLetterUpperCase(h.order_type != undefined ? h.order_type : '---')}</div>\r\n                                    <div><label>Total:</label> £{h.total != undefined ? parseFloat(h.total).toFixed(2) : '--'}</div>\r\n                                    { h.description ? <div><label>Message:</label> {h.description}</div> : '' }\r\n                                    { (h.order_type == 'delivery' || h.order_type == 'takeout') && <div><label>{firstLetterUpperCase(h.order_type)} date and time:</label> {moment(h.delivery_date).format('DD/MM/YYYY HH:mm')}</div> }\r\n                                { h.order_type == 'delivery' && <div>\r\n                                    <div><label>Delivery charge:</label> £{h.delivery_charge?.toFixed(2)}</div>\r\n                                    <div><label>Address:</label> {h.address}</div>\r\n                                </div> }\r\n                                </Card.Body>\r\n                            </Card>\r\n                        )}\r\n            </Col>\r\n        </Row>\r\n    </Container>\r\n}\r\n\r\nexport default HistoryScreen\r\n","import React, {useEffect} from 'react'\r\nimport {\r\n    BrowserRouter as Router,\r\n    Route,\r\n    Switch,\r\n    Link,\r\n    useRouteMatch,\r\n    useLocation\r\n} from \"react-router-dom\";\r\nimport Home from 'screens/home'\r\nimport Redirector from 'screens/redirector/index'\r\nimport Login from 'screens/login/index';\r\nimport Menu from 'screens/menu'\r\nimport EatIn from 'screens/eatIn'\r\nimport SingleMenu from 'screens/singleMenu'\r\n\r\n//styles\r\nimport 'navigation/style.scss'\r\nimport Booking from 'screens/booking';\r\nimport SignUp from 'screens/signup';\r\nimport ForgetPass from 'screens/forgetPass';\r\nimport { useMarketContext } from 'store/marketStore';\r\nimport PostCodeCheckModal from 'screens/postCodeCheck';\r\nimport EnterCodeScreen from 'screens/enterCode';\r\nimport { useUser } from 'store/userStore';\r\nimport StartCheckout from 'screens/startCheckout';\r\nimport ResetPassScreen from 'screens/resetPass';\r\nimport PaymentScreen from 'screens/payment'\r\nimport HistoryScreen from \"../screens/history\";\r\nimport {types} from \"util\";\r\n\r\nfunction ScrollToTop() {\r\n    const { pathname } = useLocation();\r\n\r\n    useEffect(() => {\r\n        window.scrollTo(0, 0);\r\n    }, [pathname]);\r\n\r\n    return null;\r\n}\r\n\r\nconst AppNavigation = () => {\r\n    return (\r\n        <Router basename=\"/menu\">\r\n          <ScrollToTop/>\r\n          <RouteSwitcher />\r\n        </Router>\r\n    );\r\n};\r\n\r\nconst RouteSwitcher = () => {\r\n  let location = useLocation<{ background: Location }>();\r\n  let background = location.state && location.state.background;\r\n\r\n  return (\r\n    <div>\r\n      <AppNavBar />\r\n      <Switch>\r\n        <Route path=\"/checkout\">\r\n          <StartCheckout />\r\n        </Route>\r\n        <Route path=\"/signup\">\r\n          <SignUp />\r\n        </Route>\r\n          <Route path=\"/redirector\">\r\n              <Redirector />\r\n          </Route>\r\n        <Route path=\"/history\">\r\n            <HistoryScreen />\r\n        </Route>\r\n        <Route path=\"/forgetpass\">\r\n          <ForgetPass />\r\n        </Route>\r\n        <Route path=\"/payment\">\r\n          <PaymentScreen />\r\n        </Route>\r\n        <Route path=\"/login\">\r\n          <Login />\r\n        </Route>\r\n        <Route path=\"/booking\">\r\n          <Booking />\r\n        </Route>\r\n        <Route path=\"/reset-pass\">\r\n          <ResetPassScreen />\r\n        </Route>\r\n        <Route path=\"/enter-code\">\r\n          <EnterCodeScreen />\r\n        </Route>\r\n        <Route path=\"/order/:filter\">\r\n            <Menu/>\r\n        </Route>\r\n          <Route path=\"/singleMenu\">\r\n              <EatIn />\r\n          </Route>\r\n          <Route path=\"/single-menu/:filter\">\r\n              <SingleMenu />\r\n          </Route>\r\n        <Route path=\"/\">\r\n          <Home />\r\n        </Route>\r\n      </Switch>\r\n      { background && <Route path={ ['*/postcode-check'] }>\r\n          <PostCodeCheckModal />\r\n        </Route> }\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\nconst NavbarLink = ({ title, link }:{ title: string, link: string }) => {\r\n\r\n    let match = useRouteMatch({\r\n    path: link,\r\n    exact: true\r\n  });\r\n\r\n    if(title === \"Booking\")\r\n        return <Link id='bookingNavBtn' className={`nav-link ${match ? 'active' : '' }`} to={link}>{title}</Link>;\r\n\r\nreturn <Link className={`nav-link ${match ? 'active' : '' }`} to={link}>{title}</Link>\r\n};\r\n\r\nconst NavbarLinkWithATag = ({ title, link }:{ title: string, link: string }) => {\r\n    return <a className={`nav-link`} href={link}>{title}</a>\r\n};\r\n\r\nconst AppNavBar = () => {\r\n\r\n    return <div></div>\r\n  // const { user, logout } = useUser();\r\n  // const base_url = \"http://localhost/\";\r\n\r\n  // return <Navbar className='justify-content-between menu' expand=\"lg\">\r\n  //     <Container>\r\n  //         <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\r\n  //         <Navbar.Collapse>\r\n  //           <Nav className=\"mr-auto\">\r\n  //\r\n  //               { <NavbarLinkWithATag link={base_url} title = 'Home'/> }\r\n  //               { <NavbarLinkWithATag link={base_url + 'gallery'} title = 'Gallery'/> }\r\n  //               { <NavbarLink link='/menu' title = 'Menu'/> }\r\n  //               { <NavbarLink link='/booking' title = 'Booking'/> }\r\n  //               { <NavbarLinkWithATag link={base_url + 'contactus'} title = 'ContactUs'/> }\r\n  //           </Nav>\r\n  //           <Nav className=\"justify-content-end\">\r\n  //               { user == undefined && <NavbarLink title = 'Sign In' link = '/login'/>}\r\n  //               { user && <NavDropdown className=\"mr-auto\" title={ `Hi ${user.full_name || user.username || user.mobile }` } id=\"menu-nav-dropdown\">\r\n  //                   <Link to={\"/history\"} className='dropdown-item'>My Orders</Link>\r\n  //                   <div onClick = { logout } className='dropdown-item'>Sign Out</div>\r\n  //               </NavDropdown>}\r\n  //           </Nav>\r\n  //         </Navbar.Collapse>\r\n  //   </Container>\r\n  //   </Navbar>\r\n};\r\n\r\nexport default AppNavigation\r\n","import i18n from 'i18next';\r\nimport { initReactI18next } from \"react-i18next\";\r\n\r\nconst resources = {\r\n    en: {\r\n        translation: {\r\n            'Day': 'Day',\r\n            'AvailableTime': 'Avaible Time',\r\n            'Name': 'Name',\r\n            'Address': 'Address',\r\n            'MenuTitle': 'Menu of Restaurant',\r\n            'EatInTitle': 'Eat In Menu',\r\n            'TakeOutTitle': 'Take Out Menu',\r\n            'Menu': 'Menu',\r\n            'Delivery': 'Delivery',\r\n            'TakeOut': 'Take Out',\r\n            'Booking': 'Booking',\r\n            'ResturantInfo': 'Restaurant Information',\r\n            'NotProperResponse': 'There is problem in server connection',\r\n            'FiltersTitle': 'Select the type of your order',\r\n            'ItemDetails': 'Details',\r\n            'Close': 'Close',\r\n            'AddToBasket': 'Add To Basket',\r\n            'EditBasketItem': 'Update Basket',\r\n            'ResturantTitle': 'Sample Restaurant Title',\r\n            'SelectSize': 'Size: (choose one)',\r\n            'MoreOrderDescription': 'Please write down, more details if you need, e.g. no salt.',\r\n            'PleaseEnterPhone': 'please re-enter your phone!'\r\n        }\r\n    }\r\n}\r\n\r\ni18n\r\n  .use(initReactI18next) // passes i18n down to react-i18next\r\n  .init({\r\n    resources,\r\n    lng: \"en\",\r\n    keySeparator: false, // we do not use keys in form messages.welcome\r\n    interpolation: {\r\n      escapeValue: false // react already safes from xss\r\n    }\r\n  });\r\n\r\n  export default i18n;\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport reportWebVitals from './reportWebVitals';\nimport MenuProvider from './store/menuStore';\nimport AppNavigation from './navigation';\nimport { Toaster } from 'react-hot-toast';\nimport 'react-phone-input-2/lib/style.css'\nimport './translation'\nimport MarketProvider from 'store/marketStore';\nimport UserProvider from 'store/userStore';\nimport {BrowserRouter} from \"react-router-dom\";\n\n\nconst reactAppData = window.rpReactPlugin || {}\nconst { appSelector } = reactAppData\nconst appAnchorElement = document.querySelector(appSelector)\n\nif (appAnchorElement) {\n\nReactDOM.render(\n  <React.StrictMode>\n      <MarketProvider>\n        <UserProvider>\n            <MenuProvider>\n                <AppNavigation />\n                <Toaster position = 'top-center'/>\n            </MenuProvider>\n        </UserProvider>\n      </MarketProvider>\n  </React.StrictMode>,\n  appAnchorElement\n);\n\n}\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n\n"],"sourceRoot":""}